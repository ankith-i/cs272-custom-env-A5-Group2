{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 10.005172729492188, "policy_loss": 0.0025496783200651407, "vf_loss": 9.997479438781738, "vf_explained_var": 3.448096563829495e-08, "kl": 0.02571653388440609, "entropy": 1.0735443830490112, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -1484080.0, "episode_reward_min": -1484080.0, "episode_reward_mean": -1484080.0, "episode_len_mean": 3421.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0], "episode_lengths": [3421]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28415347182491485, "mean_inference_ms": 1.0259329632084777, "mean_action_processing_ms": 0.10833195584084326, "mean_env_wait_ms": 0.04492983523680848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1692056655883789}}, "episode_reward_max": -1484080.0, "episode_reward_min": -1484080.0, "episode_reward_mean": -1484080.0, "episode_len_mean": 3421.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0], "episode_lengths": [3421]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28415347182491485, "mean_inference_ms": 1.0259329632084777, "mean_action_processing_ms": 0.10833195584084326, "mean_env_wait_ms": 0.04492983523680848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1692056655883789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 422.9163301428353, "num_env_steps_trained_throughput_per_sec": 422.9163301428353, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 9458.136, "sample_time_ms": 5913.126, "load_time_ms": 1.012, "load_throughput": 3954092.859, "learn_time_ms": 3522.426, "learn_throughput": 1135.581, "synch_weights_time_ms": 3.977}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "8124a_00000", "date": "2023-12-11_00-16-33", "timestamp": 1702282593, "time_this_iter_s": 9.46152925491333, "time_total_s": 9.46152925491333, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9.46152925491333, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.935714285714283, "ram_util_percent": 92.55714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 10.025779724121094, "policy_loss": 0.024429932236671448, "vf_loss": 9.997479438781738, "vf_explained_var": -7.690921677294682e-09, "kl": 0.012900633737444878, "entropy": 1.0948911905288696, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -1212885.0, "episode_reward_min": -1484080.0, "episode_reward_mean": -1348482.5, "episode_len_mean": 3163.5, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0], "episode_lengths": [3421, 2906]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2820594174872414, "mean_inference_ms": 1.0224670000435767, "mean_action_processing_ms": 0.10880705540044458, "mean_env_wait_ms": 0.042834836631403896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.16303062438964844}}, "episode_reward_max": -1212885.0, "episode_reward_min": -1484080.0, "episode_reward_mean": -1348482.5, "episode_len_mean": 3163.5, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0], "episode_lengths": [3421, 2906]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2820594174872414, "mean_inference_ms": 1.0224670000435767, "mean_action_processing_ms": 0.10880705540044458, "mean_env_wait_ms": 0.042834836631403896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.16303062438964844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 434.43305688223916, "num_env_steps_trained_throughput_per_sec": 434.43305688223916, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 9332.769, "sample_time_ms": 5843.1, "load_time_ms": 1.013, "load_throughput": 3948973.991, "learn_time_ms": 3475.87, "learn_throughput": 1150.791, "synch_weights_time_ms": 3.988}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "8124a_00000", "date": "2023-12-11_00-16-43", "timestamp": 1702282603, "time_this_iter_s": 9.214420080184937, "time_total_s": 18.675949335098267, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 18.675949335098267, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 33.00769230769231, "ram_util_percent": 93.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 10.010534286499023, "policy_loss": 0.011371107771992683, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.014014381915330887, "entropy": 1.0695189237594604, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -734275.0, "episode_reward_min": -1484080.0, "episode_reward_mean": -1110804.0, "episode_len_mean": 2703.5, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0], "episode_lengths": [3421, 2906, 2715, 1772]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2802954223808977, "mean_inference_ms": 1.0200418923661987, "mean_action_processing_ms": 0.10940782231952546, "mean_env_wait_ms": 0.04260976260106281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1465439796447754}}, "episode_reward_max": -734275.0, "episode_reward_min": -1484080.0, "episode_reward_mean": -1110804.0, "episode_len_mean": 2703.5, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0], "episode_lengths": [3421, 2906, 2715, 1772]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2802954223808977, "mean_inference_ms": 1.0200418923661987, "mean_action_processing_ms": 0.10940782231952546, "mean_env_wait_ms": 0.04260976260106281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1465439796447754}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.4997172947093, "num_env_steps_trained_throughput_per_sec": 443.4997172947093, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 9227.907, "sample_time_ms": 5836.973, "load_time_ms": 0.944, "load_throughput": 4235244.699, "learn_time_ms": 3380.467, "learn_throughput": 1183.269, "synch_weights_time_ms": 3.657}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 4, "training_iteration": 3, "trial_id": "8124a_00000", "date": "2023-12-11_00-16-52", "timestamp": 1702282612, "time_this_iter_s": 9.026195049285889, "time_total_s": 27.702144384384155, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 27.702144384384155, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 32.916666666666664, "ram_util_percent": 92.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 10.016826629638672, "policy_loss": 0.01821408048272133, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.012174679897725582, "entropy": 1.091435432434082, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -620530.0, "episode_reward_min": -1484080.0, "episode_reward_mean": -1009222.6666666666, "episode_len_mean": 2531.3333333333335, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27976065797332256, "mean_inference_ms": 1.019432577289047, "mean_action_processing_ms": 0.10974674017684677, "mean_env_wait_ms": 0.042740678595164776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14975865681966147}}, "episode_reward_max": -620530.0, "episode_reward_min": -1484080.0, "episode_reward_mean": -1009222.6666666666, "episode_len_mean": 2531.3333333333335, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27976065797332256, "mean_inference_ms": 1.019432577289047, "mean_action_processing_ms": 0.10974674017684677, "mean_env_wait_ms": 0.042740678595164776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14975865681966147}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.5215046453023, "num_env_steps_trained_throughput_per_sec": 436.5215046453023, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 9211.768, "sample_time_ms": 5842.53, "load_time_ms": 0.874, "load_throughput": 4577997.408, "learn_time_ms": 3360.36, "learn_throughput": 1190.348, "synch_weights_time_ms": 3.525}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 6, "training_iteration": 4, "trial_id": "8124a_00000", "date": "2023-12-11_00-17-01", "timestamp": 1702282621, "time_this_iter_s": 9.171209573745728, "time_total_s": 36.87335395812988, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 36.87335395812988, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 33.91538461538462, "ram_util_percent": 92.12307692307694}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 10.01755142211914, "policy_loss": 0.017951900139451027, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.007068099919706583, "entropy": 1.0802485942840576, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -439500.0, "episode_reward_min": -1484080.0, "episode_reward_mean": -927833.7142857143, "episode_len_mean": 2341.5714285714284, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27949005392166454, "mean_inference_ms": 1.0187515047357623, "mean_action_processing_ms": 0.10962367101979253, "mean_env_wait_ms": 0.04263030610166451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.16785008566720144}}, "episode_reward_max": -439500.0, "episode_reward_min": -1484080.0, "episode_reward_mean": -927833.7142857143, "episode_len_mean": 2341.5714285714284, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27949005392166454, "mean_inference_ms": 1.0187515047357623, "mean_action_processing_ms": 0.10962367101979253, "mean_env_wait_ms": 0.04263030610166451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.16785008566720144}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 448.09463277839615, "num_env_steps_trained_throughput_per_sec": 448.09463277839615, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 9154.751, "sample_time_ms": 5815.132, "load_time_ms": 0.699, "load_throughput": 5722496.76, "learn_time_ms": 3331.521, "learn_throughput": 1200.653, "synch_weights_time_ms": 3.418}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 7, "training_iteration": 5, "trial_id": "8124a_00000", "date": "2023-12-11_00-17-10", "timestamp": 1702282630, "time_this_iter_s": 8.932697057723999, "time_total_s": 45.80605101585388, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 45.80605101585388, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 35.41538461538461, "ram_util_percent": 92.12307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 10.015294075012207, "policy_loss": 0.016223739832639694, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.013703429140150547, "entropy": 1.097103476524353, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -231745.0, "episode_reward_min": -1656490.0, "episode_reward_mean": -931452.3333333334, "episode_len_mean": 2433.222222222222, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27904717610321994, "mean_inference_ms": 1.0172515297562623, "mean_action_processing_ms": 0.10940092705974229, "mean_env_wait_ms": 0.042497479536892466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1363780763414171}}, "episode_reward_max": -231745.0, "episode_reward_min": -1656490.0, "episode_reward_mean": -931452.3333333334, "episode_len_mean": 2433.222222222222, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27904717610321994, "mean_inference_ms": 1.0172515297562623, "mean_action_processing_ms": 0.10940092705974229, "mean_env_wait_ms": 0.042497479536892466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1363780763414171}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.3586600100833, "num_env_steps_trained_throughput_per_sec": 446.3586600100833, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 9122.527, "sample_time_ms": 5802.077, "load_time_ms": 0.582, "load_throughput": 6866996.112, "learn_time_ms": 3313.04, "learn_throughput": 1207.351, "synch_weights_time_ms": 3.189}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 9, "training_iteration": 6, "trial_id": "8124a_00000", "date": "2023-12-11_00-17-19", "timestamp": 1702282639, "time_this_iter_s": 8.968423128128052, "time_total_s": 54.774474143981934, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 54.774474143981934, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.533333333333335, "ram_util_percent": 91.8583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 10.002096176147461, "policy_loss": 0.002066526096314192, "vf_loss": 9.994041442871094, "vf_explained_var": -1.925550577652757e-06, "kl": 0.019959721714258194, "entropy": 1.0767608880996704, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -231745.0, "episode_reward_min": -1656490.0, "episode_reward_mean": -919116.0909090909, "episode_len_mean": 2438.090909090909, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27873399871916404, "mean_inference_ms": 1.0165134522162822, "mean_action_processing_ms": 0.10909671001528114, "mean_env_wait_ms": 0.04244972475804401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1387422735040838}}, "episode_reward_max": -231745.0, "episode_reward_min": -1656490.0, "episode_reward_mean": -919116.0909090909, "episode_len_mean": 2438.090909090909, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27873399871916404, "mean_inference_ms": 1.0165134522162822, "mean_action_processing_ms": 0.10909671001528114, "mean_env_wait_ms": 0.04244972475804401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1387422735040838}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.1376035628184, "num_env_steps_trained_throughput_per_sec": 442.1376035628184, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 9111.731, "sample_time_ms": 5804.663, "load_time_ms": 0.499, "load_throughput": 8011495.464, "learn_time_ms": 3300.006, "learn_throughput": 1212.119, "synch_weights_time_ms": 3.161}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 11, "training_iteration": 7, "trial_id": "8124a_00000", "date": "2023-12-11_00-17-28", "timestamp": 1702282648, "time_this_iter_s": 9.053998947143555, "time_total_s": 63.82847309112549, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 63.82847309112549, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.62307692307692, "ram_util_percent": 91.91538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 10.012162208557129, "policy_loss": 0.016011128202080727, "vf_loss": 9.992524147033691, "vf_explained_var": -9.966152703100306e-08, "kl": 0.012083756737411022, "entropy": 1.0955194234848022, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -231745.0, "episode_reward_min": -1656490.0, "episode_reward_mean": -834407.2142857143, "episode_len_mean": 2154.1428571428573, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27834421389429675, "mean_inference_ms": 1.015365544772078, "mean_action_processing_ms": 0.10878925204037238, "mean_env_wait_ms": 0.042335032521271625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11275836399623326}}, "episode_reward_max": -231745.0, "episode_reward_min": -1656490.0, "episode_reward_mean": -834407.2142857143, "episode_len_mean": 2154.1428571428573, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27834421389429675, "mean_inference_ms": 1.015365544772078, "mean_action_processing_ms": 0.10878925204037238, "mean_env_wait_ms": 0.042335032521271625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11275836399623326}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.66344522362397, "num_env_steps_trained_throughput_per_sec": 438.66344522362397, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 9112.591, "sample_time_ms": 5793.927, "load_time_ms": 0.437, "load_throughput": 9155994.815, "learn_time_ms": 3311.864, "learn_throughput": 1207.779, "synch_weights_time_ms": 3.168}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 14, "training_iteration": 8, "trial_id": "8124a_00000", "date": "2023-12-11_00-17-37", "timestamp": 1702282657, "time_this_iter_s": 9.125606536865234, "time_total_s": 72.95407962799072, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 72.95407962799072, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.215384615384615, "ram_util_percent": 91.88461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 10.017334938049316, "policy_loss": 0.022346636280417442, "vf_loss": 9.994959831237793, "vf_explained_var": -1.6663663782168214e-09, "kl": 9.201228385791183e-05, "entropy": 1.095808744430542, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -180128.0, "episode_reward_min": -1656490.0, "episode_reward_mean": -834696.25, "episode_len_mean": 2187.375, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27822679314976784, "mean_inference_ms": 1.014591319059054, "mean_action_processing_ms": 0.10860086742656855, "mean_env_wait_ms": 0.04220715146800956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11529922485351562}}, "episode_reward_max": -180128.0, "episode_reward_min": -1656490.0, "episode_reward_mean": -834696.25, "episode_len_mean": 2187.375, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27822679314976784, "mean_inference_ms": 1.014591319059054, "mean_action_processing_ms": 0.10860086742656855, "mean_env_wait_ms": 0.04220715146800956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11529922485351562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.39820108611536, "num_env_steps_trained_throughput_per_sec": 447.39820108611536, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 9093.479, "sample_time_ms": 5783.164, "load_time_ms": 0.388, "load_throughput": 10300494.167, "learn_time_ms": 3303.827, "learn_throughput": 1210.717, "synch_weights_time_ms": 3.147}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 16, "training_iteration": 9, "trial_id": "8124a_00000", "date": "2023-12-11_00-17-46", "timestamp": 1702282666, "time_this_iter_s": 8.947575807571411, "time_total_s": 81.90165543556213, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 81.90165543556213, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 29.36666666666667, "ram_util_percent": 92.01666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 10.004984855651855, "policy_loss": 0.007189296185970306, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.018903983756899834, "entropy": 1.0670441389083862, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -180128.0, "episode_reward_min": -1656490.0, "episode_reward_mean": -827428.3888888889, "episode_len_mean": 2192.1111111111113, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27886788267877843, "mean_inference_ms": 1.014568015801598, "mean_action_processing_ms": 0.10860578560665227, "mean_env_wait_ms": 0.04211645533503508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10802745819091797}}, "episode_reward_max": -180128.0, "episode_reward_min": -1656490.0, "episode_reward_mean": -827428.3888888889, "episode_len_mean": 2192.1111111111113, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27886788267877843, "mean_inference_ms": 1.014568015801598, "mean_action_processing_ms": 0.10860578560665227, "mean_env_wait_ms": 0.04211645533503508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10802745819091797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.9974004003521, "num_env_steps_trained_throughput_per_sec": 411.9974004003521, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 9155.011, "sample_time_ms": 5836.584, "load_time_ms": 0.449, "load_throughput": 8899435.604, "learn_time_ms": 3312.185, "learn_throughput": 1207.662, "synch_weights_time_ms": 3.134}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 18, "training_iteration": 10, "trial_id": "8124a_00000", "date": "2023-12-11_00-17-56", "timestamp": 1702282676, "time_this_iter_s": 9.716782569885254, "time_total_s": 91.61843800544739, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 91.61843800544739, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 34.371428571428574, "ram_util_percent": 92.04285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 10.022137641906738, "policy_loss": 0.020335789769887924, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.028809668496251106, "entropy": 1.0966984033584595, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -180128.0, "episode_reward_min": -1656490.0, "episode_reward_mean": -807959.2631578947, "episode_len_mean": 2132.8947368421054, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27911404044809246, "mean_inference_ms": 1.0144572413379784, "mean_action_processing_ms": 0.10859458261518944, "mean_env_wait_ms": 0.04208102154959643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10234180249665913}}, "episode_reward_max": -180128.0, "episode_reward_min": -1656490.0, "episode_reward_mean": -807959.2631578947, "episode_len_mean": 2132.8947368421054, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27911404044809246, "mean_inference_ms": 1.0144572413379784, "mean_action_processing_ms": 0.10859458261518944, "mean_env_wait_ms": 0.04208102154959643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10234180249665913}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.28099657197725, "num_env_steps_trained_throughput_per_sec": 446.28099657197725, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 9105.493, "sample_time_ms": 5817.245, "load_time_ms": 0.448, "load_throughput": 8931177.003, "learn_time_ms": 3283.667, "learn_throughput": 1218.15, "synch_weights_time_ms": 3.136}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 19, "training_iteration": 11, "trial_id": "8124a_00000", "date": "2023-12-11_00-18-05", "timestamp": 1702282685, "time_this_iter_s": 8.968961954116821, "time_total_s": 100.58739995956421, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 100.58739995956421, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 30.807692307692307, "ram_util_percent": 92.07692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.22499999403953552, "cur_lr": 4.999999873689376e-05, "total_loss": 10.0176362991333, "policy_loss": 0.01775456592440605, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.01067283470183611, "entropy": 1.0859578847885132, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -180128.0, "episode_reward_min": -1656490.0, "episode_reward_mean": -849222.4, "episode_len_mean": 2251.05, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27932709970838954, "mean_inference_ms": 1.0144321959705478, "mean_action_processing_ms": 0.10859744464487223, "mean_env_wait_ms": 0.04202842076236858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.001665353775024414, "ViewRequirementAgentConnector_ms": 0.10086178779602051}}, "episode_reward_max": -180128.0, "episode_reward_min": -1656490.0, "episode_reward_mean": -849222.4, "episode_len_mean": 2251.05, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27932709970838954, "mean_inference_ms": 1.0144321959705478, "mean_action_processing_ms": 0.10859744464487223, "mean_env_wait_ms": 0.04202842076236858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.001665353775024414, "ViewRequirementAgentConnector_ms": 0.10086178779602051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 439.6723661469478, "num_env_steps_trained_throughput_per_sec": 439.6723661469478, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 9094.521, "sample_time_ms": 5828.878, "load_time_ms": 0.392, "load_throughput": 10195196.889, "learn_time_ms": 3261.217, "learn_throughput": 1226.536, "synch_weights_time_ms": 2.937}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 20, "training_iteration": 12, "trial_id": "8124a_00000", "date": "2023-12-11_00-18-14", "timestamp": 1702282694, "time_this_iter_s": 9.106702089309692, "time_total_s": 109.6941020488739, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 109.6941020488739, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 30.984615384615385, "ram_util_percent": 92.10769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.22499999403953552, "cur_lr": 4.999999873689376e-05, "total_loss": 10.035066604614258, "policy_loss": 0.032181888818740845, "vf_loss": 10.0, "vf_explained_var": 0.0, "kl": 0.012822050601243973, "entropy": 1.0955054759979248, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -180128.0, "episode_reward_min": -1656490.0, "episode_reward_mean": -849222.4, "episode_len_mean": 2251.05, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27932709970838954, "mean_inference_ms": 1.0144321959705478, "mean_action_processing_ms": 0.10859744464487223, "mean_env_wait_ms": 0.04202842076236858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.001665353775024414, "ViewRequirementAgentConnector_ms": 0.10086178779602051}}, "episode_reward_max": -180128.0, "episode_reward_min": -1656490.0, "episode_reward_mean": -849222.4, "episode_len_mean": 2251.05, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27932709970838954, "mean_inference_ms": 1.0144321959705478, "mean_action_processing_ms": 0.10859744464487223, "mean_env_wait_ms": 0.04202842076236858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.001665353775024414, "ViewRequirementAgentConnector_ms": 0.10086178779602051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.1250806927312, "num_env_steps_trained_throughput_per_sec": 426.1250806927312, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 9131.395, "sample_time_ms": 5859.078, "load_time_ms": 0.312, "load_throughput": 12837413.727, "learn_time_ms": 3267.967, "learn_throughput": 1224.003, "synch_weights_time_ms": 2.941}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 20, "training_iteration": 13, "trial_id": "8124a_00000", "date": "2023-12-11_00-18-24", "timestamp": 1702282704, "time_this_iter_s": 9.393881559371948, "time_total_s": 119.08798360824585, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 119.08798360824585, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.01538461538462, "ram_util_percent": 91.66923076923078}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.22499999403953552, "cur_lr": 4.999999873689376e-05, "total_loss": 9.998221397399902, "policy_loss": -0.00266213808208704, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.026329409331083298, "entropy": 1.06717848777771, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -180128.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -960602.0, "episode_len_mean": 2517.1363636363635, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27986523961612497, "mean_inference_ms": 1.0147200821134912, "mean_action_processing_ms": 0.1087328479204337, "mean_env_wait_ms": 0.041944278393400196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0015139579772949219, "ViewRequirementAgentConnector_ms": 0.0943866643038663}}, "episode_reward_max": -180128.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -960602.0, "episode_len_mean": 2517.1363636363635, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27986523961612497, "mean_inference_ms": 1.0147200821134912, "mean_action_processing_ms": 0.1087328479204337, "mean_env_wait_ms": 0.041944278393400196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0015139579772949219, "ViewRequirementAgentConnector_ms": 0.0943866643038663}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 431.37422483098663, "num_env_steps_trained_throughput_per_sec": 431.37422483098663, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 9142.329, "sample_time_ms": 5867.724, "load_time_ms": 0.343, "load_throughput": 11665426.227, "learn_time_ms": 3270.169, "learn_throughput": 1223.178, "synch_weights_time_ms": 2.929}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 22, "training_iteration": 14, "trial_id": "8124a_00000", "date": "2023-12-11_00-18-33", "timestamp": 1702282713, "time_this_iter_s": 9.28071117401123, "time_total_s": 128.36869478225708, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 128.36869478225708, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 31.284615384615385, "ram_util_percent": 91.21538461538464}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.3375000059604645, "cur_lr": 4.999999873689376e-05, "total_loss": 10.017674446105957, "policy_loss": 0.01848612353205681, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.012531235814094543, "entropy": 1.0889921188354492, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -180128.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -935721.0416666666, "episode_len_mean": 2455.375, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28026529817223367, "mean_inference_ms": 1.014903191483686, "mean_action_processing_ms": 0.10883951223197064, "mean_env_wait_ms": 0.04187606194631122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.001387794812520345, "ViewRequirementAgentConnector_ms": 0.09568532307942708}}, "episode_reward_max": -180128.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -935721.0416666666, "episode_len_mean": 2455.375, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28026529817223367, "mean_inference_ms": 1.014903191483686, "mean_action_processing_ms": 0.10883951223197064, "mean_env_wait_ms": 0.04187606194631122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.001387794812520345, "ViewRequirementAgentConnector_ms": 0.09568532307942708}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.7684832282978, "num_env_steps_trained_throughput_per_sec": 442.7684832282978, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 9153.067, "sample_time_ms": 5876.002, "load_time_ms": 0.343, "load_throughput": 11665426.227, "learn_time_ms": 3272.827, "learn_throughput": 1222.185, "synch_weights_time_ms": 2.93}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 24, "training_iteration": 15, "trial_id": "8124a_00000", "date": "2023-12-11_00-18-42", "timestamp": 1702282722, "time_this_iter_s": 9.042053937911987, "time_total_s": 137.41074872016907, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 137.41074872016907, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 28.691666666666666, "ram_util_percent": 91.15000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.3375000059604645, "cur_lr": 4.999999873689376e-05, "total_loss": 10.012907028198242, "policy_loss": 0.012693940661847591, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.00810029823333025, "entropy": 1.0792438983917236, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -180128.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -967568.88, "episode_len_mean": 2555.6, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28043526641127847, "mean_inference_ms": 1.0150470504381455, "mean_action_processing_ms": 0.1088959151362008, "mean_env_wait_ms": 0.0418394681831025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0013322830200195312, "ViewRequirementAgentConnector_ms": 0.09185791015625}}, "episode_reward_max": -180128.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -967568.88, "episode_len_mean": 2555.6, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28043526641127847, "mean_inference_ms": 1.0150470504381455, "mean_action_processing_ms": 0.1088959151362008, "mean_env_wait_ms": 0.0418394681831025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0013322830200195312, "ViewRequirementAgentConnector_ms": 0.09185791015625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.4335631720915, "num_env_steps_trained_throughput_per_sec": 435.4335631720915, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 9175.551, "sample_time_ms": 5897.45, "load_time_ms": 0.343, "load_throughput": 11665426.227, "learn_time_ms": 3273.843, "learn_throughput": 1221.806, "synch_weights_time_ms": 3.107}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 25, "training_iteration": 16, "trial_id": "8124a_00000", "date": "2023-12-11_00-18-51", "timestamp": 1702282731, "time_this_iter_s": 9.194255590438843, "time_total_s": 146.6050043106079, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 146.6050043106079, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 33.792307692307695, "ram_util_percent": 91.88461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.3375000059604645, "cur_lr": 4.999999873689376e-05, "total_loss": 10.018718719482422, "policy_loss": 0.021790990605950356, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.0058321403339505196, "entropy": 1.092248797416687, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -180128.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -943850.1851851852, "episode_len_mean": 2499.8518518518517, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28075518181044673, "mean_inference_ms": 1.0152141220400177, "mean_action_processing_ms": 0.10898743752266052, "mean_env_wait_ms": 0.041755979015543496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0012335953889069733, "ViewRequirementAgentConnector_ms": 0.09573918801766855}}, "episode_reward_max": -180128.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -943850.1851851852, "episode_len_mean": 2499.8518518518517, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28075518181044673, "mean_inference_ms": 1.0152141220400177, "mean_action_processing_ms": 0.10898743752266052, "mean_env_wait_ms": 0.041755979015543496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0012335953889069733, "ViewRequirementAgentConnector_ms": 0.09573918801766855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 444.4108093663756, "num_env_steps_trained_throughput_per_sec": 444.4108093663756, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 9170.924, "sample_time_ms": 5893.269, "load_time_ms": 0.343, "load_throughput": 11665426.227, "learn_time_ms": 3273.386, "learn_throughput": 1221.976, "synch_weights_time_ms": 3.109}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 27, "training_iteration": 17, "trial_id": "8124a_00000", "date": "2023-12-11_00-19-00", "timestamp": 1702282740, "time_this_iter_s": 9.006714820861816, "time_total_s": 155.61171913146973, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 155.61171913146973, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 31.207692307692305, "ram_util_percent": 91.88461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.3375000059604645, "cur_lr": 4.999999873689376e-05, "total_loss": 10.015143394470215, "policy_loss": 0.022369148209691048, "vf_loss": 9.992439270019531, "vf_explained_var": 0.0, "kl": 0.0009901029989123344, "entropy": 1.095632791519165, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -99190.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -891154.6666666666, "episode_len_mean": 2372.5333333333333, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28112598196272726, "mean_inference_ms": 1.0153376058744088, "mean_action_processing_ms": 0.10908403968799232, "mean_env_wait_ms": 0.041637499355023526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0011102358500162761, "ViewRequirementAgentConnector_ms": 0.10061105092366536}}, "episode_reward_max": -99190.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -891154.6666666666, "episode_len_mean": 2372.5333333333333, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28112598196272726, "mean_inference_ms": 1.0153376058744088, "mean_action_processing_ms": 0.10908403968799232, "mean_env_wait_ms": 0.041637499355023526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0011102358500162761, "ViewRequirementAgentConnector_ms": 0.10061105092366536}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.97356971536414, "num_env_steps_trained_throughput_per_sec": 443.97356971536414, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 9160.017, "sample_time_ms": 5896.154, "load_time_ms": 0.343, "load_throughput": 11665426.227, "learn_time_ms": 3259.657, "learn_throughput": 1227.123, "synch_weights_time_ms": 3.121}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 30, "training_iteration": 18, "trial_id": "8124a_00000", "date": "2023-12-11_00-19-09", "timestamp": 1702282749, "time_this_iter_s": 9.016553401947021, "time_total_s": 164.62827253341675, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 164.62827253341675, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 31.700000000000003, "ram_util_percent": 91.79230769230767}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.16875000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 10.000351905822754, "policy_loss": 0.004333100747317076, "vf_loss": 9.992439270019531, "vf_explained_var": 0.0, "kl": 0.02120974473655224, "entropy": 1.066200852394104, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -62646.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -856277.7272727273, "episode_len_mean": 2292.757575757576, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28143912859469616, "mean_inference_ms": 1.0154637205588215, "mean_action_processing_ms": 0.10915476609784197, "mean_env_wait_ms": 0.041513507147259765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029982942523378315, "StateBufferConnector_ms": 0.0010093053181966145, "ViewRequirementAgentConnector_ms": 0.10317527886592981}}, "episode_reward_max": -62646.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -856277.7272727273, "episode_len_mean": 2292.757575757576, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28143912859469616, "mean_inference_ms": 1.0154637205588215, "mean_action_processing_ms": 0.10915476609784197, "mean_env_wait_ms": 0.041513507147259765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029982942523378315, "StateBufferConnector_ms": 0.0010093053181966145, "ViewRequirementAgentConnector_ms": 0.10317527886592981}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.72404851248814, "num_env_steps_trained_throughput_per_sec": 440.72404851248814, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 9173.557, "sample_time_ms": 5911.809, "load_time_ms": 0.343, "load_throughput": 11665426.227, "learn_time_ms": 3257.441, "learn_throughput": 1227.958, "synch_weights_time_ms": 3.142}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 33, "training_iteration": 19, "trial_id": "8124a_00000", "date": "2023-12-11_00-19-18", "timestamp": 1702282758, "time_this_iter_s": 9.082988739013672, "time_total_s": 173.71126127243042, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 173.71126127243042, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 31.599999999999998, "ram_util_percent": 91.51666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.25312501192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 10.021526336669922, "policy_loss": 0.02330031618475914, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.012904173694550991, "entropy": 1.0895739793777466, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -62646.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -851185.6857142857, "episode_len_mean": 2269.4857142857145, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2815961360860527, "mean_inference_ms": 1.0154837297985955, "mean_action_processing_ms": 0.10919986690534779, "mean_env_wait_ms": 0.04143684194682854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002826963152204241, "StateBufferConnector_ms": 0.0009516307285853795, "ViewRequirementAgentConnector_ms": 0.0998762675694057}}, "episode_reward_max": -62646.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -851185.6857142857, "episode_len_mean": 2269.4857142857145, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2815961360860527, "mean_inference_ms": 1.0154837297985955, "mean_action_processing_ms": 0.10919986690534779, "mean_env_wait_ms": 0.04143684194682854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002826963152204241, "StateBufferConnector_ms": 0.0009516307285853795, "ViewRequirementAgentConnector_ms": 0.0998762675694057}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.57188989031295, "num_env_steps_trained_throughput_per_sec": 437.57188989031295, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 9116.812, "sample_time_ms": 5854.603, "load_time_ms": 0.342, "load_throughput": 11702040.873, "learn_time_ms": 3257.79, "learn_throughput": 1227.826, "synch_weights_time_ms": 3.058}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 35, "training_iteration": 20, "trial_id": "8124a_00000", "date": "2023-12-11_00-19-28", "timestamp": 1702282768, "time_this_iter_s": 9.148366689682007, "time_total_s": 182.85962796211243, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 182.85962796211243, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 31.66923076923077, "ram_util_percent": 91.83076923076922}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.25312501192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 10.007022857666016, "policy_loss": 0.014558662660419941, "vf_loss": 9.989919662475586, "vf_explained_var": 4.230007011329917e-09, "kl": 0.010054042562842369, "entropy": 1.0978729724884033, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -801428.4102564103, "episode_len_mean": 2146.897435897436, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2818499430920326, "mean_inference_ms": 1.0154829040146396, "mean_action_processing_ms": 0.10924682902593698, "mean_env_wait_ms": 0.04129917749579596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025370182135166265, "StateBufferConnector_ms": 0.000854027576935597, "ViewRequirementAgentConnector_ms": 0.09358051495674329}}, "episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -801428.4102564103, "episode_len_mean": 2146.897435897436, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2818499430920326, "mean_inference_ms": 1.0154829040146396, "mean_action_processing_ms": 0.10924682902593698, "mean_env_wait_ms": 0.04129917749579596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025370182135166265, "StateBufferConnector_ms": 0.000854027576935597, "ViewRequirementAgentConnector_ms": 0.09358051495674329}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.9275281999987, "num_env_steps_trained_throughput_per_sec": 442.9275281999987, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 9123.598, "sample_time_ms": 5860.118, "load_time_ms": 0.318, "load_throughput": 12568144.43, "learn_time_ms": 3259.185, "learn_throughput": 1227.301, "synch_weights_time_ms": 2.89}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 39, "training_iteration": 21, "trial_id": "8124a_00000", "date": "2023-12-11_00-19-37", "timestamp": 1702282777, "time_this_iter_s": 9.038815259933472, "time_total_s": 191.8984432220459, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 191.8984432220459, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 32.638461538461534, "ram_util_percent": 91.93076923076924}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.25312501192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 10.004327774047852, "policy_loss": 0.0033410966861993074, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.02380678802728653, "entropy": 1.0794936418533325, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -811480.3170731707, "episode_len_mean": 2132.9024390243903, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28194510480264323, "mean_inference_ms": 1.0154274644226673, "mean_action_processing_ms": 0.10926021527510443, "mean_env_wait_ms": 0.041234999869618795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024132612274914253, "StateBufferConnector_ms": 0.0008123676951338606, "ViewRequirementAgentConnector_ms": 0.0904914809436333}}, "episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -811480.3170731707, "episode_len_mean": 2132.9024390243903, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28194510480264323, "mean_inference_ms": 1.0154274644226673, "mean_action_processing_ms": 0.10926021527510443, "mean_env_wait_ms": 0.041234999869618795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024132612274914253, "StateBufferConnector_ms": 0.0008123676951338606, "ViewRequirementAgentConnector_ms": 0.0904914809436333}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 448.6232694687812, "num_env_steps_trained_throughput_per_sec": 448.6232694687812, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 9105.446, "sample_time_ms": 5840.906, "load_time_ms": 0.272, "load_throughput": 14685938.375, "learn_time_ms": 3259.996, "learn_throughput": 1226.995, "synch_weights_time_ms": 2.989}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 41, "training_iteration": 22, "trial_id": "8124a_00000", "date": "2023-12-11_00-19-46", "timestamp": 1702282786, "time_this_iter_s": 8.922157049179077, "time_total_s": 200.82060027122498, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 200.82060027122498, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 28.28333333333333, "ram_util_percent": 92.00833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.37968748807907104, "cur_lr": 4.999999873689376e-05, "total_loss": 10.009011268615723, "policy_loss": 0.012449896894395351, "vf_loss": 9.992439270019531, "vf_explained_var": 0.0, "kl": 0.010858513414859772, "entropy": 1.0924348831176758, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -784877.0909090909, "episode_len_mean": 2060.318181818182, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2820633474469296, "mean_inference_ms": 1.0153267736981013, "mean_action_processing_ms": 0.10926058445406382, "mean_env_wait_ms": 0.0411468871792843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022487206892533736, "StateBufferConnector_ms": 0.0007569789886474609, "ViewRequirementAgentConnector_ms": 0.08990710431879217}}, "episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -784877.0909090909, "episode_len_mean": 2060.318181818182, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2820633474469296, "mean_inference_ms": 1.0153267736981013, "mean_action_processing_ms": 0.10926058445406382, "mean_env_wait_ms": 0.0411468871792843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022487206892533736, "StateBufferConnector_ms": 0.0007569789886474609, "ViewRequirementAgentConnector_ms": 0.08990710431879217}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.24073841682906, "num_env_steps_trained_throughput_per_sec": 443.24073841682906, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 9069.199, "sample_time_ms": 5804.215, "load_time_ms": 0.272, "load_throughput": 14685938.375, "learn_time_ms": 3260.439, "learn_throughput": 1226.829, "synch_weights_time_ms": 2.99}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 44, "training_iteration": 23, "trial_id": "8124a_00000", "date": "2023-12-11_00-19-55", "timestamp": 1702282795, "time_this_iter_s": 9.032400846481323, "time_total_s": 209.8530011177063, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 209.8530011177063, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 31.584615384615386, "ram_util_percent": 91.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.37968748807907104, "cur_lr": 4.999999873689376e-05, "total_loss": 10.018758773803711, "policy_loss": 0.020444229245185852, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.002197935013100505, "entropy": 1.0840308666229248, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -799182.5333333333, "episode_len_mean": 2102.177777777778, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2821011328108787, "mean_inference_ms": 1.0153022771165268, "mean_action_processing_ms": 0.10925510173994236, "mean_env_wait_ms": 0.041119387498754705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021987491183810765, "StateBufferConnector_ms": 0.000740157233344184, "ViewRequirementAgentConnector_ms": 0.08880032433403863}}, "episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -799182.5333333333, "episode_len_mean": 2102.177777777778, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2821011328108787, "mean_inference_ms": 1.0153022771165268, "mean_action_processing_ms": 0.10925510173994236, "mean_env_wait_ms": 0.041119387498754705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021987491183810765, "StateBufferConnector_ms": 0.000740157233344184, "ViewRequirementAgentConnector_ms": 0.08880032433403863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 439.8926787902643, "num_env_steps_trained_throughput_per_sec": 439.8926787902643, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 9051.243, "sample_time_ms": 5793.835, "load_time_ms": 0.275, "load_throughput": 14555974.319, "learn_time_ms": 3252.76, "learn_throughput": 1229.725, "synch_weights_time_ms": 2.988}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 45, "training_iteration": 24, "trial_id": "8124a_00000", "date": "2023-12-11_00-20-04", "timestamp": 1702282804, "time_this_iter_s": 9.099138975143433, "time_total_s": 218.95214009284973, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 218.95214009284973, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 32.48461538461538, "ram_util_percent": 91.8153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.18984374403953552, "cur_lr": 4.999999873689376e-05, "total_loss": 10.030501365661621, "policy_loss": 0.027766533195972443, "vf_loss": 10.0, "vf_explained_var": 0.0, "kl": 0.014404690824449062, "entropy": 1.0901532173156738, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -799182.5333333333, "episode_len_mean": 2102.177777777778, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2821011328108787, "mean_inference_ms": 1.0153022771165268, "mean_action_processing_ms": 0.10925510173994236, "mean_env_wait_ms": 0.041119387498754705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021987491183810765, "StateBufferConnector_ms": 0.000740157233344184, "ViewRequirementAgentConnector_ms": 0.08880032433403863}}, "episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -799182.5333333333, "episode_len_mean": 2102.177777777778, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2821011328108787, "mean_inference_ms": 1.0153022771165268, "mean_action_processing_ms": 0.10925510173994236, "mean_env_wait_ms": 0.041119387498754705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021987491183810765, "StateBufferConnector_ms": 0.000740157233344184, "ViewRequirementAgentConnector_ms": 0.08880032433403863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.61726720777284, "num_env_steps_trained_throughput_per_sec": 388.61726720777284, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 9177.126, "sample_time_ms": 5787.5, "load_time_ms": 0.275, "load_throughput": 14555974.319, "learn_time_ms": 3384.71, "learn_throughput": 1181.785, "synch_weights_time_ms": 3.088}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 45, "training_iteration": 25, "trial_id": "8124a_00000", "date": "2023-12-11_00-20-14", "timestamp": 1702282814, "time_this_iter_s": 10.303942918777466, "time_total_s": 229.2560830116272, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 229.2560830116272, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 41.685714285714276, "ram_util_percent": 92.28571428571426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.18984374403953552, "cur_lr": 4.999999873689376e-05, "total_loss": 9.998769760131836, "policy_loss": -0.0013100167270749807, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.026966283097863197, "entropy": 1.0698949098587036, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -838511.085106383, "episode_len_mean": 2194.148936170213, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28255034579069704, "mean_inference_ms": 1.0161296646177047, "mean_action_processing_ms": 0.10948274747182286, "mean_env_wait_ms": 0.04115281626583255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002105185326109541, "StateBufferConnector_ms": 0.0007086611808614528, "ViewRequirementAgentConnector_ms": 0.08677827551009808}}, "episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -838511.085106383, "episode_len_mean": 2194.148936170213, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28255034579069704, "mean_inference_ms": 1.0161296646177047, "mean_action_processing_ms": 0.10948274747182286, "mean_env_wait_ms": 0.04115281626583255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002105185326109541, "StateBufferConnector_ms": 0.0007086611808614528, "ViewRequirementAgentConnector_ms": 0.08677827551009808}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.80401478643535, "num_env_steps_trained_throughput_per_sec": 294.80401478643535, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 9615.335, "sample_time_ms": 6179.807, "load_time_ms": 0.396, "load_throughput": 10096416.922, "learn_time_ms": 3430.393, "learn_throughput": 1166.047, "synch_weights_time_ms": 3.014}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 47, "training_iteration": 26, "trial_id": "8124a_00000", "date": "2023-12-11_00-20-28", "timestamp": 1702282828, "time_this_iter_s": 13.576227188110352, "time_total_s": 242.83231019973755, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 242.83231019973755, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 45.30526315789474, "ram_util_percent": 94.21052631578948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.2847656309604645, "cur_lr": 4.999999873689376e-05, "total_loss": 10.013100624084473, "policy_loss": 0.014660281129181385, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.012225181795656681, "entropy": 1.0924257040023804, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -833005.1836734693, "episode_len_mean": 2174.469387755102, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28300655236204303, "mean_inference_ms": 1.0169783329778814, "mean_action_processing_ms": 0.10971659354980356, "mean_env_wait_ms": 0.04119679037519477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002770521202865912, "StateBufferConnector_ms": 0.0006797362347038425, "ViewRequirementAgentConnector_ms": 0.08592994845643336}}, "episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -833005.1836734693, "episode_len_mean": 2174.469387755102, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28300655236204303, "mean_inference_ms": 1.0169783329778814, "mean_action_processing_ms": 0.10971659354980356, "mean_env_wait_ms": 0.04119679037519477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002770521202865912, "StateBufferConnector_ms": 0.0006797362347038425, "ViewRequirementAgentConnector_ms": 0.08592994845643336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.53013140855614, "num_env_steps_trained_throughput_per_sec": 413.53013140855614, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 9682.549, "sample_time_ms": 6246.714, "load_time_ms": 0.496, "load_throughput": 8060543.865, "learn_time_ms": 3430.807, "learn_throughput": 1165.906, "synch_weights_time_ms": 2.912}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 49, "training_iteration": 27, "trial_id": "8124a_00000", "date": "2023-12-11_00-20-38", "timestamp": 1702282838, "time_this_iter_s": 9.747528791427612, "time_total_s": 252.57983899116516, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 252.57983899116516, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 34.871428571428574, "ram_util_percent": 95.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.2847656309604645, "cur_lr": 4.999999873689376e-05, "total_loss": 9.99402904510498, "policy_loss": 0.00535545963793993, "vf_loss": 9.984879493713379, "vf_explained_var": 0.0, "kl": 0.013329282402992249, "entropy": 1.0729084014892578, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -773237.490909091, "episode_len_mean": 2017.4545454545455, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2842982795346179, "mean_inference_ms": 1.019207634234062, "mean_action_processing_ms": 0.1103008517469035, "mean_env_wait_ms": 0.0413067933080583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024682825261896305, "StateBufferConnector_ms": 0.0006055831909179688, "ViewRequirementAgentConnector_ms": 0.09858781641179865}}, "episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -773237.490909091, "episode_len_mean": 2017.4545454545455, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2842982795346179, "mean_inference_ms": 1.019207634234062, "mean_action_processing_ms": 0.1103008517469035, "mean_env_wait_ms": 0.0413067933080583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024682825261896305, "StateBufferConnector_ms": 0.0006055831909179688, "ViewRequirementAgentConnector_ms": 0.09858781641179865}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 425.1552644400275, "num_env_steps_trained_throughput_per_sec": 425.1552644400275, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 9722.427, "sample_time_ms": 6288.481, "load_time_ms": 0.598, "load_throughput": 6692148.385, "learn_time_ms": 3428.842, "learn_throughput": 1166.575, "synch_weights_time_ms": 2.934}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 55, "training_iteration": 28, "trial_id": "8124a_00000", "date": "2023-12-11_00-20-47", "timestamp": 1702282847, "time_this_iter_s": 9.418028831481934, "time_total_s": 261.9978678226471, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 261.9978678226471, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 30.49230769230769, "ram_util_percent": 95.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.2847656309604645, "cur_lr": 4.999999873689376e-05, "total_loss": 10.041573524475098, "policy_loss": 0.03744328022003174, "vf_loss": 10.0, "vf_explained_var": 0.0, "kl": 0.014503414742648602, "entropy": 1.0942553281784058, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -773237.490909091, "episode_len_mean": 2017.4545454545455, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2842982795346179, "mean_inference_ms": 1.019207634234062, "mean_action_processing_ms": 0.1103008517469035, "mean_env_wait_ms": 0.0413067933080583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024682825261896305, "StateBufferConnector_ms": 0.0006055831909179688, "ViewRequirementAgentConnector_ms": 0.09858781641179865}}, "episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -773237.490909091, "episode_len_mean": 2017.4545454545455, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2842982795346179, "mean_inference_ms": 1.019207634234062, "mean_action_processing_ms": 0.1103008517469035, "mean_env_wait_ms": 0.0413067933080583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024682825261896305, "StateBufferConnector_ms": 0.0006055831909179688, "ViewRequirementAgentConnector_ms": 0.09858781641179865}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 439.51318588074537, "num_env_steps_trained_throughput_per_sec": 439.51318588074537, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 9724.927, "sample_time_ms": 6285.357, "load_time_ms": 0.698, "load_throughput": 5732468.651, "learn_time_ms": 3434.565, "learn_throughput": 1164.631, "synch_weights_time_ms": 2.917}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 55, "training_iteration": 29, "trial_id": "8124a_00000", "date": "2023-12-11_00-20-56", "timestamp": 1702282856, "time_this_iter_s": 9.10796070098877, "time_total_s": 271.10582852363586, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 271.10582852363586, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 32.43846153846154, "ram_util_percent": 95.36923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.2847656309604645, "cur_lr": 4.999999873689376e-05, "total_loss": 10.019007682800293, "policy_loss": 0.01670432649552822, "vf_loss": 10.0, "vf_explained_var": 0.0, "kl": 0.008087911643087864, "entropy": 1.0789531469345093, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -773237.490909091, "episode_len_mean": 2017.4545454545455, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2842982795346179, "mean_inference_ms": 1.019207634234062, "mean_action_processing_ms": 0.1103008517469035, "mean_env_wait_ms": 0.0413067933080583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024682825261896305, "StateBufferConnector_ms": 0.0006055831909179688, "ViewRequirementAgentConnector_ms": 0.09858781641179865}}, "episode_reward_max": -5123.0, "episode_reward_min": -3401312.0, "episode_reward_mean": -773237.490909091, "episode_len_mean": 2017.4545454545455, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2842982795346179, "mean_inference_ms": 1.019207634234062, "mean_action_processing_ms": 0.1103008517469035, "mean_env_wait_ms": 0.0413067933080583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024682825261896305, "StateBufferConnector_ms": 0.0006055831909179688, "ViewRequirementAgentConnector_ms": 0.09858781641179865}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.5831147625061, "num_env_steps_trained_throughput_per_sec": 440.5831147625061, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 9718.679, "sample_time_ms": 6295.506, "load_time_ms": 0.599, "load_throughput": 6679093.913, "learn_time_ms": 3418.184, "learn_throughput": 1170.212, "synch_weights_time_ms": 2.999}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 55, "training_iteration": 30, "trial_id": "8124a_00000", "date": "2023-12-11_00-21-06", "timestamp": 1702282866, "time_this_iter_s": 9.085887670516968, "time_total_s": 280.19171619415283, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 280.19171619415283, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 29.923076923076923, "ram_util_percent": 95.1923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.2847656309604645, "cur_lr": 4.999999873689376e-05, "total_loss": 10.023797988891602, "policy_loss": 0.02075536549091339, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.019534144550561905, "entropy": 1.0978420972824097, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -828969.7857142857, "episode_len_mean": 2169.7321428571427, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2844718861936188, "mean_inference_ms": 1.0194947726819057, "mean_action_processing_ms": 0.11037649100047929, "mean_env_wait_ms": 0.04131834034260719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002424206052507673, "StateBufferConnector_ms": 0.0005947692053658622, "ViewRequirementAgentConnector_ms": 0.09924003056117467}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -828969.7857142857, "episode_len_mean": 2169.7321428571427, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2844718861936188, "mean_inference_ms": 1.0194947726819057, "mean_action_processing_ms": 0.11037649100047929, "mean_env_wait_ms": 0.04131834034260719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002424206052507673, "StateBufferConnector_ms": 0.0005947692053658622, "ViewRequirementAgentConnector_ms": 0.09924003056117467}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.55820568425605, "num_env_steps_trained_throughput_per_sec": 435.55820568425605, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 9733.959, "sample_time_ms": 6306.076, "load_time_ms": 0.523, "load_throughput": 7650000.456, "learn_time_ms": 3422.97, "learn_throughput": 1168.576, "synch_weights_time_ms": 3.065}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 56, "training_iteration": 31, "trial_id": "8124a_00000", "date": "2023-12-11_00-21-15", "timestamp": 1702282875, "time_this_iter_s": 9.193626403808594, "time_total_s": 289.3853425979614, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 289.3853425979614, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 33.88461538461539, "ram_util_percent": 95.03846153846153}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.2847656309604645, "cur_lr": 4.999999873689376e-05, "total_loss": 10.005434036254883, "policy_loss": 0.005160345695912838, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.01866016536951065, "entropy": 1.0763744115829468, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -825783.3448275862, "episode_len_mean": 2167.2586206896553, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2847872337195884, "mean_inference_ms": 1.020020330896017, "mean_action_processing_ms": 0.11051780079775908, "mean_env_wait_ms": 0.041334354253691606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002340612740352236, "StateBufferConnector_ms": 0.0005742599224222118, "ViewRequirementAgentConnector_ms": 0.0990694966809503}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -825783.3448275862, "episode_len_mean": 2167.2586206896553, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2847872337195884, "mean_inference_ms": 1.020020330896017, "mean_action_processing_ms": 0.11051780079775908, "mean_env_wait_ms": 0.041334354253691606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002340612740352236, "StateBufferConnector_ms": 0.0005742599224222118, "ViewRequirementAgentConnector_ms": 0.0990694966809503}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.6124473610491, "num_env_steps_trained_throughput_per_sec": 432.6124473610491, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 9766.957, "sample_time_ms": 6319.4, "load_time_ms": 0.523, "load_throughput": 7650000.456, "learn_time_ms": 3442.838, "learn_throughput": 1161.832, "synch_weights_time_ms": 3.065}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 58, "training_iteration": 32, "trial_id": "8124a_00000", "date": "2023-12-11_00-21-24", "timestamp": 1702282884, "time_this_iter_s": 9.254149913787842, "time_total_s": 298.63949251174927, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 298.63949251174927, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 31.46153846153846, "ram_util_percent": 95.13076923076925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.2847656309604645, "cur_lr": 4.999999873689376e-05, "total_loss": 10.045035362243652, "policy_loss": 0.043542325496673584, "vf_loss": 10.0, "vf_explained_var": 0.0, "kl": 0.005243069492280483, "entropy": 1.0873157978057861, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -825783.3448275862, "episode_len_mean": 2167.2586206896553, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2847872337195884, "mean_inference_ms": 1.020020330896017, "mean_action_processing_ms": 0.11051780079775908, "mean_env_wait_ms": 0.041334354253691606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002340612740352236, "StateBufferConnector_ms": 0.0005742599224222118, "ViewRequirementAgentConnector_ms": 0.0990694966809503}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -825783.3448275862, "episode_len_mean": 2167.2586206896553, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2847872337195884, "mean_inference_ms": 1.020020330896017, "mean_action_processing_ms": 0.11051780079775908, "mean_env_wait_ms": 0.041334354253691606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002340612740352236, "StateBufferConnector_ms": 0.0005742599224222118, "ViewRequirementAgentConnector_ms": 0.0990694966809503}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.6931987491219, "num_env_steps_trained_throughput_per_sec": 436.6931987491219, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 9780.488, "sample_time_ms": 6335.684, "load_time_ms": 0.523, "load_throughput": 7650000.456, "learn_time_ms": 3439.791, "learn_throughput": 1162.861, "synch_weights_time_ms": 3.059}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 58, "training_iteration": 33, "trial_id": "8124a_00000", "date": "2023-12-11_00-21-33", "timestamp": 1702282893, "time_this_iter_s": 9.167793273925781, "time_total_s": 307.80728578567505, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 307.80728578567505, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 30.661538461538463, "ram_util_percent": 95.32307692307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.2847656309604645, "cur_lr": 4.999999873689376e-05, "total_loss": 10.005208969116211, "policy_loss": 0.014262876473367214, "vf_loss": 9.989919662475586, "vf_explained_var": 0.0, "kl": 0.00360695319250226, "entropy": 1.0764050483703613, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -831414.1774193548, "episode_len_mean": 2187.532258064516, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28534763131040747, "mean_inference_ms": 1.0208573342857776, "mean_action_processing_ms": 0.11077121570661061, "mean_env_wait_ms": 0.04135015144800083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002189605466781124, "StateBufferConnector_ms": 0.0005372108951691658, "ViewRequirementAgentConnector_ms": 0.09997583204700101}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -831414.1774193548, "episode_len_mean": 2187.532258064516, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28534763131040747, "mean_inference_ms": 1.0208573342857776, "mean_action_processing_ms": 0.11077121570661061, "mean_env_wait_ms": 0.04135015144800083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002189605466781124, "StateBufferConnector_ms": 0.0005372108951691658, "ViewRequirementAgentConnector_ms": 0.09997583204700101}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.8314662114532, "num_env_steps_trained_throughput_per_sec": 443.8314662114532, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 9772.418, "sample_time_ms": 6327.125, "load_time_ms": 0.423, "load_throughput": 9456747.647, "learn_time_ms": 3440.378, "learn_throughput": 1162.663, "synch_weights_time_ms": 3.16}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 62, "training_iteration": 34, "trial_id": "8124a_00000", "date": "2023-12-11_00-21-42", "timestamp": 1702282902, "time_this_iter_s": 9.019441843032837, "time_total_s": 316.8267276287079, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 316.8267276287079, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 31.566666666666666, "ram_util_percent": 95.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.14238281548023224, "cur_lr": 4.999999873689376e-05, "total_loss": 10.023119926452637, "policy_loss": 0.022918596863746643, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.019119102507829666, "entropy": 1.0801304578781128, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -830138.6031746032, "episode_len_mean": 2186.0793650793653, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.285472311079773, "mean_inference_ms": 1.0210335721251251, "mean_action_processing_ms": 0.1108297365873235, "mean_env_wait_ms": 0.04135279300368081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002154849824451265, "StateBufferConnector_ms": 0.0021567420353965153, "ViewRequirementAgentConnector_ms": 0.10192734854561943}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -830138.6031746032, "episode_len_mean": 2186.0793650793653, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.285472311079773, "mean_inference_ms": 1.0210335721251251, "mean_action_processing_ms": 0.1108297365873235, "mean_env_wait_ms": 0.04135279300368081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002154849824451265, "StateBufferConnector_ms": 0.0021567420353965153, "ViewRequirementAgentConnector_ms": 0.10192734854561943}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.4221782027279, "num_env_steps_trained_throughput_per_sec": 443.4221782027279, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 9645.203, "sample_time_ms": 6332.632, "load_time_ms": 0.423, "load_throughput": 9456747.647, "learn_time_ms": 3307.823, "learn_throughput": 1209.255, "synch_weights_time_ms": 3.16}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 63, "training_iteration": 35, "trial_id": "8124a_00000", "date": "2023-12-11_00-21-51", "timestamp": 1702282911, "time_this_iter_s": 9.028747797012329, "time_total_s": 325.8554754257202, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 325.8554754257202, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 32.06923076923077, "ram_util_percent": 95.3153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.14238281548023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.994776725769043, "policy_loss": -0.0034881585743278265, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.02321961149573326, "entropy": 1.0625303983688354, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -832141.676923077, "episode_len_mean": 2193.7384615384617, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28571069764794754, "mean_inference_ms": 1.0213610392618113, "mean_action_processing_ms": 0.11093351869303411, "mean_env_wait_ms": 0.04135717773026088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020885467529296875, "StateBufferConnector_ms": 0.0020903807419996997, "ViewRequirementAgentConnector_ms": 0.10301259847787711}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -832141.676923077, "episode_len_mean": 2193.7384615384617, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28571069764794754, "mean_inference_ms": 1.0213610392618113, "mean_action_processing_ms": 0.11093351869303411, "mean_env_wait_ms": 0.04135717773026088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020885467529296875, "StateBufferConnector_ms": 0.0020903807419996997, "ViewRequirementAgentConnector_ms": 0.10301259847787711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.0150648312415, "num_env_steps_trained_throughput_per_sec": 435.0150648312415, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 9207.878, "sample_time_ms": 5935.196, "load_time_ms": 0.302, "load_throughput": 13262621.344, "learn_time_ms": 3267.973, "learn_throughput": 1224.0, "synch_weights_time_ms": 3.251}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 65, "training_iteration": 36, "trial_id": "8124a_00000", "date": "2023-12-11_00-22-01", "timestamp": 1702282921, "time_this_iter_s": 9.203091144561768, "time_total_s": 335.058566570282, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 335.058566570282, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 29.66923076923077, "ram_util_percent": 95.20769230769233}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.21357421576976776, "cur_lr": 4.999999873689376e-05, "total_loss": 10.010894775390625, "policy_loss": 0.010622118599712849, "vf_loss": 9.994959831237793, "vf_explained_var": -4.230007011329917e-09, "kl": 0.024874525144696236, "entropy": 1.0549907684326172, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -838722.7910447761, "episode_len_mean": 2208.4776119402986, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2859233938775821, "mean_inference_ms": 1.0216463001931175, "mean_action_processing_ms": 0.1110229814786555, "mean_env_wait_ms": 0.04136100294682061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020262020737377567, "StateBufferConnector_ms": 0.00202798131686538, "ViewRequirementAgentConnector_ms": 0.1006087260459786}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -838722.7910447761, "episode_len_mean": 2208.4776119402986, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2859233938775821, "mean_inference_ms": 1.0216463001931175, "mean_action_processing_ms": 0.1110229814786555, "mean_env_wait_ms": 0.04136100294682061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020262020737377567, "StateBufferConnector_ms": 0.00202798131686538, "ViewRequirementAgentConnector_ms": 0.1006087260459786}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.9208942463174, "num_env_steps_trained_throughput_per_sec": 443.9208942463174, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 9141.658, "sample_time_ms": 5866.063, "load_time_ms": 0.301, "load_throughput": 13289936.629, "learn_time_ms": 3270.787, "learn_throughput": 1222.947, "synch_weights_time_ms": 3.351}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 67, "training_iteration": 37, "trial_id": "8124a_00000", "date": "2023-12-11_00-22-10", "timestamp": 1702282930, "time_this_iter_s": 9.01761269569397, "time_total_s": 344.07617926597595, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 344.07617926597595, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 31.030769230769234, "ram_util_percent": 95.20769230769233}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.32036131620407104, "cur_lr": 4.999999873689376e-05, "total_loss": 10.006926536560059, "policy_loss": 0.000974037975538522, "vf_loss": 10.0, "vf_explained_var": 0.0, "kl": 0.018577592447400093, "entropy": 1.0394182205200195, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -838722.7910447761, "episode_len_mean": 2208.4776119402986, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2859233938775821, "mean_inference_ms": 1.0216463001931175, "mean_action_processing_ms": 0.1110229814786555, "mean_env_wait_ms": 0.04136100294682061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020262020737377567, "StateBufferConnector_ms": 0.00202798131686538, "ViewRequirementAgentConnector_ms": 0.1006087260459786}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -838722.7910447761, "episode_len_mean": 2208.4776119402986, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2859233938775821, "mean_inference_ms": 1.0216463001931175, "mean_action_processing_ms": 0.1110229814786555, "mean_env_wait_ms": 0.04136100294682061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020262020737377567, "StateBufferConnector_ms": 0.00202798131686538, "ViewRequirementAgentConnector_ms": 0.1006087260459786}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.71364198618693, "num_env_steps_trained_throughput_per_sec": 433.71364198618693, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 9123.092, "sample_time_ms": 5835.299, "load_time_ms": 0.2, "load_throughput": 20049254.302, "learn_time_ms": 3283.094, "learn_throughput": 1218.363, "synch_weights_time_ms": 3.298}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 67, "training_iteration": 38, "trial_id": "8124a_00000", "date": "2023-12-11_00-22-19", "timestamp": 1702282939, "time_this_iter_s": 9.229675769805908, "time_total_s": 353.30585503578186, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 353.30585503578186, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 30.446153846153848, "ram_util_percent": 95.17692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.32036131620407104, "cur_lr": 4.999999873689376e-05, "total_loss": 10.028830528259277, "policy_loss": 0.026876145973801613, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.013966589234769344, "entropy": 1.0483169555664062, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -863619.4705882353, "episode_len_mean": 2257.3529411764707, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2860208485495304, "mean_inference_ms": 1.0217720590606907, "mean_action_processing_ms": 0.11105698922177787, "mean_env_wait_ms": 0.04135945849031701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0019964049844180837, "StateBufferConnector_ms": 0.0064565854914048135, "ViewRequirementAgentConnector_ms": 0.09983322199653177}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -863619.4705882353, "episode_len_mean": 2257.3529411764707, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2860208485495304, "mean_inference_ms": 1.0217720590606907, "mean_action_processing_ms": 0.11105698922177787, "mean_env_wait_ms": 0.04135945849031701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0019964049844180837, "StateBufferConnector_ms": 0.0064565854914048135, "ViewRequirementAgentConnector_ms": 0.09983322199653177}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.2455395970076, "num_env_steps_trained_throughput_per_sec": 443.2455395970076, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 9115.429, "sample_time_ms": 5830.685, "load_time_ms": 0.099, "load_throughput": 40223485.975, "learn_time_ms": 3280.047, "learn_throughput": 1219.495, "synch_weights_time_ms": 3.32}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 68, "training_iteration": 39, "trial_id": "8124a_00000", "date": "2023-12-11_00-22-28", "timestamp": 1702282948, "time_this_iter_s": 9.031355857849121, "time_total_s": 362.337210893631, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 362.337210893631, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 29.508333333333336, "ram_util_percent": 95.08333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.32036131620407104, "cur_lr": 4.999999873689376e-05, "total_loss": 9.996885299682617, "policy_loss": 0.001258006552234292, "vf_loss": 9.989919662475586, "vf_explained_var": 0.0, "kl": 0.01781611703336239, "entropy": 1.0318717956542969, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -851844.6527777778, "episode_len_mean": 2218.8611111111113, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28637436298470714, "mean_inference_ms": 1.0222192142741495, "mean_action_processing_ms": 0.11117406801737112, "mean_env_wait_ms": 0.04135251978946794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0018854935963948567, "StateBufferConnector_ms": 0.00609788629743788, "ViewRequirementAgentConnector_ms": 0.10111033916473389}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -851844.6527777778, "episode_len_mean": 2218.8611111111113, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28637436298470714, "mean_inference_ms": 1.0222192142741495, "mean_action_processing_ms": 0.11117406801737112, "mean_env_wait_ms": 0.04135251978946794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0018854935963948567, "StateBufferConnector_ms": 0.00609788629743788, "ViewRequirementAgentConnector_ms": 0.10111033916473389}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.3734839832055, "num_env_steps_trained_throughput_per_sec": 440.3734839832055, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 9115.861, "sample_time_ms": 5829.335, "load_time_ms": 0.201, "load_throughput": 19892359.497, "learn_time_ms": 3281.925, "learn_throughput": 1218.797, "synch_weights_time_ms": 3.219}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 72, "training_iteration": 40, "trial_id": "8124a_00000", "date": "2023-12-11_00-22-37", "timestamp": 1702282957, "time_this_iter_s": 9.091197967529297, "time_total_s": 371.4284088611603, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 371.4284088611603, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 30.753846153846155, "ram_util_percent": 95.17692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.32036131620407104, "cur_lr": 4.999999873689376e-05, "total_loss": 10.029850959777832, "policy_loss": 0.025104597210884094, "vf_loss": 10.0, "vf_explained_var": 0.0, "kl": 0.014816190116107464, "entropy": 1.0289866924285889, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -851844.6527777778, "episode_len_mean": 2218.8611111111113, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28637436298470714, "mean_inference_ms": 1.0222192142741495, "mean_action_processing_ms": 0.11117406801737112, "mean_env_wait_ms": 0.04135251978946794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0018854935963948567, "StateBufferConnector_ms": 0.00609788629743788, "ViewRequirementAgentConnector_ms": 0.10111033916473389}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -851844.6527777778, "episode_len_mean": 2218.8611111111113, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28637436298470714, "mean_inference_ms": 1.0222192142741495, "mean_action_processing_ms": 0.11117406801737112, "mean_env_wait_ms": 0.04135251978946794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0018854935963948567, "StateBufferConnector_ms": 0.00609788629743788, "ViewRequirementAgentConnector_ms": 0.10111033916473389}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.2467398732566, "num_env_steps_trained_throughput_per_sec": 437.2467398732566, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 9112.315, "sample_time_ms": 5825.868, "load_time_ms": 0.201, "load_throughput": 19892359.497, "learn_time_ms": 3281.927, "learn_throughput": 1218.796, "synch_weights_time_ms": 3.239}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 72, "training_iteration": 41, "trial_id": "8124a_00000", "date": "2023-12-11_00-22-46", "timestamp": 1702282966, "time_this_iter_s": 9.154951333999634, "time_total_s": 380.5833601951599, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 380.5833601951599, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 30.784615384615385, "ram_util_percent": 95.28461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.32036131620407104, "cur_lr": 4.999999873689376e-05, "total_loss": 9.999398231506348, "policy_loss": -0.0011185804614797235, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.017344746738672256, "entropy": 1.0156800746917725, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -864400.7162162162, "episode_len_mean": 2256.5135135135133, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2865377923473244, "mean_inference_ms": 1.0224116251724118, "mean_action_processing_ms": 0.11122535478136376, "mean_env_wait_ms": 0.04134969752156442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0018345343100058067, "StateBufferConnector_ms": 0.005933078559669289, "ViewRequirementAgentConnector_ms": 0.09837762729541676}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -864400.7162162162, "episode_len_mean": 2256.5135135135133, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2865377923473244, "mean_inference_ms": 1.0224116251724118, "mean_action_processing_ms": 0.11122535478136376, "mean_env_wait_ms": 0.04134969752156442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0018345343100058067, "StateBufferConnector_ms": 0.005933078559669289, "ViewRequirementAgentConnector_ms": 0.09837762729541676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 430.7393319382389, "num_env_steps_trained_throughput_per_sec": 430.7393319382389, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 9116.335, "sample_time_ms": 5839.354, "load_time_ms": 0.201, "load_throughput": 19892359.497, "learn_time_ms": 3272.565, "learn_throughput": 1222.283, "synch_weights_time_ms": 3.237}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 74, "training_iteration": 42, "trial_id": "8124a_00000", "date": "2023-12-11_00-22-56", "timestamp": 1702282976, "time_this_iter_s": 9.29438328742981, "time_total_s": 389.8777434825897, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 389.8777434825897, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 31.53846153846154, "ram_util_percent": 95.22307692307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.32036131620407104, "cur_lr": 4.999999873689376e-05, "total_loss": 10.033367156982422, "policy_loss": 0.029498836025595665, "vf_loss": 10.0, "vf_explained_var": 0.0, "kl": 0.012072841636836529, "entropy": 1.0162620544433594, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -864400.7162162162, "episode_len_mean": 2256.5135135135133, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2865377923473244, "mean_inference_ms": 1.0224116251724118, "mean_action_processing_ms": 0.11122535478136376, "mean_env_wait_ms": 0.04134969752156442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0018345343100058067, "StateBufferConnector_ms": 0.005933078559669289, "ViewRequirementAgentConnector_ms": 0.09837762729541676}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -864400.7162162162, "episode_len_mean": 2256.5135135135133, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2865377923473244, "mean_inference_ms": 1.0224116251724118, "mean_action_processing_ms": 0.11122535478136376, "mean_env_wait_ms": 0.04134969752156442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0018345343100058067, "StateBufferConnector_ms": 0.005933078559669289, "ViewRequirementAgentConnector_ms": 0.09837762729541676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.2306094388649, "num_env_steps_trained_throughput_per_sec": 443.2306094388649, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 9102.825, "sample_time_ms": 5823.564, "load_time_ms": 0.266, "load_throughput": 15044131.994, "learn_time_ms": 3275.079, "learn_throughput": 1221.345, "synch_weights_time_ms": 3.238}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 74, "training_iteration": 43, "trial_id": "8124a_00000", "date": "2023-12-11_00-23-05", "timestamp": 1702282985, "time_this_iter_s": 9.03366231918335, "time_total_s": 398.91140580177307, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 398.91140580177307, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 30.03076923076923, "ram_util_percent": 95.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.32036131620407104, "cur_lr": 4.999999873689376e-05, "total_loss": 10.005370140075684, "policy_loss": 0.01094975508749485, "vf_loss": 9.992439270019531, "vf_explained_var": 0.0, "kl": 0.006181304343044758, "entropy": 1.0026295185089111, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -873132.2857142857, "episode_len_mean": 2278.3766233766232, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28675067002705945, "mean_inference_ms": 1.0226598143327839, "mean_action_processing_ms": 0.11129263357498581, "mean_env_wait_ms": 0.04134177428659467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0017630589472783077, "StateBufferConnector_ms": 0.005701919654747109, "ViewRequirementAgentConnector_ms": 0.09728933309579825}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -873132.2857142857, "episode_len_mean": 2278.3766233766232, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28675067002705945, "mean_inference_ms": 1.0226598143327839, "mean_action_processing_ms": 0.11129263357498581, "mean_env_wait_ms": 0.04134177428659467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0017630589472783077, "StateBufferConnector_ms": 0.005701919654747109, "ViewRequirementAgentConnector_ms": 0.09728933309579825}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 431.0817641374601, "num_env_steps_trained_throughput_per_sec": 431.0817641374601, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 9129.481, "sample_time_ms": 5840.296, "load_time_ms": 0.366, "load_throughput": 10930494.495, "learn_time_ms": 3285.004, "learn_throughput": 1217.655, "synch_weights_time_ms": 3.239}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 77, "training_iteration": 44, "trial_id": "8124a_00000", "date": "2023-12-11_00-23-14", "timestamp": 1702282994, "time_this_iter_s": 9.28697156906128, "time_total_s": 408.19837737083435, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 408.19837737083435, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 31.323076923076925, "ram_util_percent": 95.24615384615383}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.32036131620407104, "cur_lr": 4.999999873689376e-05, "total_loss": 10.024639129638672, "policy_loss": 0.028125068172812462, "vf_loss": 9.996301651000977, "vf_explained_var": -2.1135294900886947e-06, "kl": 0.0006585385999642313, "entropy": 0.9872704148292542, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -884574.4615384615, "episode_len_mean": 2306.9358974358975, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28681815252755927, "mean_inference_ms": 1.0227365369827623, "mean_action_processing_ms": 0.11131582370020161, "mean_env_wait_ms": 0.04133917165207597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0017404556274414062, "StateBufferConnector_ms": 0.005628818120711889, "ViewRequirementAgentConnector_ms": 0.09846198253142528}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -884574.4615384615, "episode_len_mean": 2306.9358974358975, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28681815252755927, "mean_inference_ms": 1.0227365369827623, "mean_action_processing_ms": 0.11131582370020161, "mean_env_wait_ms": 0.04133917165207597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0017404556274414062, "StateBufferConnector_ms": 0.005628818120711889, "ViewRequirementAgentConnector_ms": 0.09846198253142528}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 410.0550349488166, "num_env_steps_trained_throughput_per_sec": 410.0550349488166, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 9202.885, "sample_time_ms": 5857.071, "load_time_ms": 0.366, "load_throughput": 10930494.495, "learn_time_ms": 3341.514, "learn_throughput": 1197.062, "synch_weights_time_ms": 3.139}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 78, "training_iteration": 45, "trial_id": "8124a_00000", "date": "2023-12-11_00-23-24", "timestamp": 1702283004, "time_this_iter_s": 9.762787580490112, "time_total_s": 417.96116495132446, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 417.96116495132446, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 40.03846153846154, "ram_util_percent": 93.78461538461536}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 10.016498565673828, "policy_loss": 0.01925976574420929, "vf_loss": 9.995076179504395, "vf_explained_var": -1.7644256899984612e-07, "kl": 0.013499478809535503, "entropy": 0.9861429333686829, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -877407.5, "episode_len_mean": 2289.6, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2869613807874581, "mean_inference_ms": 1.0228834947042345, "mean_action_processing_ms": 0.1113698965670693, "mean_env_wait_ms": 0.04133549393123511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022339820861816406, "StateBufferConnector_ms": 0.00628352165222168, "ViewRequirementAgentConnector_ms": 0.09600043296813965}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -877407.5, "episode_len_mean": 2289.6, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2869613807874581, "mean_inference_ms": 1.0228834947042345, "mean_action_processing_ms": 0.1113698965670693, "mean_env_wait_ms": 0.04133549393123511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022339820861816406, "StateBufferConnector_ms": 0.00628352165222168, "ViewRequirementAgentConnector_ms": 0.09600043296813965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.20930083582556, "num_env_steps_trained_throughput_per_sec": 429.20930083582556, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 9215.322, "sample_time_ms": 5879.392, "load_time_ms": 0.366, "load_throughput": 10930494.495, "learn_time_ms": 3331.736, "learn_throughput": 1200.575, "synch_weights_time_ms": 3.14}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 80, "training_iteration": 46, "trial_id": "8124a_00000", "date": "2023-12-11_00-23-33", "timestamp": 1702283013, "time_this_iter_s": 9.327458143234253, "time_total_s": 427.2886230945587, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 427.2886230945587, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 38.93846153846153, "ram_util_percent": 79.6923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 10.008415222167969, "policy_loss": 0.008276285603642464, "vf_loss": 9.997479438781738, "vf_explained_var": -3.332732756433643e-09, "kl": 0.016595538705587387, "entropy": 0.9641913175582886, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -873198.9012345679, "episode_len_mean": 2279.2345679012346, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28702816852711976, "mean_inference_ms": 1.0229478417491331, "mean_action_processing_ms": 0.11139326310406703, "mean_env_wait_ms": 0.041334393288855305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022064020604263116, "StateBufferConnector_ms": 0.006205947310836227, "ViewRequirementAgentConnector_ms": 0.09481524243766878}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -873198.9012345679, "episode_len_mean": 2279.2345679012346, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28702816852711976, "mean_inference_ms": 1.0229478417491331, "mean_action_processing_ms": 0.11139326310406703, "mean_env_wait_ms": 0.041334393288855305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022064020604263116, "StateBufferConnector_ms": 0.006205947310836227, "ViewRequirementAgentConnector_ms": 0.09481524243766878}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.7979473240283, "num_env_steps_trained_throughput_per_sec": 443.7979473240283, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 9215.572, "sample_time_ms": 5881.696, "load_time_ms": 0.368, "load_throughput": 10879460.476, "learn_time_ms": 3329.779, "learn_throughput": 1201.281, "synch_weights_time_ms": 3.141}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 81, "training_iteration": 47, "trial_id": "8124a_00000", "date": "2023-12-11_00-23-43", "timestamp": 1702283023, "time_this_iter_s": 9.021106481552124, "time_total_s": 436.30972957611084, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 436.30972957611084, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 31.34615384615385, "ram_util_percent": 79.0923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 10.021589279174805, "policy_loss": 0.021481934934854507, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.01640419475734234, "entropy": 0.9488700032234192, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -890939.0731707317, "episode_len_mean": 2314.3536585365855, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2870936842940442, "mean_inference_ms": 1.023006068435184, "mean_action_processing_ms": 0.11141431611898016, "mean_env_wait_ms": 0.04133234105071831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002179494718225991, "StateBufferConnector_ms": 0.006130265026557736, "ViewRequirementAgentConnector_ms": 0.09365895899330698}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -890939.0731707317, "episode_len_mean": 2314.3536585365855, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2870936842940442, "mean_inference_ms": 1.023006068435184, "mean_action_processing_ms": 0.11141431611898016, "mean_env_wait_ms": 0.04133234105071831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002179494718225991, "StateBufferConnector_ms": 0.006130265026557736, "ViewRequirementAgentConnector_ms": 0.09365895899330698}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.8479419518777, "num_env_steps_trained_throughput_per_sec": 441.8479419518777, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 9198.593, "sample_time_ms": 5879.431, "load_time_ms": 0.469, "load_throughput": 8529342.145, "learn_time_ms": 3314.965, "learn_throughput": 1206.649, "synch_weights_time_ms": 3.138}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 82, "training_iteration": 48, "trial_id": "8124a_00000", "date": "2023-12-11_00-23-52", "timestamp": 1702283032, "time_this_iter_s": 9.059900283813477, "time_total_s": 445.3696298599243, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 445.3696298599243, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 31.400000000000002, "ram_util_percent": 78.98461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 9.993802070617676, "policy_loss": 0.0013575112679973245, "vf_loss": 9.989919662475586, "vf_explained_var": 0.0, "kl": 0.015766797587275505, "entropy": 0.9340632557868958, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -873291.1395348837, "episode_len_mean": 2263.813953488372, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2873275825282437, "mean_inference_ms": 1.0232098624374322, "mean_action_processing_ms": 0.11149555671596477, "mean_env_wait_ms": 0.041321523248943295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020781228708666426, "StateBufferConnector_ms": 0.00584513642067133, "ViewRequirementAgentConnector_ms": 0.09161178455796352}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -873291.1395348837, "episode_len_mean": 2263.813953488372, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2873275825282437, "mean_inference_ms": 1.0232098624374322, "mean_action_processing_ms": 0.11149555671596477, "mean_env_wait_ms": 0.041321523248943295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020781228708666426, "StateBufferConnector_ms": 0.00584513642067133, "ViewRequirementAgentConnector_ms": 0.09161178455796352}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.32345880522, "num_env_steps_trained_throughput_per_sec": 442.32345880522, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 9200.475, "sample_time_ms": 5884.016, "load_time_ms": 0.469, "load_throughput": 8529342.145, "learn_time_ms": 3312.261, "learn_throughput": 1207.634, "synch_weights_time_ms": 3.214}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 86, "training_iteration": 49, "trial_id": "8124a_00000", "date": "2023-12-11_00-24-01", "timestamp": 1702283041, "time_this_iter_s": 9.051166772842407, "time_total_s": 454.4207966327667, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 454.4207966327667, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 30.107692307692307, "ram_util_percent": 78.98461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 10.009364128112793, "policy_loss": 0.014421281404793262, "vf_loss": 9.992439270019531, "vf_explained_var": 0.0, "kl": 0.01563214138150215, "entropy": 0.9139631986618042, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -864104.3820224719, "episode_len_mean": 2242.696629213483, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2874839523668701, "mean_inference_ms": 1.0233384951370208, "mean_action_processing_ms": 0.11154637379280265, "mean_env_wait_ms": 0.04131387714849807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020080737853318117, "StateBufferConnector_ms": 0.005648109350311622, "ViewRequirementAgentConnector_ms": 0.09467896450771375}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -864104.3820224719, "episode_len_mean": 2242.696629213483, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2874839523668701, "mean_inference_ms": 1.0233384951370208, "mean_action_processing_ms": 0.11154637379280265, "mean_env_wait_ms": 0.04131387714849807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020080737853318117, "StateBufferConnector_ms": 0.005648109350311622, "ViewRequirementAgentConnector_ms": 0.09467896450771375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.01171485441256, "num_env_steps_trained_throughput_per_sec": 435.01171485441256, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 9211.67, "sample_time_ms": 5881.672, "load_time_ms": 0.367, "load_throughput": 10889346.401, "learn_time_ms": 3325.003, "learn_throughput": 1203.006, "synch_weights_time_ms": 4.113}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 89, "training_iteration": 50, "trial_id": "8124a_00000", "date": "2023-12-11_00-24-10", "timestamp": 1702283050, "time_this_iter_s": 9.204153299331665, "time_total_s": 463.6249499320984, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 463.6249499320984, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 29.823076923076925, "ram_util_percent": 78.9923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 10.000249862670898, "policy_loss": 0.004819006659090519, "vf_loss": 9.993144035339355, "vf_explained_var": -3.9319837696893956e-07, "kl": 0.014277417212724686, "entropy": 0.9057942628860474, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46965.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -856055.3186813187, "episode_len_mean": 2219.989010989011, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2875789588940884, "mean_inference_ms": 1.0234098484728407, "mean_action_processing_ms": 0.11157475797825307, "mean_env_wait_ms": 0.04130649968982497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0019639402955442995, "StateBufferConnector_ms": 0.005523975078876202, "ViewRequirementAgentConnector_ms": 0.09472212948641934}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -856055.3186813187, "episode_len_mean": 2219.989010989011, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2875789588940884, "mean_inference_ms": 1.0234098484728407, "mean_action_processing_ms": 0.11157475797825307, "mean_env_wait_ms": 0.04130649968982497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0019639402955442995, "StateBufferConnector_ms": 0.005523975078876202, "ViewRequirementAgentConnector_ms": 0.09472212948641934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.5040213524014, "num_env_steps_trained_throughput_per_sec": 433.5040213524014, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 9219.568, "sample_time_ms": 5872.966, "load_time_ms": 0.469, "load_throughput": 8530643.209, "learn_time_ms": 3341.52, "learn_throughput": 1197.06, "synch_weights_time_ms": 4.099}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 91, "training_iteration": 51, "trial_id": "8124a_00000", "date": "2023-12-11_00-24-19", "timestamp": 1702283059, "time_this_iter_s": 9.236098289489746, "time_total_s": 472.86104822158813, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 472.86104822158813, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 36.78333333333333, "ram_util_percent": 79.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 10.032465934753418, "policy_loss": 0.02998490259051323, "vf_loss": 10.0, "vf_explained_var": 1.134410965164534e-07, "kl": 0.015486214309930801, "entropy": 0.8854066133499146, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 47895.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -856055.3186813187, "episode_len_mean": 2219.989010989011, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2875789588940884, "mean_inference_ms": 1.0234098484728407, "mean_action_processing_ms": 0.11157475797825307, "mean_env_wait_ms": 0.04130649968982497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0019639402955442995, "StateBufferConnector_ms": 0.005523975078876202, "ViewRequirementAgentConnector_ms": 0.09472212948641934}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -856055.3186813187, "episode_len_mean": 2219.989010989011, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2875789588940884, "mean_inference_ms": 1.0234098484728407, "mean_action_processing_ms": 0.11157475797825307, "mean_env_wait_ms": 0.04130649968982497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0019639402955442995, "StateBufferConnector_ms": 0.005523975078876202, "ViewRequirementAgentConnector_ms": 0.09472212948641934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.8680159836329, "num_env_steps_trained_throughput_per_sec": 441.8680159836329, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 9196.18, "sample_time_ms": 5857.231, "load_time_ms": 0.469, "load_throughput": 8530643.209, "learn_time_ms": 3333.849, "learn_throughput": 1199.814, "synch_weights_time_ms": 4.101}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 91, "training_iteration": 52, "trial_id": "8124a_00000", "date": "2023-12-11_00-24-28", "timestamp": 1702283068, "time_this_iter_s": 9.05947208404541, "time_total_s": 481.92052030563354, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 481.92052030563354, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 32.4, "ram_util_percent": 78.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 10.009584426879883, "policy_loss": 0.01392048317939043, "vf_loss": 9.99498176574707, "vf_explained_var": -1.6336800001681695e-07, "kl": 0.004250154830515385, "entropy": 0.885620653629303, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 48825.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -870995.9247311827, "episode_len_mean": 2253.7419354838707, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2876629567723051, "mean_inference_ms": 1.0234656550635262, "mean_action_processing_ms": 0.11159450703197135, "mean_env_wait_ms": 0.04129716958553262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0019217050203713037, "StateBufferConnector_ms": 0.005405179915889617, "ViewRequirementAgentConnector_ms": 0.09414252414498278}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -870995.9247311827, "episode_len_mean": 2253.7419354838707, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2876629567723051, "mean_inference_ms": 1.0234656550635262, "mean_action_processing_ms": 0.11159450703197135, "mean_env_wait_ms": 0.04129716958553262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0019217050203713037, "StateBufferConnector_ms": 0.005405179915889617, "ViewRequirementAgentConnector_ms": 0.09414252414498278}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.9251642282556, "num_env_steps_trained_throughput_per_sec": 441.9251642282556, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 9198.846, "sample_time_ms": 5859.727, "load_time_ms": 0.503, "load_throughput": 7953925.947, "learn_time_ms": 3333.885, "learn_throughput": 1199.802, "synch_weights_time_ms": 3.999}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 93, "training_iteration": 53, "trial_id": "8124a_00000", "date": "2023-12-11_00-24-38", "timestamp": 1702283078, "time_this_iter_s": 9.059312105178833, "time_total_s": 490.9798324108124, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 490.9798324108124, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 31.93076923076923, "ram_util_percent": 78.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 4.999999873689376e-05, "total_loss": 10.01402473449707, "policy_loss": 0.017830057069659233, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.015414043329656124, "entropy": 0.8529968857765198, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49755.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -868133.7684210526, "episode_len_mean": 2253.9894736842107, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28774478820658994, "mean_inference_ms": 1.023512275570801, "mean_action_processing_ms": 0.11161154953367712, "mean_env_wait_ms": 0.041287707036064124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001881248072574013, "StateBufferConnector_ms": 0.005291386654502467, "ViewRequirementAgentConnector_ms": 0.09374568336888363}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -868133.7684210526, "episode_len_mean": 2253.9894736842107, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28774478820658994, "mean_inference_ms": 1.023512275570801, "mean_action_processing_ms": 0.11161154953367712, "mean_env_wait_ms": 0.041287707036064124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001881248072574013, "StateBufferConnector_ms": 0.005291386654502467, "ViewRequirementAgentConnector_ms": 0.09374568336888363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.0439393048812, "num_env_steps_trained_throughput_per_sec": 440.0439393048812, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 9179.948, "sample_time_ms": 5852.472, "load_time_ms": 0.403, "load_throughput": 9929696.97, "learn_time_ms": 3322.243, "learn_throughput": 1204.006, "synch_weights_time_ms": 3.939}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 95, "training_iteration": 54, "trial_id": "8124a_00000", "date": "2023-12-11_00-24-47", "timestamp": 1702283087, "time_this_iter_s": 9.09800386428833, "time_total_s": 500.0778362751007, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 500.0778362751007, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 29.73076923076923, "ram_util_percent": 79.1153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 4.999999873689376e-05, "total_loss": 10.012422561645508, "policy_loss": 0.014403629116714, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.006732363719493151, "entropy": 0.8683272004127502, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 50685.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -871835.75, "episode_len_mean": 2269.0833333333335, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28778737408174776, "mean_inference_ms": 1.0235577588348541, "mean_action_processing_ms": 0.11162056911771989, "mean_env_wait_ms": 0.04128443763429978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0018616517384847004, "StateBufferConnector_ms": 0.005236268043518066, "ViewRequirementAgentConnector_ms": 0.09326984484990437}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -871835.75, "episode_len_mean": 2269.0833333333335, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28778737408174776, "mean_inference_ms": 1.0235577588348541, "mean_action_processing_ms": 0.11162056911771989, "mean_env_wait_ms": 0.04128443763429978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0018616517384847004, "StateBufferConnector_ms": 0.005236268043518066, "ViewRequirementAgentConnector_ms": 0.09326984484990437}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.544977272594, "num_env_steps_trained_throughput_per_sec": 406.544977272594, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 9188.37, "sample_time_ms": 5909.936, "load_time_ms": 0.503, "load_throughput": 7953548.876, "learn_time_ms": 3273.321, "learn_throughput": 1222.001, "synch_weights_time_ms": 3.939}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 96, "training_iteration": 55, "trial_id": "8124a_00000", "date": "2023-12-11_00-24-57", "timestamp": 1702283097, "time_this_iter_s": 9.847018480300903, "time_total_s": 509.9248547554016, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 509.9248547554016, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 32.66428571428572, "ram_util_percent": 81.12142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 4.999999873689376e-05, "total_loss": 10.007396697998047, "policy_loss": 0.01387797575443983, "vf_loss": 9.992439270019531, "vf_explained_var": 0.0, "kl": 0.013482754118740559, "entropy": 0.8275338411331177, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51615.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -859485.4343434343, "episode_len_mean": 2236.313131313131, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28790734103577376, "mean_inference_ms": 1.0236895727189539, "mean_action_processing_ms": 0.11164617427938234, "mean_env_wait_ms": 0.04127838336769848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0018052380494397095, "StateBufferConnector_ms": 0.005077593254320549, "ViewRequirementAgentConnector_ms": 0.09312726030446063}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -859485.4343434343, "episode_len_mean": 2236.313131313131, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28790734103577376, "mean_inference_ms": 1.0236895727189539, "mean_action_processing_ms": 0.11164617427938234, "mean_env_wait_ms": 0.04127838336769848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0018052380494397095, "StateBufferConnector_ms": 0.005077593254320549, "ViewRequirementAgentConnector_ms": 0.09312726030446063}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.4763498504068, "num_env_steps_trained_throughput_per_sec": 428.4763498504068, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 9189.964, "sample_time_ms": 5891.997, "load_time_ms": 0.579, "load_throughput": 6914162.786, "learn_time_ms": 3292.936, "learn_throughput": 1214.721, "synch_weights_time_ms": 3.849}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 99, "training_iteration": 56, "trial_id": "8124a_00000", "date": "2023-12-11_00-25-06", "timestamp": 1702283106, "time_this_iter_s": 9.344290256500244, "time_total_s": 519.2691450119019, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 519.2691450119019, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 31.71538461538461, "ram_util_percent": 82.32307692307691}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 4.999999873689376e-05, "total_loss": 10.006518363952637, "policy_loss": 0.005517289042472839, "vf_loss": 10.0, "vf_explained_var": 0.0, "kl": 0.012502973899245262, "entropy": 0.8111506104469299, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 52545.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -876783.66, "episode_len_mean": 2279.73, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2879470241227907, "mean_inference_ms": 1.0237302784017845, "mean_action_processing_ms": 0.1116548478337369, "mean_env_wait_ms": 0.04127689994733833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0017871856689453125, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09417891502380371}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -876783.66, "episode_len_mean": 2279.73, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1484080.0, -1212885.0, -1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0], "episode_lengths": [3421, 2906, 2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2879470241227907, "mean_inference_ms": 1.0237302784017845, "mean_action_processing_ms": 0.1116548478337369, "mean_env_wait_ms": 0.04127689994733833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0017871856689453125, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09417891502380371}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.35514931548425, "num_env_steps_trained_throughput_per_sec": 437.35514931548425, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 9203.242, "sample_time_ms": 5908.875, "load_time_ms": 0.477, "load_throughput": 8379390.67, "learn_time_ms": 3289.332, "learn_throughput": 1216.052, "synch_weights_time_ms": 3.853}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 100, "training_iteration": 57, "trial_id": "8124a_00000", "date": "2023-12-11_00-25-15", "timestamp": 1702283115, "time_this_iter_s": 9.153844118118286, "time_total_s": 528.4229891300201, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 528.4229891300201, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 31.258333333333336, "ram_util_percent": 82.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 4.999999873689376e-05, "total_loss": 10.0164213180542, "policy_loss": 0.020481973886489868, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.0122257424518466, "entropy": 0.7783210873603821, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53475.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -862006.97, "episode_len_mean": 2250.62, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0], "episode_lengths": [2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2881468534067187, "mean_inference_ms": 1.0238432306925944, "mean_action_processing_ms": 0.11173048685682717, "mean_env_wait_ms": 0.04124390181877364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09296631813049316}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -862006.97, "episode_len_mean": 2250.62, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011976.0, -734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0], "episode_lengths": [2715, 1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2881468534067187, "mean_inference_ms": 1.0238432306925944, "mean_action_processing_ms": 0.11173048685682717, "mean_env_wait_ms": 0.04124390181877364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09296631813049316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.24863902563243, "num_env_steps_trained_throughput_per_sec": 428.24863902563243, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 9231.99, "sample_time_ms": 5935.464, "load_time_ms": 0.376, "load_throughput": 10636667.723, "learn_time_ms": 3291.661, "learn_throughput": 1215.192, "synch_weights_time_ms": 3.887}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 102, "training_iteration": 58, "trial_id": "8124a_00000", "date": "2023-12-11_00-25-25", "timestamp": 1702283125, "time_this_iter_s": 9.34803819656372, "time_total_s": 537.7710273265839, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 537.7710273265839, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 34.43571428571429, "ram_util_percent": 82.55714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 4.999999873689376e-05, "total_loss": 10.004351615905762, "policy_loss": 0.005955665372312069, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.011430051177740097, "entropy": 0.7673613429069519, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54405.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -854449.91, "episode_len_mean": 2231.13, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0], "episode_lengths": [1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2882834427670826, "mean_inference_ms": 1.0239450101656384, "mean_action_processing_ms": 0.1117563486635768, "mean_env_wait_ms": 0.04123109236801618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09340524673461914}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -854449.91, "episode_len_mean": 2231.13, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0], "episode_lengths": [1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2882834427670826, "mean_inference_ms": 1.0239450101656384, "mean_action_processing_ms": 0.1117563486635768, "mean_env_wait_ms": 0.04123109236801618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09340524673461914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.1526110496101, "num_env_steps_trained_throughput_per_sec": 436.1526110496101, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 9244.784, "sample_time_ms": 5941.231, "load_time_ms": 0.436, "load_throughput": 9183936.939, "learn_time_ms": 3298.644, "learn_throughput": 1212.62, "synch_weights_time_ms": 3.711}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 103, "training_iteration": 59, "trial_id": "8124a_00000", "date": "2023-12-11_00-25-34", "timestamp": 1702283134, "time_this_iter_s": 9.180095911026001, "time_total_s": 546.9511232376099, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 546.9511232376099, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 31.699999999999996, "ram_util_percent": 83.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 4.999999873689376e-05, "total_loss": 10.016165733337402, "policy_loss": 0.015190031379461288, "vf_loss": 10.0, "vf_explained_var": 0.0, "kl": 0.01219507958739996, "entropy": 0.7329707741737366, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 55335.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -854449.91, "episode_len_mean": 2231.13, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0], "episode_lengths": [1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2882834427670826, "mean_inference_ms": 1.0239450101656384, "mean_action_processing_ms": 0.1117563486635768, "mean_env_wait_ms": 0.04123109236801618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09340524673461914}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -854449.91, "episode_len_mean": 2231.13, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-734275.0, -991590.0, -620530.0, -439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0], "episode_lengths": [1772, 2723, 1651, 1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2882834427670826, "mean_inference_ms": 1.0239450101656384, "mean_action_processing_ms": 0.1117563486635768, "mean_env_wait_ms": 0.04123109236801618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09340524673461914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.33971956009356, "num_env_steps_trained_throughput_per_sec": 446.33971956009356, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 9221.447, "sample_time_ms": 5935.651, "load_time_ms": 0.537, "load_throughput": 7450249.123, "learn_time_ms": 3281.684, "learn_throughput": 1218.886, "synch_weights_time_ms": 2.913}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 103, "training_iteration": 60, "trial_id": "8124a_00000", "date": "2023-12-11_00-25-43", "timestamp": 1702283143, "time_this_iter_s": 8.969780683517456, "time_total_s": 555.9209039211273, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 555.9209039211273, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 32.208333333333336, "ram_util_percent": 83.44166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 4.999999873689376e-05, "total_loss": 10.000554084777832, "policy_loss": 0.007318360265344381, "vf_loss": 9.992439270019531, "vf_explained_var": 0.0, "kl": 0.009936047717928886, "entropy": 0.7303330302238464, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56265.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -875221.28, "episode_len_mean": 2267.14, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0], "episode_lengths": [1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28868425698293454, "mean_inference_ms": 1.024212736511864, "mean_action_processing_ms": 0.11181912420688174, "mean_env_wait_ms": 0.041179851901821454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09234261512756348}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -875221.28, "episode_len_mean": 2267.14, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-439500.0, -1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0], "episode_lengths": [1203, 4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28868425698293454, "mean_inference_ms": 1.024212736511864, "mean_action_processing_ms": 0.11181912420688174, "mean_env_wait_ms": 0.041179851901821454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09234261512756348}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 425.4475579936489, "num_env_steps_trained_throughput_per_sec": 425.4475579936489, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 9238.92, "sample_time_ms": 5942.203, "load_time_ms": 0.534, "load_throughput": 7490497.366, "learn_time_ms": 3292.513, "learn_throughput": 1214.878, "synch_weights_time_ms": 2.906}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 106, "training_iteration": 61, "trial_id": "8124a_00000", "date": "2023-12-11_00-25-52", "timestamp": 1702283152, "time_this_iter_s": 9.409878969192505, "time_total_s": 565.3307828903198, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 565.3307828903198, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 32.13076923076923, "ram_util_percent": 83.70769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 4.999999873689376e-05, "total_loss": 10.01932430267334, "policy_loss": 0.0209933053702116, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.010621964931488037, "entropy": 0.6971818804740906, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 57195.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -892616.87, "episode_len_mean": 2306.19, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0], "episode_lengths": [4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2888254402898842, "mean_inference_ms": 1.0243347098583504, "mean_action_processing_ms": 0.11185271193054402, "mean_env_wait_ms": 0.041171139098277784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09061574935913086}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -892616.87, "episode_len_mean": 2306.19, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1656490.0, -231745.0, -1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0], "episode_lengths": [4772, 736, 3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2888254402898842, "mean_inference_ms": 1.0243347098583504, "mean_action_processing_ms": 0.11185271193054402, "mean_env_wait_ms": 0.041171139098277784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09061574935913086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 439.6407397619493, "num_env_steps_trained_throughput_per_sec": 439.6407397619493, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 9243.506, "sample_time_ms": 5949.436, "load_time_ms": 0.634, "load_throughput": 6305801.699, "learn_time_ms": 3289.616, "learn_throughput": 1215.948, "synch_weights_time_ms": 2.873}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 107, "training_iteration": 62, "trial_id": "8124a_00000", "date": "2023-12-11_00-26-01", "timestamp": 1702283161, "time_this_iter_s": 9.10559344291687, "time_total_s": 574.4363763332367, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 574.4363763332367, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 33.80769230769231, "ram_util_percent": 83.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 4.999999873689376e-05, "total_loss": 10.007050514221191, "policy_loss": 0.011422495357692242, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.008344711735844612, "entropy": 0.6860472559928894, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 58125.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -879607.87, "episode_len_mean": 2265.5, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0], "episode_lengths": [3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2891109564675732, "mean_inference_ms": 1.0246241437105086, "mean_action_processing_ms": 0.11192380341602381, "mean_env_wait_ms": 0.04115259060995671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09254312515258789}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -879607.87, "episode_len_mean": 2265.5, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0], "episode_lengths": [3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2891109564675732, "mean_inference_ms": 1.0246241437105086, "mean_action_processing_ms": 0.11192380341602381, "mean_env_wait_ms": 0.04115259060995671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09254312515258789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.67838045728513, "num_env_steps_trained_throughput_per_sec": 441.67838045728513, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 9244.012, "sample_time_ms": 5946.779, "load_time_ms": 0.536, "load_throughput": 7469155.017, "learn_time_ms": 3292.776, "learn_throughput": 1214.78, "synch_weights_time_ms": 3.0}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 109, "training_iteration": 63, "trial_id": "8124a_00000", "date": "2023-12-11_00-26-11", "timestamp": 1702283171, "time_this_iter_s": 9.064376831054688, "time_total_s": 583.5007531642914, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 583.5007531642914, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 31.192307692307693, "ram_util_percent": 82.76923076923079}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 4.999999873689376e-05, "total_loss": 10.022536277770996, "policy_loss": 0.021799800917506218, "vf_loss": 10.0, "vf_explained_var": 0.0, "kl": 0.009201930835843086, "entropy": 0.650766134262085, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59055.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -879607.87, "episode_len_mean": 2265.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0], "episode_lengths": [3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2891109564675732, "mean_inference_ms": 1.0246241437105086, "mean_action_processing_ms": 0.11192380341602381, "mean_env_wait_ms": 0.04115259060995671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09254312515258789}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -879607.87, "episode_len_mean": 2265.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1063384.0, -663822.0, -973064.0, -314563.0, -283797.0, -1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0], "episode_lengths": [3153, 1767, 1633, 958, 748, 4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2891109564675732, "mean_inference_ms": 1.0246241437105086, "mean_action_processing_ms": 0.11192380341602381, "mean_env_wait_ms": 0.04115259060995671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09254312515258789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.9297623364105, "num_env_steps_trained_throughput_per_sec": 441.9297623364105, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 9240.133, "sample_time_ms": 5940.582, "load_time_ms": 0.536, "load_throughput": 7469155.017, "learn_time_ms": 3295.089, "learn_throughput": 1213.928, "synch_weights_time_ms": 2.987}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "episodes_total": 109, "training_iteration": 64, "trial_id": "8124a_00000", "date": "2023-12-11_00-26-20", "timestamp": 1702283180, "time_this_iter_s": 9.058211088180542, "time_total_s": 592.5589642524719, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 592.5589642524719, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 30.853846153846156, "ram_util_percent": 82.77692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 4.999999873689376e-05, "total_loss": 9.99527359008789, "policy_loss": 0.00734002236276865, "vf_loss": 9.987399101257324, "vf_explained_var": 0.0, "kl": 0.006669266149401665, "entropy": 0.6536226272583008, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59985.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -890246.52, "episode_len_mean": 2296.31, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0], "episode_lengths": [4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28984069348887326, "mean_inference_ms": 1.0253415943077417, "mean_action_processing_ms": 0.11213717569172911, "mean_env_wait_ms": 0.04110115862238434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09891200065612793}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -890246.52, "episode_len_mean": 2296.31, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1493311.0, -180128.0, -490071.0, -1048500.0, -457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0], "episode_lengths": [4296, 544, 1389, 3071, 1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28984069348887326, "mean_inference_ms": 1.0253415943077417, "mean_action_processing_ms": 0.11213717569172911, "mean_env_wait_ms": 0.04110115862238434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09891200065612793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.61464751325207, "num_env_steps_trained_throughput_per_sec": 428.61464751325207, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 9189.471, "sample_time_ms": 5881.84, "load_time_ms": 0.435, "load_throughput": 9185948.314, "learn_time_ms": 3303.171, "learn_throughput": 1210.958, "synch_weights_time_ms": 2.987}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 114, "training_iteration": 65, "trial_id": "8124a_00000", "date": "2023-12-11_00-26-29", "timestamp": 1702283189, "time_this_iter_s": 9.34239411354065, "time_total_s": 601.9013583660126, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 601.9013583660126, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 35.33846153846154, "ram_util_percent": 82.9923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 4.999999873689376e-05, "total_loss": 10.003841400146484, "policy_loss": 0.013598278164863586, "vf_loss": 9.989919662475586, "vf_explained_var": 0.0, "kl": 0.0040270015597343445, "entropy": 0.6874582767486572, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60915.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -871678.22, "episode_len_mean": 2243.48, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0], "episode_lengths": [1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2902841427278963, "mean_inference_ms": 1.0259113076459065, "mean_action_processing_ms": 0.11228902789470942, "mean_env_wait_ms": 0.04108779994276021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09974503517150879}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -871678.22, "episode_len_mean": 2243.48, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0], "episode_lengths": [1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2902841427278963, "mean_inference_ms": 1.0259113076459065, "mean_action_processing_ms": 0.11228902789470942, "mean_env_wait_ms": 0.04108779994276021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09974503517150879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.40654196875823, "num_env_steps_trained_throughput_per_sec": 432.40654196875823, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 9180.986, "sample_time_ms": 5869.908, "load_time_ms": 0.461, "load_throughput": 8667708.204, "learn_time_ms": 3306.426, "learn_throughput": 1209.765, "synch_weights_time_ms": 3.077}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 118, "training_iteration": 66, "trial_id": "8124a_00000", "date": "2023-12-11_00-26-38", "timestamp": 1702283198, "time_this_iter_s": 9.2575523853302, "time_total_s": 611.1589107513428, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 611.1589107513428, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 30.8923076923077, "ram_util_percent": 83.31538461538459}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.04004516452550888, "cur_lr": 4.999999873689376e-05, "total_loss": 10.018388748168945, "policy_loss": 0.017975423485040665, "vf_loss": 10.0, "vf_explained_var": 0.0, "kl": 0.010315975174307823, "entropy": 0.6577980518341064, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 61845.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -871678.22, "episode_len_mean": 2243.48, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0], "episode_lengths": [1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2902841427278963, "mean_inference_ms": 1.0259113076459065, "mean_action_processing_ms": 0.11228902789470942, "mean_env_wait_ms": 0.04108779994276021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09974503517150879}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -871678.22, "episode_len_mean": 2243.48, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-457515.0, -1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0], "episode_lengths": [1067, 4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2902841427278963, "mean_inference_ms": 1.0259113076459065, "mean_action_processing_ms": 0.11228902789470942, "mean_env_wait_ms": 0.04108779994276021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.09974503517150879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.1897923192258, "num_env_steps_trained_throughput_per_sec": 441.1897923192258, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 9173.037, "sample_time_ms": 5858.405, "load_time_ms": 0.461, "load_throughput": 8667708.204, "learn_time_ms": 3309.885, "learn_throughput": 1208.501, "synch_weights_time_ms": 3.173}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "episodes_total": 118, "training_iteration": 67, "trial_id": "8124a_00000", "date": "2023-12-11_00-26-48", "timestamp": 1702283208, "time_this_iter_s": 9.074381351470947, "time_total_s": 620.2332921028137, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 620.2332921028137, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 30.258333333333336, "ram_util_percent": 83.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.04004516452550888, "cur_lr": 4.999999873689376e-05, "total_loss": 10.008635520935059, "policy_loss": 0.010898599401116371, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.006420317571610212, "entropy": 0.7442613840103149, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 62775.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -893179.85, "episode_len_mean": 2306.55, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0], "episode_lengths": [4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2903658598429028, "mean_inference_ms": 1.026044621655818, "mean_action_processing_ms": 0.11232146024929027, "mean_env_wait_ms": 0.041083999859455746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.10073423385620117}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -893179.85, "episode_len_mean": 2306.55, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1633222.0, -3401312.0, -747484.0, -1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0], "episode_lengths": [4496, 8954, 1402, 3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2903658598429028, "mean_inference_ms": 1.026044621655818, "mean_action_processing_ms": 0.11232146024929027, "mean_env_wait_ms": 0.041083999859455746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.005026817321777344, "ViewRequirementAgentConnector_ms": 0.10073423385620117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.889145591557, "num_env_steps_trained_throughput_per_sec": 436.889145591557, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 9154.564, "sample_time_ms": 5840.603, "load_time_ms": 0.461, "load_throughput": 8667708.204, "learn_time_ms": 3309.148, "learn_throughput": 1208.77, "synch_weights_time_ms": 3.139}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "episodes_total": 119, "training_iteration": 68, "trial_id": "8124a_00000", "date": "2023-12-11_00-26-57", "timestamp": 1702283217, "time_this_iter_s": 9.163653373718262, "time_total_s": 629.396945476532, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 629.396945476532, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 31.884615384615383, "ram_util_percent": 83.93846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.04004516452550888, "cur_lr": 4.999999873689376e-05, "total_loss": 10.00443172454834, "policy_loss": 0.011611569672822952, "vf_loss": 9.992439270019531, "vf_explained_var": 0.0, "kl": 0.00950599554926157, "entropy": 0.7504883408546448, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 63705.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -842898.66, "episode_len_mean": 2181.27, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0], "episode_lengths": [3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.290582632107474, "mean_inference_ms": 1.0263208230418288, "mean_action_processing_ms": 0.11238110939497992, "mean_env_wait_ms": 0.04108279737072454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.004693746566772461, "ViewRequirementAgentConnector_ms": 0.10297107696533203}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -842898.66, "episode_len_mean": 2181.27, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1111875.0, -212186.0, -1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0], "episode_lengths": [3020, 532, 4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.290582632107474, "mean_inference_ms": 1.0263208230418288, "mean_action_processing_ms": 0.11238110939497992, "mean_env_wait_ms": 0.04108279737072454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022308826446533203, "StateBufferConnector_ms": 0.004693746566772461, "ViewRequirementAgentConnector_ms": 0.10297107696533203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.4464915858536, "num_env_steps_trained_throughput_per_sec": 437.4464915858536, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 9151.852, "sample_time_ms": 5840.744, "load_time_ms": 0.451, "load_throughput": 8860425.667, "learn_time_ms": 3306.295, "learn_throughput": 1209.813, "synch_weights_time_ms": 3.127}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 122, "training_iteration": 69, "trial_id": "8124a_00000", "date": "2023-12-11_00-27-06", "timestamp": 1702283226, "time_this_iter_s": 9.151555299758911, "time_total_s": 638.5485007762909, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 638.5485007762909, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 31.807692307692314, "ram_util_percent": 83.43846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.04004516452550888, "cur_lr": 4.999999873689376e-05, "total_loss": 10.01319408416748, "policy_loss": 0.017785411328077316, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.011204314418137074, "entropy": 0.69559645652771, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 64635.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -852180.14, "episode_len_mean": 2203.05, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0], "episode_lengths": [4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2907249441243899, "mean_inference_ms": 1.02648997794949, "mean_action_processing_ms": 0.11241098790289701, "mean_env_wait_ms": 0.04108102758134184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025353431701660156, "StateBufferConnector_ms": 0.004693746566772461, "ViewRequirementAgentConnector_ms": 0.10077166557312012}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -852180.14, "episode_len_mean": 2203.05, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1731917.0, -1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0], "episode_lengths": [4961, 3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2907249441243899, "mean_inference_ms": 1.02648997794949, "mean_action_processing_ms": 0.11241098790289701, "mean_env_wait_ms": 0.04108102758134184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025353431701660156, "StateBufferConnector_ms": 0.004693746566772461, "ViewRequirementAgentConnector_ms": 0.10077166557312012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.4958435005409, "num_env_steps_trained_throughput_per_sec": 441.4958435005409, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 9161.684, "sample_time_ms": 5847.539, "load_time_ms": 0.45, "load_throughput": 8884825.504, "learn_time_ms": 3309.316, "learn_throughput": 1208.709, "synch_weights_time_ms": 3.047}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 124, "training_iteration": 70, "trial_id": "8124a_00000", "date": "2023-12-11_00-27-15", "timestamp": 1702283235, "time_this_iter_s": 9.068130731582642, "time_total_s": 647.6166315078735, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 647.6166315078735, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 29.307692307692303, "ram_util_percent": 83.26153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.04004516452550888, "cur_lr": 4.999999873689376e-05, "total_loss": 10.021388053894043, "policy_loss": 0.02383340522646904, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.001892825006507337, "entropy": 0.7464986443519592, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 65565.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -838330.65, "episode_len_mean": 2162.05, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0], "episode_lengths": [3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29079591527598775, "mean_inference_ms": 1.02655655031511, "mean_action_processing_ms": 0.11242283485997548, "mean_env_wait_ms": 0.041081976702324885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025353431701660156, "StateBufferConnector_ms": 0.004693746566772461, "ViewRequirementAgentConnector_ms": 0.10328006744384766}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -838330.65, "episode_len_mean": 2162.05, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1070533.0, -224200.0, -1020972.0, -99190.0, -130523.0, -944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0], "episode_lengths": [3030, 576, 3009, 225, 446, 2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29079591527598775, "mean_inference_ms": 1.02655655031511, "mean_action_processing_ms": 0.11242283485997548, "mean_env_wait_ms": 0.041081976702324885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025353431701660156, "StateBufferConnector_ms": 0.004693746566772461, "ViewRequirementAgentConnector_ms": 0.10328006744384766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.19839964036294, "num_env_steps_trained_throughput_per_sec": 442.19839964036294, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 9125.968, "sample_time_ms": 5845.318, "load_time_ms": 0.453, "load_throughput": 8823612.075, "learn_time_ms": 3275.918, "learn_throughput": 1221.032, "synch_weights_time_ms": 3.048}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "episodes_total": 125, "training_iteration": 71, "trial_id": "8124a_00000", "date": "2023-12-11_00-27-24", "timestamp": 1702283244, "time_this_iter_s": 9.052708148956299, "time_total_s": 656.6693396568298, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 656.6693396568298, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 32.43076923076923, "ram_util_percent": 83.07692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02002258226275444, "cur_lr": 4.999999873689376e-05, "total_loss": 9.993062019348145, "policy_loss": 0.00544569781050086, "vf_loss": 9.987399101257324, "vf_explained_var": 0.0, "kl": 0.01086600311100483, "entropy": 0.7751268148422241, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 66495.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -837518.23, "episode_len_mean": 2161.9, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0], "episode_lengths": [2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2911475389461977, "mean_inference_ms": 1.026973584257931, "mean_action_processing_ms": 0.11248961304639397, "mean_env_wait_ms": 0.04110284133526326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025353431701660156, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10309219360351562}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -837518.23, "episode_len_mean": 2161.9, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-944741.0, -62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0], "episode_lengths": [2928, 143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2911475389461977, "mean_inference_ms": 1.026973584257931, "mean_action_processing_ms": 0.11248961304639397, "mean_env_wait_ms": 0.04110284133526326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025353431701660156, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10309219360351562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 431.30707653019687, "num_env_steps_trained_throughput_per_sec": 431.30707653019687, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 9143.547, "sample_time_ms": 5845.792, "load_time_ms": 0.353, "load_throughput": 11331362.961, "learn_time_ms": 3292.895, "learn_throughput": 1214.736, "synch_weights_time_ms": 3.475}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 130, "training_iteration": 72, "trial_id": "8124a_00000", "date": "2023-12-11_00-27-34", "timestamp": 1702283254, "time_this_iter_s": 9.283160209655762, "time_total_s": 665.9524998664856, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 665.9524998664856, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 32.284615384615385, "ram_util_percent": 83.1923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02002258226275444, "cur_lr": 4.999999873689376e-05, "total_loss": 10.026117324829102, "policy_loss": 0.02837311290204525, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.013173154555261135, "entropy": 0.7327120900154114, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 67425.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -836586.37, "episode_len_mean": 2152.85, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0], "episode_lengths": [143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2912175661764865, "mean_inference_ms": 1.0270535359440416, "mean_action_processing_ms": 0.11250442540649708, "mean_env_wait_ms": 0.04111027737026519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015459060668945312, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10409069061279297}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -836586.37, "episode_len_mean": 2152.85, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62646.0, -515138.0, -385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0], "episode_lengths": [143, 1414, 882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2912175661764865, "mean_inference_ms": 1.0270535359440416, "mean_action_processing_ms": 0.11250442540649708, "mean_env_wait_ms": 0.04111027737026519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015459060668945312, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10409069061279297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.60998551631604, "num_env_steps_trained_throughput_per_sec": 441.60998551631604, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 9143.688, "sample_time_ms": 5847.989, "load_time_ms": 0.353, "load_throughput": 11331362.961, "learn_time_ms": 3290.933, "learn_throughput": 1215.461, "synch_weights_time_ms": 3.452}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "episodes_total": 131, "training_iteration": 73, "trial_id": "8124a_00000", "date": "2023-12-11_00-27-43", "timestamp": 1702283263, "time_this_iter_s": 9.065776824951172, "time_total_s": 675.0182766914368, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 675.0182766914368, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 29.15833333333333, "ram_util_percent": 83.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02002258226275444, "cur_lr": 4.999999873689376e-05, "total_loss": 10.011014938354492, "policy_loss": 0.01590477116405964, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.007564548868685961, "entropy": 0.6840370297431946, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 68355.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -843660.67, "episode_len_mean": 2172.08, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0], "episode_lengths": [882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2913544140060465, "mean_inference_ms": 1.027207631791411, "mean_action_processing_ms": 0.1125321023174902, "mean_env_wait_ms": 0.04112380094237653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015459060668945312, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.1029825210571289}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -843660.67, "episode_len_mean": 2172.08, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-385098.0, -1149236.0, -587688.0, -5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0], "episode_lengths": [882, 2889, 1719, 23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2913544140060465, "mean_inference_ms": 1.027207631791411, "mean_action_processing_ms": 0.1125321023174902, "mean_env_wait_ms": 0.04112380094237653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015459060668945312, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.1029825210571289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 445.5899262968108, "num_env_steps_trained_throughput_per_sec": 445.5899262968108, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 9136.253, "sample_time_ms": 5843.711, "load_time_ms": 0.466, "load_throughput": 8591804.169, "learn_time_ms": 3287.872, "learn_throughput": 1216.593, "synch_weights_time_ms": 3.421}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "episodes_total": 133, "training_iteration": 74, "trial_id": "8124a_00000", "date": "2023-12-11_00-27-52", "timestamp": 1702283272, "time_this_iter_s": 8.985235929489136, "time_total_s": 684.0035126209259, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 684.0035126209259, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 30.838461538461537, "ram_util_percent": 83.19230769230771}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02002258226275444, "cur_lr": 4.999999873689376e-05, "total_loss": 10.001558303833008, "policy_loss": 0.008953483775258064, "vf_loss": 9.992439270019531, "vf_explained_var": 0.0, "kl": 0.00828518345952034, "entropy": 0.6880975961685181, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 69285.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -851749.22, "episode_len_mean": 2187.38, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0], "episode_lengths": [23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2915689501119757, "mean_inference_ms": 1.027461036468539, "mean_action_processing_ms": 0.11257640807078925, "mean_env_wait_ms": 0.041145750161603364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015459060668945312, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.1054832935333252}}, "episode_reward_max": -5123.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -851749.22, "episode_len_mean": 2187.38, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5123.0, -762607.0, -108791.0, -1337975.0, -677010.0, -576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0], "episode_lengths": [23, 2203, 352, 2537, 1183, 1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2915689501119757, "mean_inference_ms": 1.027461036468539, "mean_action_processing_ms": 0.11257640807078925, "mean_env_wait_ms": 0.041145750161603364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015459060668945312, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.1054832935333252}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.2913915891902, "num_env_steps_trained_throughput_per_sec": 442.2913915891902, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 9107.395, "sample_time_ms": 5829.51, "load_time_ms": 0.466, "load_throughput": 8591804.169, "learn_time_ms": 3273.121, "learn_throughput": 1222.075, "synch_weights_time_ms": 3.425}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 136, "training_iteration": 75, "trial_id": "8124a_00000", "date": "2023-12-11_00-28-01", "timestamp": 1702283281, "time_this_iter_s": 9.050823450088501, "time_total_s": 693.0543360710144, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 693.0543360710144, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 31.71538461538462, "ram_util_percent": 83.29230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02002258226275444, "cur_lr": 4.999999873689376e-05, "total_loss": 10.001030921936035, "policy_loss": 0.013494815677404404, "vf_loss": 9.987399101257324, "vf_explained_var": 0.0, "kl": 0.0069044348783791065, "entropy": 0.6610296368598938, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 70215.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -835367.67, "episode_len_mean": 2162.2, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0], "episode_lengths": [1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29192993247998056, "mean_inference_ms": 1.0279094740169483, "mean_action_processing_ms": 0.11266327989779089, "mean_env_wait_ms": 0.04118644639840282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015459060668945312, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10657715797424316}}, "episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -835367.67, "episode_len_mean": 2162.2, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-576508.0, -535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0], "episode_lengths": [1295, 1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29192993247998056, "mean_inference_ms": 1.0279094740169483, "mean_action_processing_ms": 0.11266327989779089, "mean_env_wait_ms": 0.04118644639840282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015459060668945312, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10657715797424316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.9051713671243, "num_env_steps_trained_throughput_per_sec": 440.9051713671243, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 9089.564, "sample_time_ms": 5829.675, "load_time_ms": 0.464, "load_throughput": 8624044.412, "learn_time_ms": 3255.324, "learn_throughput": 1228.756, "synch_weights_time_ms": 3.326}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "episodes_total": 141, "training_iteration": 76, "trial_id": "8124a_00000", "date": "2023-12-11_00-28-10", "timestamp": 1702283290, "time_this_iter_s": 9.079241752624512, "time_total_s": 702.1335778236389, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 702.1335778236389, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 27.366666666666664, "ram_util_percent": 83.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02002258226275444, "cur_lr": 4.999999873689376e-05, "total_loss": 10.006219863891602, "policy_loss": 0.008570650592446327, "vf_loss": 9.997479438781738, "vf_explained_var": -3.845460838647341e-09, "kl": 0.008441979065537453, "entropy": 0.6582077145576477, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 71145.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -851940.34, "episode_len_mean": 2185.61, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0], "episode_lengths": [1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920032859634485, "mean_inference_ms": 1.0280081515530595, "mean_action_processing_ms": 0.11268379926419801, "mean_env_wait_ms": 0.041195369558238985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015459060668945312, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.1059572696685791}}, "episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -851940.34, "episode_len_mean": 2185.61, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-535111.0, -152280.0, -1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0], "episode_lengths": [1486, 424, 3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920032859634485, "mean_inference_ms": 1.0280081515530595, "mean_action_processing_ms": 0.11268379926419801, "mean_env_wait_ms": 0.041195369558238985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015459060668945312, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.1059572696685791}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.583001116771, "num_env_steps_trained_throughput_per_sec": 442.583001116771, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 9086.71, "sample_time_ms": 5825.793, "load_time_ms": 0.565, "load_throughput": 7076903.868, "learn_time_ms": 3256.352, "learn_throughput": 1228.369, "synch_weights_time_ms": 3.223}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 142, "training_iteration": 77, "trial_id": "8124a_00000", "date": "2023-12-11_00-28-19", "timestamp": 1702283299, "time_this_iter_s": 9.071077346801758, "time_total_s": 711.2046551704407, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 711.2046551704407, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 33.41538461538461, "ram_util_percent": 83.25384615384617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02002258226275444, "cur_lr": 4.999999873689376e-05, "total_loss": 10.014589309692383, "policy_loss": 0.019458994269371033, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.008553968742489815, "entropy": 0.6123027205467224, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 72075.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -858386.84, "episode_len_mean": 2206.58, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0], "episode_lengths": [3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2921515965022898, "mean_inference_ms": 1.028206380032427, "mean_action_processing_ms": 0.11272556838298184, "mean_env_wait_ms": 0.04121346886741231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015459060668945312, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10621237754821777}}, "episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -858386.84, "episode_len_mean": 2206.58, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1428622.0, -3079604.0, -367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0], "episode_lengths": [3944, 7910, 617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2921515965022898, "mean_inference_ms": 1.028206380032427, "mean_action_processing_ms": 0.11272556838298184, "mean_env_wait_ms": 0.04121346886741231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015459060668945312, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10621237754821777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 424.92687157652955, "num_env_steps_trained_throughput_per_sec": 424.92687157652955, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 9112.484, "sample_time_ms": 5830.768, "load_time_ms": 0.565, "load_throughput": 7076903.868, "learn_time_ms": 3276.951, "learn_throughput": 1220.647, "synch_weights_time_ms": 3.225}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 144, "training_iteration": 78, "trial_id": "8124a_00000", "date": "2023-12-11_00-28-29", "timestamp": 1702283309, "time_this_iter_s": 9.422380685806274, "time_total_s": 720.627035856247, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 720.627035856247, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 32.55384615384616, "ram_util_percent": 82.75384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02002258226275444, "cur_lr": 4.999999873689376e-05, "total_loss": 10.002596855163574, "policy_loss": 0.007467960938811302, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.008449320681393147, "entropy": 0.6165196299552917, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73005.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -830464.77, "episode_len_mean": 2125.52, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0], "episode_lengths": [617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2922088220092883, "mean_inference_ms": 1.0281891638569132, "mean_action_processing_ms": 0.11271606770394184, "mean_env_wait_ms": 0.041211638830526115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002546548843383789, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10818219184875488}}, "episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -830464.77, "episode_len_mean": 2125.52, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-367203.0, -594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0], "episode_lengths": [617, 1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2922088220092883, "mean_inference_ms": 1.0281891638569132, "mean_action_processing_ms": 0.11271606770394184, "mean_env_wait_ms": 0.041211638830526115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002546548843383789, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10818219184875488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.97942168962624, "num_env_steps_trained_throughput_per_sec": 440.97942168962624, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 9105.057, "sample_time_ms": 5824.695, "load_time_ms": 0.516, "load_throughput": 7755381.131, "learn_time_ms": 3275.579, "learn_throughput": 1221.158, "synch_weights_time_ms": 3.273}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "episodes_total": 146, "training_iteration": 79, "trial_id": "8124a_00000", "date": "2023-12-11_00-28-38", "timestamp": 1702283318, "time_this_iter_s": 9.078691959381104, "time_total_s": 729.705727815628, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 729.705727815628, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 29.51538461538462, "ram_util_percent": 82.83846153846153}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02002258226275444, "cur_lr": 4.999999873689376e-05, "total_loss": 10.015702247619629, "policy_loss": 0.018173789605498314, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.002463758224621415, "entropy": 0.6379736065864563, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73935.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -831871.89, "episode_len_mean": 2129.24, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0], "episode_lengths": [1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29219185941621534, "mean_inference_ms": 1.0280776026664877, "mean_action_processing_ms": 0.11268290649669403, "mean_env_wait_ms": 0.04120106375739385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030417442321777344, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10886049270629883}}, "episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -831871.89, "episode_len_mean": 2129.24, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-594905.0, -812328.0, -538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0], "episode_lengths": [1299, 2125, 1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29219185941621534, "mean_inference_ms": 1.0280776026664877, "mean_action_processing_ms": 0.11268290649669403, "mean_env_wait_ms": 0.04120106375739385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030417442321777344, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10886049270629883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.4930098372728, "num_env_steps_trained_throughput_per_sec": 437.4930098372728, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 9113.346, "sample_time_ms": 5829.485, "load_time_ms": 0.416, "load_throughput": 9623274.062, "learn_time_ms": 3278.996, "learn_throughput": 1219.885, "synch_weights_time_ms": 3.349}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 147, "training_iteration": 80, "trial_id": "8124a_00000", "date": "2023-12-11_00-28-47", "timestamp": 1702283327, "time_this_iter_s": 9.149993896484375, "time_total_s": 738.8557217121124, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 738.8557217121124, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 30.284615384615385, "ram_util_percent": 83.13846153846151}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.01001129113137722, "cur_lr": 4.999999873689376e-05, "total_loss": 10.01015853881836, "policy_loss": 0.0151243070140481, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.0074384380131959915, "entropy": 0.5589808225631714, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 74865.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -837079.01, "episode_len_mean": 2148.56, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0], "episode_lengths": [1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29213395821489113, "mean_inference_ms": 1.0278043775449301, "mean_action_processing_ms": 0.11260441266800081, "mean_env_wait_ms": 0.04117276089931173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002673625946044922, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10844922065734863}}, "episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -837079.01, "episode_len_mean": 2148.56, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-538824.0, -150243.0, -374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0], "episode_lengths": [1541, 497, 872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29213395821489113, "mean_inference_ms": 1.0278043775449301, "mean_action_processing_ms": 0.11260441266800081, "mean_env_wait_ms": 0.04117276089931173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002673625946044922, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10844922065734863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 445.98933233409474, "num_env_steps_trained_throughput_per_sec": 445.98933233409474, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 9105.759, "sample_time_ms": 5824.253, "load_time_ms": 0.314, "load_throughput": 12744770.586, "learn_time_ms": 3276.568, "learn_throughput": 1220.79, "synch_weights_time_ms": 3.324}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 149, "training_iteration": 81, "trial_id": "8124a_00000", "date": "2023-12-11_00-28-56", "timestamp": 1702283336, "time_this_iter_s": 8.977499961853027, "time_total_s": 747.8332216739655, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 747.8332216739655, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 30.584615384615386, "ram_util_percent": 83.38461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.01001129113137722, "cur_lr": 4.999999873689376e-05, "total_loss": 10.010560989379883, "policy_loss": 0.015530342236161232, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.007106837350875139, "entropy": 0.5142458081245422, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 75795.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -849761.74, "episode_len_mean": 2192.61, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0], "episode_lengths": [872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29205450656878756, "mean_inference_ms": 1.0275189639485882, "mean_action_processing_ms": 0.11252730120749986, "mean_env_wait_ms": 0.04114407361866625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002673625946044922, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10729813575744629}}, "episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -849761.74, "episode_len_mean": 2192.61, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-374271.0, -240811.0, -252771.0, -153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0], "episode_lengths": [872, 381, 699, 421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29205450656878756, "mean_inference_ms": 1.0275189639485882, "mean_action_processing_ms": 0.11252730120749986, "mean_env_wait_ms": 0.04114407361866625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002673625946044922, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10729813575744629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.2002459244859, "num_env_steps_trained_throughput_per_sec": 441.2002459244859, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 9084.963, "sample_time_ms": 5820.462, "load_time_ms": 0.416, "load_throughput": 9624378.155, "learn_time_ms": 3259.857, "learn_throughput": 1227.048, "synch_weights_time_ms": 2.928}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "episodes_total": 151, "training_iteration": 82, "trial_id": "8124a_00000", "date": "2023-12-11_00-29-05", "timestamp": 1702283345, "time_this_iter_s": 9.076526641845703, "time_total_s": 756.9097483158112, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 756.9097483158112, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 28.933333333333337, "ram_util_percent": 83.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.01001129113137722, "cur_lr": 4.999999873689376e-05, "total_loss": 9.993882179260254, "policy_loss": 0.0013715849490836263, "vf_loss": 9.992439270019531, "vf_explained_var": 0.0, "kl": 0.0071472846902906895, "entropy": 0.5230197310447693, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 76725.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -851382.13, "episode_len_mean": 2201.68, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0], "episode_lengths": [421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2919297347741095, "mean_inference_ms": 1.0270873701861958, "mean_action_processing_ms": 0.11240872560727112, "mean_env_wait_ms": 0.041102043917147287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002673625946044922, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10295391082763672}}, "episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -851382.13, "episode_len_mean": 2201.68, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153888.0, -3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0], "episode_lengths": [421, 10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2919297347741095, "mean_inference_ms": 1.0270873701861958, "mean_action_processing_ms": 0.11240872560727112, "mean_env_wait_ms": 0.041102043917147287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002673625946044922, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10295391082763672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.28642292233695, "num_env_steps_trained_throughput_per_sec": 441.28642292233695, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 9085.627, "sample_time_ms": 5820.847, "load_time_ms": 0.516, "load_throughput": 7757891.427, "learn_time_ms": 3260.144, "learn_throughput": 1226.94, "synch_weights_time_ms": 2.829}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "episodes_total": 154, "training_iteration": 83, "trial_id": "8124a_00000", "date": "2023-12-11_00-29-14", "timestamp": 1702283354, "time_this_iter_s": 9.073420524597168, "time_total_s": 765.9831688404083, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 765.9831688404083, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 31.584615384615383, "ram_util_percent": 83.37692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.01001129113137722, "cur_lr": 4.999999873689376e-05, "total_loss": 10.018487930297852, "policy_loss": 0.020976105704903603, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.0031534440349787474, "entropy": 0.5197482109069824, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 77655.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -856998.31, "episode_len_mean": 2216.39, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0], "episode_lengths": [10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2918871953875975, "mean_inference_ms": 1.0269398684828277, "mean_action_processing_ms": 0.11236986519962634, "mean_env_wait_ms": 0.041088534451384336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002673625946044922, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.1019752025604248}}, "episode_reward_max": -20500.0, "episode_reward_min": -3894246.0, "episode_reward_mean": -856998.31, "episode_len_mean": 2216.39, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3894246.0, -1389281.0, -83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0], "episode_lengths": [10545, 3944, 252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2918871953875975, "mean_inference_ms": 1.0269398684828277, "mean_action_processing_ms": 0.11236986519962634, "mean_env_wait_ms": 0.041088534451384336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002673625946044922, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.1019752025604248}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.3291554862607, "num_env_steps_trained_throughput_per_sec": 436.3291554862607, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 9104.68, "sample_time_ms": 5824.551, "load_time_ms": 0.403, "load_throughput": 9924410.529, "learn_time_ms": 3275.503, "learn_throughput": 1221.186, "synch_weights_time_ms": 2.757}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 155, "training_iteration": 84, "trial_id": "8124a_00000", "date": "2023-12-11_00-29-23", "timestamp": 1702283363, "time_this_iter_s": 9.175390720367432, "time_total_s": 775.1585595607758, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 775.1585595607758, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 31.900000000000002, "ram_util_percent": 83.19230769230771}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00500564556568861, "cur_lr": 4.999999873689376e-05, "total_loss": 10.006598472595215, "policy_loss": 0.011613339185714722, "vf_loss": 9.994959831237793, "vf_explained_var": -3.845460838647341e-09, "kl": 0.0051396614871919155, "entropy": 0.4967605471611023, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 78585.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -822856.03, "episode_len_mean": 2129.19, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0], "episode_lengths": [252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2918258115024137, "mean_inference_ms": 1.0266983762938904, "mean_action_processing_ms": 0.11230273023812826, "mean_env_wait_ms": 0.0410678363393937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.1013026237487793}}, "episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -822856.03, "episode_len_mean": 2129.19, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0], "episode_lengths": [252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2918258115024137, "mean_inference_ms": 1.0266983762938904, "mean_action_processing_ms": 0.11230273023812826, "mean_env_wait_ms": 0.0410678363393937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.1013026237487793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.4172962507678, "num_env_steps_trained_throughput_per_sec": 433.4172962507678, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 9123.197, "sample_time_ms": 5849.03, "load_time_ms": 0.403, "load_throughput": 9924410.529, "learn_time_ms": 3269.624, "learn_throughput": 1223.382, "synch_weights_time_ms": 2.763}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "episodes_total": 157, "training_iteration": 85, "trial_id": "8124a_00000", "date": "2023-12-11_00-29-33", "timestamp": 1702283373, "time_this_iter_s": 9.237886428833008, "time_total_s": 784.3964459896088, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 784.3964459896088, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 32.815384615384616, "ram_util_percent": 83.21538461538464}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00500564556568861, "cur_lr": 4.999999873689376e-05, "total_loss": 10.027864456176758, "policy_loss": 0.027833756059408188, "vf_loss": 10.0, "vf_explained_var": 0.0, "kl": 0.0060955313965678215, "entropy": 0.45705658197402954, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 79515.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -822856.03, "episode_len_mean": 2129.19, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0], "episode_lengths": [252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2918258115024137, "mean_inference_ms": 1.0266983762938904, "mean_action_processing_ms": 0.11230273023812826, "mean_env_wait_ms": 0.0410678363393937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.1013026237487793}}, "episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -822856.03, "episode_len_mean": 2129.19, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-83845.0, -2456848.0, -965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0], "episode_lengths": [252, 6552, 2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2918258115024137, "mean_inference_ms": 1.0266983762938904, "mean_action_processing_ms": 0.11230273023812826, "mean_env_wait_ms": 0.0410678363393937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.1013026237487793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.7567633543467, "num_env_steps_trained_throughput_per_sec": 442.7567633543467, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 9119.403, "sample_time_ms": 5847.194, "load_time_ms": 0.402, "load_throughput": 9945590.136, "learn_time_ms": 3267.567, "learn_throughput": 1224.152, "synch_weights_time_ms": 2.763}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "episodes_total": 157, "training_iteration": 86, "trial_id": "8124a_00000", "date": "2023-12-11_00-29-42", "timestamp": 1702283382, "time_this_iter_s": 9.042298078536987, "time_total_s": 793.4387440681458, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 793.4387440681458, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 30.953846153846158, "ram_util_percent": 83.06153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00500564556568861, "cur_lr": 4.999999873689376e-05, "total_loss": 10.001306533813477, "policy_loss": 0.0081291189417243, "vf_loss": 9.99315071105957, "vf_explained_var": -4.069907845405396e-06, "kl": 0.0054085045121610165, "entropy": 0.4682824909687042, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 80445.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -823912.66, "episode_len_mean": 2122.68, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0], "episode_lengths": [2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917703682391454, "mean_inference_ms": 1.0264683542413742, "mean_action_processing_ms": 0.1122348189888525, "mean_env_wait_ms": 0.041050192759913846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10219335556030273}}, "episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -823912.66, "episode_len_mean": 2122.68, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-965834.0, -173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0], "episode_lengths": [2693, 567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917703682391454, "mean_inference_ms": 1.0264683542413742, "mean_action_processing_ms": 0.1122348189888525, "mean_env_wait_ms": 0.041050192759913846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10219335556030273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.57838593059495, "num_env_steps_trained_throughput_per_sec": 443.57838593059495, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 9117.375, "sample_time_ms": 5846.107, "load_time_ms": 0.371, "load_throughput": 10787125.313, "learn_time_ms": 3266.639, "learn_throughput": 1224.5, "synch_weights_time_ms": 2.76}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 159, "training_iteration": 87, "trial_id": "8124a_00000", "date": "2023-12-11_00-29-51", "timestamp": 1702283391, "time_this_iter_s": 9.025381803512573, "time_total_s": 802.4641258716583, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 802.4641258716583, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 28.16666666666666, "ram_util_percent": 82.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00500564556568861, "cur_lr": 4.999999873689376e-05, "total_loss": 10.010002136230469, "policy_loss": 0.01247005257755518, "vf_loss": 9.997509002685547, "vf_explained_var": -7.01027545346733e-07, "kl": 0.004740214440971613, "entropy": 0.5315833687782288, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 81375.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -841501.27, "episode_len_mean": 2149.38, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0], "episode_lengths": [567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29174222790757115, "mean_inference_ms": 1.0263626669484835, "mean_action_processing_ms": 0.11220099204520297, "mean_env_wait_ms": 0.04104254409954591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10360527038574219}}, "episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -841501.27, "episode_len_mean": 2149.38, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-173319.0, -56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0], "episode_lengths": [567, 114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29174222790757115, "mean_inference_ms": 1.0263626669484835, "mean_action_processing_ms": 0.11220099204520297, "mean_env_wait_ms": 0.04104254409954591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10360527038574219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 434.38012408607426, "num_env_steps_trained_throughput_per_sec": 434.38012408607426, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 9096.889, "sample_time_ms": 5838.008, "load_time_ms": 0.371, "load_throughput": 10787125.313, "learn_time_ms": 3254.253, "learn_throughput": 1229.161, "synch_weights_time_ms": 2.673}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "episodes_total": 160, "training_iteration": 88, "trial_id": "8124a_00000", "date": "2023-12-11_00-30-00", "timestamp": 1702283400, "time_this_iter_s": 9.218320846557617, "time_total_s": 811.6824467182159, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 811.6824467182159, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 33.4, "ram_util_percent": 82.93076923076924}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.002502822782844305, "cur_lr": 4.999999873689376e-05, "total_loss": 10.01734733581543, "policy_loss": 0.019852247089147568, "vf_loss": 9.997479438781738, "vf_explained_var": -4.685053411890294e-08, "kl": 0.0063048251904547215, "entropy": 0.49960044026374817, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 82305.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -849339.18, "episode_len_mean": 2165.77, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0], "episode_lengths": [114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917139035393432, "mean_inference_ms": 1.0262549427184213, "mean_action_processing_ms": 0.1121665513725328, "mean_env_wait_ms": 0.04103514579085865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10161519050598145}}, "episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -849339.18, "episode_len_mean": 2165.77, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56244.0, -751053.0, -1351723.0, -438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0], "episode_lengths": [114, 2096, 3534, 1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917139035393432, "mean_inference_ms": 1.0262549427184213, "mean_action_processing_ms": 0.1121665513725328, "mean_env_wait_ms": 0.04103514579085865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.005693912506103516, "ViewRequirementAgentConnector_ms": 0.10161519050598145}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.97380431286757, "num_env_steps_trained_throughput_per_sec": 442.97380431286757, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 9092.907, "sample_time_ms": 5838.251, "load_time_ms": 0.371, "load_throughput": 10787125.313, "learn_time_ms": 3250.12, "learn_throughput": 1230.724, "synch_weights_time_ms": 2.681}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "episodes_total": 161, "training_iteration": 89, "trial_id": "8124a_00000", "date": "2023-12-11_00-30-09", "timestamp": 1702283409, "time_this_iter_s": 9.038876056671143, "time_total_s": 820.7213227748871, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 820.7213227748871, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 31.06153846153846, "ram_util_percent": 82.88461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.002502822782844305, "cur_lr": 4.999999873689376e-05, "total_loss": 9.998103141784668, "policy_loss": 0.0056471917778253555, "vf_loss": 9.992439270019531, "vf_explained_var": -1.6663663782168214e-09, "kl": 0.006939115934073925, "entropy": 0.5084246397018433, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 83235.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -855312.06, "episode_len_mean": 2178.9, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0], "episode_lengths": [1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2916322770007929, "mean_inference_ms": 1.0259490221087746, "mean_action_processing_ms": 0.11206606810856021, "mean_env_wait_ms": 0.041013084495736735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.004668235778808594, "ViewRequirementAgentConnector_ms": 0.09983158111572266}}, "episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -855312.06, "episode_len_mean": 2178.9, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-438754.0, -1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0], "episode_lengths": [1336, 3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2916322770007929, "mean_inference_ms": 1.0259490221087746, "mean_action_processing_ms": 0.11206606810856021, "mean_env_wait_ms": 0.041013084495736735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.004668235778808594, "ViewRequirementAgentConnector_ms": 0.09983158111572266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.4824269956384, "num_env_steps_trained_throughput_per_sec": 417.4824269956384, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 9136.731, "sample_time_ms": 5830.752, "load_time_ms": 0.371, "load_throughput": 10787125.313, "learn_time_ms": 3301.484, "learn_throughput": 1211.577, "synch_weights_time_ms": 2.655}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 164, "training_iteration": 90, "trial_id": "8124a_00000", "date": "2023-12-11_00-30-19", "timestamp": 1702283419, "time_this_iter_s": 9.590247631072998, "time_total_s": 830.3115704059601, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 830.3115704059601, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 35.27857142857143, "ram_util_percent": 83.11428571428569}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.002502822782844305, "cur_lr": 4.999999873689376e-05, "total_loss": 10.020064353942871, "policy_loss": 0.02257045917212963, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.0056444937363266945, "entropy": 0.4698319435119629, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 84165.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -860614.96, "episode_len_mean": 2189.32, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0], "episode_lengths": [3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29163126123307737, "mean_inference_ms": 1.0259054631500397, "mean_action_processing_ms": 0.11535228778696645, "mean_env_wait_ms": 0.041012132386276996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.004668235778808594, "ViewRequirementAgentConnector_ms": 0.0988466739654541}}, "episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -860614.96, "episode_len_mean": 2189.32, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1530363.0, -574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0], "episode_lengths": [3707, 1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29163126123307737, "mean_inference_ms": 1.0259054631500397, "mean_action_processing_ms": 0.11535228778696645, "mean_env_wait_ms": 0.041012132386276996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.004668235778808594, "ViewRequirementAgentConnector_ms": 0.0988466739654541}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.968471205606285, "num_env_steps_trained_throughput_per_sec": 29.968471205606285, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 21587.198, "sample_time_ms": 18237.96, "load_time_ms": 0.426, "load_throughput": 9397947.569, "learn_time_ms": 3344.713, "learn_throughput": 1195.917, "synch_weights_time_ms": 2.686}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 165, "training_iteration": 91, "trial_id": "8124a_00000", "date": "2023-12-11_00-32-32", "timestamp": 1702283552, "time_this_iter_s": 133.48058891296387, "time_total_s": 963.792159318924, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 963.792159318924, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 56.04999999999999, "ram_util_percent": 89.44444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.002502822782844305, "cur_lr": 4.999999873689376e-05, "total_loss": 10.007779121398926, "policy_loss": 0.010287893936038017, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.00473847147077322, "entropy": 0.49015381932258606, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 85095.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -868803.52, "episode_len_mean": 2209.77, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0], "episode_lengths": [1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2916399523632732, "mean_inference_ms": 1.0258791048356783, "mean_action_processing_ms": 0.11860642304056432, "mean_env_wait_ms": 0.0410118767161597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041806697845458984, "StateBufferConnector_ms": 0.004668235778808594, "ViewRequirementAgentConnector_ms": 0.0988466739654541}}, "episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -868803.52, "episode_len_mean": 2209.77, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-574855.0, -2531697.0, -1886786.0, -31153.0, -479469.0, -209283.0, -1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0], "episode_lengths": [1668, 5532, 4828, 57, 935, 438, 4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2916399523632732, "mean_inference_ms": 1.0258791048356783, "mean_action_processing_ms": 0.11860642304056432, "mean_env_wait_ms": 0.0410118767161597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041806697845458984, "StateBufferConnector_ms": 0.004668235778808594, "ViewRequirementAgentConnector_ms": 0.0988466739654541}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 377.82649800917926, "num_env_steps_trained_throughput_per_sec": 377.82649800917926, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 21739.267, "sample_time_ms": 18311.109, "load_time_ms": 0.324, "load_throughput": 12350718.492, "learn_time_ms": 3423.434, "learn_throughput": 1168.418, "synch_weights_time_ms": 2.788}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "episodes_total": 166, "training_iteration": 92, "trial_id": "8124a_00000", "date": "2023-12-11_00-32-43", "timestamp": 1702283563, "time_this_iter_s": 10.595865249633789, "time_total_s": 974.3880245685577, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 974.3880245685577, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 39.34, "ram_util_percent": 91.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0012514113914221525, "cur_lr": 4.999999873689376e-05, "total_loss": 9.996769905090332, "policy_loss": 0.011884882114827633, "vf_loss": 9.984879493713379, "vf_explained_var": 0.0, "kl": 0.005512765608727932, "entropy": 0.44272100925445557, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 86025.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -829771.94, "episode_len_mean": 2118.62, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0, -1078657.0, -27453.0, -461524.0, -22842.0, -97380.0, -122229.0], "episode_lengths": [4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752, 2340, 130, 1191, 101, 218, 363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29170735531874686, "mean_inference_ms": 1.0257811577286302, "mean_action_processing_ms": 0.1379501217483746, "mean_env_wait_ms": 0.041023916921888046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041806697845458984, "StateBufferConnector_ms": 0.001636505126953125, "ViewRequirementAgentConnector_ms": 0.09764313697814941}}, "episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -829771.94, "episode_len_mean": 2118.62, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1770046.0, -862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0, -1078657.0, -27453.0, -461524.0, -22842.0, -97380.0, -122229.0], "episode_lengths": [4820, 2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752, 2340, 130, 1191, 101, 218, 363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29170735531874686, "mean_inference_ms": 1.0257811577286302, "mean_action_processing_ms": 0.1379501217483746, "mean_env_wait_ms": 0.041023916921888046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041806697845458984, "StateBufferConnector_ms": 0.001636505126953125, "ViewRequirementAgentConnector_ms": 0.09764313697814941}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.9275624879896, "num_env_steps_trained_throughput_per_sec": 437.9275624879896, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 21746.219, "sample_time_ms": 18326.749, "load_time_ms": 0.224, "load_throughput": 17867109.691, "learn_time_ms": 3414.632, "learn_throughput": 1171.429, "synch_weights_time_ms": 2.885}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 172, "training_iteration": 93, "trial_id": "8124a_00000", "date": "2023-12-11_00-32-52", "timestamp": 1702283572, "time_this_iter_s": 9.142860412597656, "time_total_s": 983.5308849811554, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 983.5308849811554, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 32.43846153846154, "ram_util_percent": 91.57692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0012514113914221525, "cur_lr": 4.999999873689376e-05, "total_loss": 10.008123397827148, "policy_loss": 0.010638119652867317, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.004172447603195906, "entropy": 0.43953758478164673, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 86955.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -816590.36, "episode_len_mean": 2084.41, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0, -1078657.0, -27453.0, -461524.0, -22842.0, -97380.0, -122229.0, -451888.0], "episode_lengths": [2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752, 2340, 130, 1191, 101, 218, 363, 1399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29171745754908546, "mean_inference_ms": 1.0257721459467894, "mean_action_processing_ms": 0.14114234800508715, "mean_env_wait_ms": 0.041026213348733936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041806697845458984, "StateBufferConnector_ms": 0.001636505126953125, "ViewRequirementAgentConnector_ms": 0.0980224609375}}, "episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -816590.36, "episode_len_mean": 2084.41, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-862792.0, -3212748.0, -20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0, -1078657.0, -27453.0, -461524.0, -22842.0, -97380.0, -122229.0, -451888.0], "episode_lengths": [2404, 8311, 46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752, 2340, 130, 1191, 101, 218, 363, 1399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29171745754908546, "mean_inference_ms": 1.0257721459467894, "mean_action_processing_ms": 0.14114234800508715, "mean_env_wait_ms": 0.041026213348733936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041806697845458984, "StateBufferConnector_ms": 0.001636505126953125, "ViewRequirementAgentConnector_ms": 0.0980224609375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.09305378746257, "num_env_steps_trained_throughput_per_sec": 435.09305378746257, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 21748.724, "sample_time_ms": 18338.669, "load_time_ms": 0.224, "load_throughput": 17867109.691, "learn_time_ms": 3405.219, "learn_throughput": 1174.668, "synch_weights_time_ms": 2.88}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "episodes_total": 173, "training_iteration": 94, "trial_id": "8124a_00000", "date": "2023-12-11_00-33-01", "timestamp": 1702283581, "time_this_iter_s": 9.1994469165802, "time_total_s": 992.7303318977356, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 992.7303318977356, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 31.884615384615383, "ram_util_percent": 91.37692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0006257056957110763, "cur_lr": 4.999999873689376e-05, "total_loss": 10.011580467224121, "policy_loss": 0.016617508605122566, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.005109675694257021, "entropy": 0.41558751463890076, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -798980.58, "episode_len_mean": 2038.66, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0, -1078657.0, -27453.0, -461524.0, -22842.0, -97380.0, -122229.0, -451888.0, -1859527.0, -455035.0], "episode_lengths": [46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752, 2340, 130, 1191, 101, 218, 363, 1399, 4637, 1503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917392316867294, "mean_inference_ms": 1.0257527933283124, "mean_action_processing_ms": 0.14745997082367496, "mean_env_wait_ms": 0.04103138131283404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041806697845458984, "StateBufferConnector_ms": 0.001636505126953125, "ViewRequirementAgentConnector_ms": 0.09871935844421387}}, "episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -798980.58, "episode_len_mean": 2038.66, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-20913.0, -31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0, -1078657.0, -27453.0, -461524.0, -22842.0, -97380.0, -122229.0, -451888.0, -1859527.0, -455035.0], "episode_lengths": [46, 96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752, 2340, 130, 1191, 101, 218, 363, 1399, 4637, 1503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917392316867294, "mean_inference_ms": 1.0257527933283124, "mean_action_processing_ms": 0.14745997082367496, "mean_env_wait_ms": 0.04103138131283404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041806697845458984, "StateBufferConnector_ms": 0.001636505126953125, "ViewRequirementAgentConnector_ms": 0.09871935844421387}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.18402943430993, "num_env_steps_trained_throughput_per_sec": 446.18402943430993, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 21722.317, "sample_time_ms": 18309.119, "load_time_ms": 0.224, "load_throughput": 17867109.691, "learn_time_ms": 3408.24, "learn_throughput": 1173.626, "synch_weights_time_ms": 2.898}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "episodes_total": 175, "training_iteration": 95, "trial_id": "8124a_00000", "date": "2023-12-11_00-33-11", "timestamp": 1702283591, "time_this_iter_s": 8.974907875061035, "time_total_s": 1001.7052397727966, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1001.7052397727966, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 30.691666666666663, "ram_util_percent": 92.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0006257056957110763, "cur_lr": 4.999999873689376e-05, "total_loss": 10.006606101989746, "policy_loss": 0.009123455733060837, "vf_loss": 9.997479438781738, "vf_explained_var": 0.0, "kl": 0.004348639864474535, "entropy": 0.4193275272846222, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 88815.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -809807.13, "episode_len_mean": 2064.88, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0, -1078657.0, -27453.0, -461524.0, -22842.0, -97380.0, -122229.0, -451888.0, -1859527.0, -455035.0, -1103568.0], "episode_lengths": [96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752, 2340, 130, 1191, 101, 218, 363, 1399, 4637, 1503, 2668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29175009507268135, "mean_inference_ms": 1.0257431025037655, "mean_action_processing_ms": 0.15058601540754057, "mean_env_wait_ms": 0.0410339552771428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041806697845458984, "StateBufferConnector_ms": 0.001636505126953125, "ViewRequirementAgentConnector_ms": 0.10072875022888184}}, "episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -809807.13, "episode_len_mean": 2064.88, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31872.0, -1765622.0, -1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0, -1078657.0, -27453.0, -461524.0, -22842.0, -97380.0, -122229.0, -451888.0, -1859527.0, -455035.0, -1103568.0], "episode_lengths": [96, 4506, 3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752, 2340, 130, 1191, 101, 218, 363, 1399, 4637, 1503, 2668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29175009507268135, "mean_inference_ms": 1.0257431025037655, "mean_action_processing_ms": 0.15058601540754057, "mean_env_wait_ms": 0.0410339552771428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041806697845458984, "StateBufferConnector_ms": 0.001636505126953125, "ViewRequirementAgentConnector_ms": 0.10072875022888184}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.33942015576645, "num_env_steps_trained_throughput_per_sec": 438.33942015576645, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 21731.421, "sample_time_ms": 18300.751, "load_time_ms": 0.125, "load_throughput": 32042047.364, "learn_time_ms": 3425.863, "learn_throughput": 1167.589, "synch_weights_time_ms": 2.838}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 176, "training_iteration": 96, "trial_id": "8124a_00000", "date": "2023-12-11_00-33-20", "timestamp": 1702283600, "time_this_iter_s": 9.13335919380188, "time_total_s": 1010.8385989665985, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1010.8385989665985, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 31.800000000000004, "ram_util_percent": 92.0923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00031285284785553813, "cur_lr": 4.999999873689376e-05, "total_loss": 10.002557754516602, "policy_loss": 0.00850705336779356, "vf_loss": 9.994050025939941, "vf_explained_var": -1.6091331644929596e-06, "kl": 0.00420045293867588, "entropy": 0.42117756605148315, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 89745.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -812653.67, "episode_len_mean": 2074.3, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0, -1078657.0, -27453.0, -461524.0, -22842.0, -97380.0, -122229.0, -451888.0, -1859527.0, -455035.0, -1103568.0, -1691424.0, -390724.0], "episode_lengths": [3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752, 2340, 130, 1191, 101, 218, 363, 1399, 4637, 1503, 2668, 4477, 1067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917713547216639, "mean_inference_ms": 1.025725131343191, "mean_action_processing_ms": 0.15677154782448738, "mean_env_wait_ms": 0.04103874912863877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041806697845458984, "StateBufferConnector_ms": 0.001636505126953125, "ViewRequirementAgentConnector_ms": 0.09990596771240234}}, "episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -812653.67, "episode_len_mean": 2074.3, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1152159.0, -43633.0, -536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0, -1078657.0, -27453.0, -461524.0, -22842.0, -97380.0, -122229.0, -451888.0, -1859527.0, -455035.0, -1103568.0, -1691424.0, -390724.0], "episode_lengths": [3138, 89, 1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752, 2340, 130, 1191, 101, 218, 363, 1399, 4637, 1503, 2668, 4477, 1067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917713547216639, "mean_inference_ms": 1.025725131343191, "mean_action_processing_ms": 0.15677154782448738, "mean_env_wait_ms": 0.04103874912863877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041806697845458984, "StateBufferConnector_ms": 0.001636505126953125, "ViewRequirementAgentConnector_ms": 0.09990596771240234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.48132848122106, "num_env_steps_trained_throughput_per_sec": 438.48132848122106, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 21741.903, "sample_time_ms": 18313.802, "load_time_ms": 0.055, "load_throughput": 72976146.151, "learn_time_ms": 3423.383, "learn_throughput": 1168.435, "synch_weights_time_ms": 2.744}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "episodes_total": 178, "training_iteration": 97, "trial_id": "8124a_00000", "date": "2023-12-11_00-33-29", "timestamp": 1702283609, "time_this_iter_s": 9.129387140274048, "time_total_s": 1019.9679861068726, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1019.9679861068726, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 32.73846153846153, "ram_util_percent": 92.25384615384613}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00015642642392776906, "cur_lr": 4.999999873689376e-05, "total_loss": 10.015174865722656, "policy_loss": 0.02013089694082737, "vf_loss": 9.99504280090332, "vf_explained_var": 6.409101582782739e-10, "kl": 0.0054735238663852215, "entropy": 0.38761696219444275, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 90675.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -813508.92, "episode_len_mean": 2071.6, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0, -1078657.0, -27453.0, -461524.0, -22842.0, -97380.0, -122229.0, -451888.0, -1859527.0, -455035.0, -1103568.0, -1691424.0, -390724.0, -561215.0, -720102.0], "episode_lengths": [1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752, 2340, 130, 1191, 101, 218, 363, 1399, 4637, 1503, 2668, 4477, 1067, 1064, 1893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917789497486985, "mean_inference_ms": 1.0257060820955335, "mean_action_processing_ms": 0.16288198502891188, "mean_env_wait_ms": 0.04104150572645925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751039505004883, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.1003110408782959}}, "episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -813508.92, "episode_len_mean": 2071.6, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-536511.0, -2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0, -1078657.0, -27453.0, -461524.0, -22842.0, -97380.0, -122229.0, -451888.0, -1859527.0, -455035.0, -1103568.0, -1691424.0, -390724.0, -561215.0, -720102.0], "episode_lengths": [1450, 5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752, 2340, 130, 1191, 101, 218, 363, 1399, 4637, 1503, 2668, 4477, 1067, 1064, 1893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917789497486985, "mean_inference_ms": 1.0257060820955335, "mean_action_processing_ms": 0.16288198502891188, "mean_env_wait_ms": 0.04104150572645925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751039505004883, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.1003110408782959}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.5693087091599, "num_env_steps_trained_throughput_per_sec": 443.5693087091599, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 21722.827, "sample_time_ms": 18300.122, "load_time_ms": 0.055, "load_throughput": 72976146.151, "learn_time_ms": 3418.085, "learn_throughput": 1170.246, "synch_weights_time_ms": 2.828}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 180, "training_iteration": 98, "trial_id": "8124a_00000", "date": "2023-12-11_00-33-38", "timestamp": 1702283618, "time_this_iter_s": 9.025769233703613, "time_total_s": 1028.9937553405762, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1028.9937553405762, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 32.176923076923075, "ram_util_percent": 92.37692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00015642642392776906, "cur_lr": 4.999999873689376e-05, "total_loss": 10.01343059539795, "policy_loss": 0.0159490704536438, "vf_loss": 9.997479438781738, "vf_explained_var": -2.6020952503813533e-08, "kl": 0.0043629533611238, "entropy": 0.3609195947647095, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 91605.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -822105.45, "episode_len_mean": 2095.13, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0, -1078657.0, -27453.0, -461524.0, -22842.0, -97380.0, -122229.0, -451888.0, -1859527.0, -455035.0, -1103568.0, -1691424.0, -390724.0, -561215.0, -720102.0, -1396164.0], "episode_lengths": [5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752, 2340, 130, 1191, 101, 218, 363, 1399, 4637, 1503, 2668, 4477, 1067, 1064, 1893, 3803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917841074728071, "mean_inference_ms": 1.0257024813034343, "mean_action_processing_ms": 0.16590846460370673, "mean_env_wait_ms": 0.04104207266191243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751039505004883, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.10132217407226562}}, "episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -822105.45, "episode_len_mean": 2095.13, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2327893.0, -1527529.0, -306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0, -1078657.0, -27453.0, -461524.0, -22842.0, -97380.0, -122229.0, -451888.0, -1859527.0, -455035.0, -1103568.0, -1691424.0, -390724.0, -561215.0, -720102.0, -1396164.0], "episode_lengths": [5159, 3770, 684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752, 2340, 130, 1191, 101, 218, 363, 1399, 4637, 1503, 2668, 4477, 1067, 1064, 1893, 3803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917841074728071, "mean_inference_ms": 1.0257024813034343, "mean_action_processing_ms": 0.16590846460370673, "mean_env_wait_ms": 0.04104207266191243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751039505004883, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.10132217407226562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.9375117333551, "num_env_steps_trained_throughput_per_sec": 435.9375117333551, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 21737.401, "sample_time_ms": 18313.036, "load_time_ms": 0.142, "load_throughput": 28263504.043, "learn_time_ms": 3419.215, "learn_throughput": 1169.859, "synch_weights_time_ms": 3.162}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 181, "training_iteration": 99, "trial_id": "8124a_00000", "date": "2023-12-11_00-33-47", "timestamp": 1702283627, "time_this_iter_s": 9.183619260787964, "time_total_s": 1038.1773746013641, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1038.1773746013641, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 31.207692307692305, "ram_util_percent": 92.4076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.821321196388453e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 10.002429962158203, "policy_loss": 0.007470351178199053, "vf_loss": 9.994959831237793, "vf_explained_var": 0.0, "kl": 0.005384733434766531, "entropy": 0.36053577065467834, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 92535.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "sampler_results": {"episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -802017.11, "episode_len_mean": 2057.94, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0, -1078657.0, -27453.0, -461524.0, -22842.0, -97380.0, -122229.0, -451888.0, -1859527.0, -455035.0, -1103568.0, -1691424.0, -390724.0, -561215.0, -720102.0, -1396164.0, -938097.0, -908491.0], "episode_lengths": [684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752, 2340, 130, 1191, 101, 218, 363, 1399, 4637, 1503, 2668, 4477, 1067, 1064, 1893, 3803, 3081, 2129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29179394373112294, "mean_inference_ms": 1.0257025121802605, "mean_action_processing_ms": 0.17190298314332753, "mean_env_wait_ms": 0.041044938285977904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751039505004883, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.10221266746520996}}, "episode_reward_max": -20500.0, "episode_reward_min": -3299510.0, "episode_reward_mean": -802017.11, "episode_len_mean": 2057.94, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-306866.0, -30838.0, -180801.0, -522340.0, -605021.0, -674891.0, -571342.0, -424402.0, -2791663.0, -309924.0, -837322.0, -632765.0, -1223524.0, -961024.0, -277297.0, -154505.0, -2589308.0, -1129900.0, -89396.0, -256270.0, -3299510.0, -264461.0, -859561.0, -2179059.0, -411337.0, -175998.0, -3104789.0, -437594.0, -601244.0, -124220.0, -94648.0, -241378.0, -367250.0, -628383.0, -118169.0, -2607678.0, -287373.0, -94875.0, -371651.0, -1895809.0, -356400.0, -346968.0, -1205161.0, -212678.0, -373026.0, -115447.0, -557864.0, -851555.0, -1026221.0, -258993.0, -969595.0, -191967.0, -1769315.0, -110554.0, -20500.0, -228302.0, -165120.0, -728875.0, -2233775.0, -492384.0, -839657.0, -367911.0, -1348108.0, -507915.0, -1752719.0, -175226.0, -1094880.0, -862460.0, -233437.0, -185634.0, -610821.0, -715506.0, -1358705.0, -510594.0, -2559115.0, -87241.0, -2724695.0, -957110.0, -1859298.0, -337750.0, -559260.0, -969044.0, -2349219.0, -1078657.0, -27453.0, -461524.0, -22842.0, -97380.0, -122229.0, -451888.0, -1859527.0, -455035.0, -1103568.0, -1691424.0, -390724.0, -561215.0, -720102.0, -1396164.0, -938097.0, -908491.0], "episode_lengths": [684, 111, 346, 1401, 1573, 1938, 1451, 968, 6803, 776, 2605, 1926, 3703, 2610, 584, 369, 6578, 3217, 199, 766, 7915, 491, 1341, 5108, 1140, 299, 7682, 1093, 1740, 559, 266, 740, 614, 2231, 432, 7374, 926, 394, 1004, 4786, 944, 861, 3924, 688, 810, 407, 1442, 2023, 2649, 831, 3211, 400, 3409, 200, 37, 495, 446, 2602, 3636, 1541, 2466, 1224, 2524, 989, 4881, 475, 3587, 2856, 681, 938, 1240, 1892, 4555, 1214, 5904, 249, 5363, 2206, 4915, 942, 1200, 2378, 5752, 2340, 130, 1191, 101, 218, 363, 1399, 4637, 1503, 2668, 4477, 1067, 1064, 1893, 3803, 3081, 2129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29179394373112294, "mean_inference_ms": 1.0257025121802605, "mean_action_processing_ms": 0.17190298314332753, "mean_env_wait_ms": 0.041044938285977904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751039505004883, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.10221266746520996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 445.7144010894451, "num_env_steps_trained_throughput_per_sec": 445.7144010894451, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 21676.713, "sample_time_ms": 18313.733, "load_time_ms": 0.142, "load_throughput": 28263504.043, "learn_time_ms": 3357.891, "learn_throughput": 1191.224, "synch_weights_time_ms": 3.201}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": true, "episodes_total": 183, "training_iteration": 100, "trial_id": "8124a_00000", "date": "2023-12-11_00-33-56", "timestamp": 1702283636, "time_this_iter_s": 8.996942520141602, "time_total_s": 1047.1743171215057, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002440F8EE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1047.1743171215057, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 28.849999999999998, "ram_util_percent": 92.5}}
