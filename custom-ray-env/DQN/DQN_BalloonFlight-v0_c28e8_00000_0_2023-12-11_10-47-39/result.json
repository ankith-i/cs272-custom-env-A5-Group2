{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -333861.0, "episode_reward_min": -333861.0, "episode_reward_mean": -333861.0, "episode_len_mean": 768.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0], "episode_lengths": [768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0735998144159309, "mean_inference_ms": 1.6955869657533629, "mean_action_processing_ms": 0.09205862954184488, "mean_env_wait_ms": 0.052674071533934816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09572505950927734}}, "episode_reward_max": -333861.0, "episode_reward_min": -333861.0, "episode_reward_mean": -333861.0, "episode_len_mean": 768.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0], "episode_lengths": [768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0735998144159309, "mean_inference_ms": 1.6955869657533629, "mean_action_processing_ms": 0.09205862954184488, "mean_env_wait_ms": 0.052674071533934816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09572505950927734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 139.17800077162866, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1000, "timers": {"training_iteration_time_ms": 6.713, "sample_time_ms": 6.117}, "counters": {"num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "c28e8_00000", "date": "2023-12-11_10-48-28", "timestamp": 1702320508, "time_this_iter_s": 7.1876585483551025, "time_total_s": 7.1876585483551025, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7.1876585483551025, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.945454545454545, "ram_util_percent": 97.5090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -932.4615478515625, "min_q": -963.593994140625, "max_q": -923.9841918945312, "mean_td_error": 32.67604064941406, "model": {}}, "td_error": [-73.76910400390625, 456.212890625, -343.80841064453125, -336.76910400390625, 397.1915283203125, -231.76910400390625, -358.76910400390625, 423.78662109375, 226.2308349609375, -319.78704833984375, 416.2308349609375, 110.1915283203125, 523.8116455078125, -427.76910400390625, -404.78704833984375, 255.2308349609375, 418.212890625, 477.2308349609375, -306.76910400390625, 500.82269287109375, -314.80841064453125, 331.1915283203125, 166.1915283203125, -209.76910400390625, -346.76910400390625, 456.212890625, -427.76910400390625, 27.19158935546875, -67.80841064453125, -338.80841064453125, 486.23077392578125, -116.8084716796875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 999.0}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "last_target_update_ts": 1501, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": -333861.0, "episode_reward_min": -333861.0, "episode_reward_mean": -333861.0, "episode_len_mean": 768.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0], "episode_lengths": [768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0735998144159309, "mean_inference_ms": 1.6955869657533629, "mean_action_processing_ms": 0.09205862954184488, "mean_env_wait_ms": 0.052674071533934816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09572505950927734}}, "episode_reward_max": -333861.0, "episode_reward_min": -333861.0, "episode_reward_mean": -333861.0, "episode_len_mean": 768.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0], "episode_lengths": [768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0735998144159309, "mean_inference_ms": 1.6955869657533629, "mean_action_processing_ms": 0.09205862954184488, "mean_env_wait_ms": 0.052674071533934816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09572505950927734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.175046205730474, "num_env_steps_trained_throughput_per_sec": 869.6014785833752, "timesteps_total": 2000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 2000, "timers": {"training_iteration_time_ms": 36.052, "sample_time_ms": 11.572, "load_time_ms": 0.1, "load_throughput": 320711.417, "learn_time_ms": 4.665, "learn_throughput": 6859.322, "synch_weights_time_ms": 2.917}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "last_target_update_ts": 1501, "num_target_updates": 2}, "done": false, "episodes_total": 1, "training_iteration": 2, "trial_id": "c28e8_00000", "date": "2023-12-11_10-49-05", "timestamp": 1702320545, "time_this_iter_s": 36.80547380447388, "time_total_s": 43.99313235282898, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 43.99313235282898, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.07450980392157, "ram_util_percent": 97.50392156862746}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -1876.486572265625, "min_q": -1898.1923828125, "max_q": -1867.04833984375, "mean_td_error": 9.650814056396484, "model": {}}, "td_error": [-111.04345703125, -127.9493408203125, 504.2076416015625, 180.53564453125, -271.04345703125, -374.04345703125, -317.9493408203125, 451.0506591796875, -377.9493408203125, 279.53564453125, -410.9493408203125, 470.586669921875, 470.586669921875, 293.95654296875, -293.04345703125, 294.0506591796875, -137.9493408203125, 477.0506591796875, 504.2076416015625, 13.53564453125, -327.46435546875, 534.712890625, -322.9493408203125, -357.46435546875, 170.0506591796875, 361.95654296875, 128.0506591796875, -316.04345703125, -310.46435546875, -317.9493408203125, -351.0435791015625, -99.949462890625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 2000.0, "diff_num_grad_updates_vs_sampler_policy": 1999.0}}, "num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "last_target_update_ts": 2501, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": -333861.0, "episode_reward_min": -333861.0, "episode_reward_mean": -333861.0, "episode_len_mean": 768.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0], "episode_lengths": [768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0735998144159309, "mean_inference_ms": 1.6955869657533629, "mean_action_processing_ms": 0.09205862954184488, "mean_env_wait_ms": 0.052674071533934816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09572505950927734}}, "episode_reward_max": -333861.0, "episode_reward_min": -333861.0, "episode_reward_mean": -333861.0, "episode_len_mean": 768.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0], "episode_lengths": [768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0735998144159309, "mean_inference_ms": 1.6955869657533629, "mean_action_processing_ms": 0.09205862954184488, "mean_env_wait_ms": 0.052674071533934816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09572505950927734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.649020401408443, "num_env_steps_trained_throughput_per_sec": 884.7686528450702, "timesteps_total": 3000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 3000, "timers": {"training_iteration_time_ms": 35.8, "sample_time_ms": 11.879, "load_time_ms": 0.2, "load_throughput": 160049.759, "learn_time_ms": 5.002, "learn_throughput": 6396.925, "synch_weights_time_ms": 2.928}, "counters": {"num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "last_target_update_ts": 2501, "num_target_updates": 4}, "done": false, "episodes_total": 1, "training_iteration": 3, "trial_id": "c28e8_00000", "date": "2023-12-11_10-49-41", "timestamp": 1702320581, "time_this_iter_s": 36.17729640007019, "time_total_s": 80.17042875289917, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 80.17042875289917, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.58, "ram_util_percent": 97.41799999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -2801.530517578125, "min_q": -2802.848388671875, "max_q": -2800.716552734375, "mean_td_error": -8.945693969726562, "model": {}}, "td_error": [167.846923828125, 194.69873046875, 451.846923828125, 442.00146484375, -344.153076171875, -243.30126953125, 514.846923828125, -36.153076171875, 0.846923828125, -142.30126953125, 15.69873046875, -179.153076171875, 197.846923828125, 222.017822265625, -99.153076171875, 420.846923828125, -446.30126953125, -136.153076171875, 208.69873046875, -461.153076171875, -355.30126953125, 459.846923828125, -148.30126953125, -411.153076171875, -263.982177734375, -313.153076171875, 291.846923828125, -445.982177734375, -441.153076171875, 352.846923828125, 510.149658203125, -271.30126953125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 3000.0, "diff_num_grad_updates_vs_sampler_policy": 2999.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "last_target_update_ts": 3501, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.758775616195354, "num_env_steps_trained_throughput_per_sec": 888.2808197182513, "timesteps_total": 4000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 35.688, "sample_time_ms": 11.67, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 4.901, "learn_throughput": 6528.989, "synch_weights_time_ms": 2.8}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "last_target_update_ts": 3501, "num_target_updates": 6}, "done": false, "episodes_total": 3, "training_iteration": 4, "trial_id": "c28e8_00000", "date": "2023-12-11_10-50-17", "timestamp": 1702320617, "time_this_iter_s": 36.03362703323364, "time_total_s": 116.20405578613281, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 116.20405578613281, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.7235294117647, "ram_util_percent": 96.7392156862745}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -3680.27490234375, "min_q": -3680.291748046875, "max_q": -3680.13427734375, "mean_td_error": 44.82695007324219, "model": {}}, "td_error": [440.382080078125, -251.64306640625, 445.382080078125, -280.617919921875, 347.382080078125, 510.14794921875, 397.382080078125, 443.35693359375, -59.64111328125, 327.35888671875, 450.382080078125, 326.35888671875, -128.64111328125, -425.64111328125, 260.382080078125, -231.64306640625, 444.382080078125, 510.14794921875, 227.382080078125, 291.382080078125, -3680.266357421875, -173.64306640625, -354.617919921875, -176.64306640625, 291.382080078125, -174.617919921875, 376.35888671875, 280.35693359375, 510.30517578125, 279.35888671875, -297.641357421875, 510.148193359375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 4000.0, "diff_num_grad_updates_vs_sampler_policy": 3999.0}}, "num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "last_target_update_ts": 4501, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.453169361080015, "num_env_steps_trained_throughput_per_sec": 878.5014195545605, "timesteps_total": 5000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 5000, "timers": {"training_iteration_time_ms": 35.876, "sample_time_ms": 11.61, "load_time_ms": 0.1, "load_throughput": 320481.681, "learn_time_ms": 5.097, "learn_throughput": 6277.87, "synch_weights_time_ms": 3.343}, "counters": {"num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "last_target_update_ts": 4501, "num_target_updates": 8}, "done": false, "episodes_total": 3, "training_iteration": 5, "trial_id": "c28e8_00000", "date": "2023-12-11_10-50-54", "timestamp": 1702320654, "time_this_iter_s": 36.43342041969299, "time_total_s": 152.6374762058258, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 152.6374762058258, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 26.672549019607843, "ram_util_percent": 96.11176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -4566.53564453125, "min_q": -4566.7333984375, "max_q": -4566.2958984375, "mean_td_error": 122.32447814941406, "model": {}}, "td_error": [133.39501953125, 499.98583984375, -498.98828125, 384.44921875, 0.39501953125, 479.3095703125, -416.60498046875, 150.3095703125, 184.39501953125, 62.01171875, -44.60498046875, 377.01171875, -105.98828125, 418.44921875, -224.98828125, -117.60498046875, -85.60498046875, -224.98828125, 499.98583984375, -223.6904296875, 349.01171875, 500.28369140625, 368.39501953125, -371.60498046875, 499.98583984375, 393.01171875, -420.6904296875, 388.01171875, 335.01171875, -113.98828125, 361.01171875, 379.3095703125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 5000.0, "diff_num_grad_updates_vs_sampler_policy": 4999.0}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "last_target_update_ts": 5501, "num_target_updates": 10}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.40151569311327, "num_env_steps_trained_throughput_per_sec": 876.8485021796247, "timesteps_total": 6000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 6000, "timers": {"training_iteration_time_ms": 44.618, "sample_time_ms": 14.24, "load_time_ms": 0.294, "load_throughput": 108828.126, "learn_time_ms": 5.167, "learn_throughput": 6192.911, "synch_weights_time_ms": 3.122}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "last_target_update_ts": 5501, "num_target_updates": 10}, "done": false, "episodes_total": 3, "training_iteration": 6, "trial_id": "c28e8_00000", "date": "2023-12-11_10-51-30", "timestamp": 1702320690, "time_this_iter_s": 36.501333475112915, "time_total_s": 189.13880968093872, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 189.13880968093872, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.752941176470586, "ram_util_percent": 95.97058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -5485.39599609375, "min_q": -5485.74072265625, "max_q": -5484.9267578125, "mean_td_error": 87.62353515625, "model": {}}, "td_error": [509.7177734375, 363.3037109375, 509.7177734375, -440.4326171875, -30.6962890625, -271.24609375, 454.3037109375, -230.6962890625, 215.75390625, -426.4326171875, 424.3037109375, -86.24609375, 509.74365234375, -479.24609375, 509.74365234375, -131.24609375, 459.3037109375, 406.75390625, 10.5673828125, 313.75390625, 386.75390625, -361.4326171875, -269.24609375, -323.4326171875, 504.32958984375, 10.5673828125, 509.74365234375, -336.4326171875, 483.75390625, -124.4326171875, 59.75341796875, -326.69677734375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 6000.0, "diff_num_grad_updates_vs_sampler_policy": 5999.0}}, "num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "last_target_update_ts": 6501, "num_target_updates": 12}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.474876950098327, "num_env_steps_trained_throughput_per_sec": 879.1960624031465, "timesteps_total": 7000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 7000, "timers": {"training_iteration_time_ms": 35.497, "sample_time_ms": 11.747, "load_time_ms": 0.2, "load_throughput": 159649.968, "learn_time_ms": 4.675, "learn_throughput": 6845.119, "synch_weights_time_ms": 3.175}, "counters": {"num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "last_target_update_ts": 6501, "num_target_updates": 12}, "done": false, "episodes_total": 3, "training_iteration": 7, "trial_id": "c28e8_00000", "date": "2023-12-11_10-52-07", "timestamp": 1702320727, "time_this_iter_s": 36.40460562705994, "time_total_s": 225.54341530799866, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 225.54341530799866, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 27.002000000000002, "ram_util_percent": 94.57400000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -6345.1201171875, "min_q": -6345.69775390625, "max_q": -6344.52783203125, "mean_td_error": 114.92652893066406, "model": {}}, "td_error": [389.73974609375, 275.08447265625, -367.26025390625, -492.26025390625, -146.26025390625, 496.91015625, 300.91455078125, 347.73974609375, -174.26025390625, 276.91455078125, 403.91455078125, 496.91015625, 496.89697265625, 287.08447265625, -74.08544921875, -494.91552734375, 167.91455078125, 383.73974609375, 169.08447265625, -433.26025390625, 496.91015625, 496.91015625, 195.73974609375, -62.91552734375, -316.26025390625, -249.26025390625, -1.91552734375, 429.91455078125, 399.08447265625, -115.08544921875, 496.896484375, -402.91552734375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 7000.0, "diff_num_grad_updates_vs_sampler_policy": 6999.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "last_target_update_ts": 7501, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.741143911324407, "num_env_steps_trained_throughput_per_sec": 887.716605162381, "timesteps_total": 8000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 35.914, "sample_time_ms": 12.261, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 5.135, "learn_throughput": 6231.439, "synch_weights_time_ms": 2.999}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "last_target_update_ts": 7501, "num_target_updates": 14}, "done": false, "episodes_total": 3, "training_iteration": 8, "trial_id": "c28e8_00000", "date": "2023-12-11_10-52-43", "timestamp": 1702320763, "time_this_iter_s": 36.05650305747986, "time_total_s": 261.5999183654785, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 261.5999183654785, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 24.845098039215685, "ram_util_percent": 88.3549019607843}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -7162.4267578125, "min_q": -7163.12646484375, "max_q": -7161.673828125, "mean_td_error": 105.94731140136719, "model": {}}, "td_error": [-76.3134765625, -463.29248046875, 392.70751953125, 521.68359375, 321.13232421875, 468.70751953125, 263.70751953125, -154.3134765625, 286.70751953125, -75.86767578125, 521.6767578125, 521.68359375, -326.29248046875, -399.3134765625, 521.6767578125, 424.13916015625, 522.70458984375, 197.70751953125, -43.29248046875, -294.86767578125, 322.70751953125, -470.3134765625, 132.6865234375, -295.3134765625, 369.70751953125, -186.3134765625, 277.13232421875, 521.68359375, -281.29248046875, -220.3134765625, -240.869140625, 330.130859375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 8000.0, "diff_num_grad_updates_vs_sampler_policy": 7999.0}}, "num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "last_target_update_ts": 8501, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.50102695187243, "num_env_steps_trained_throughput_per_sec": 880.0328624599177, "timesteps_total": 9000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 9000, "timers": {"training_iteration_time_ms": 35.651, "sample_time_ms": 12.15, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 4.805, "learn_throughput": 6659.806, "synch_weights_time_ms": 2.993}, "counters": {"num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "last_target_update_ts": 8501, "num_target_updates": 16}, "done": false, "episodes_total": 3, "training_iteration": 9, "trial_id": "c28e8_00000", "date": "2023-12-11_10-53-19", "timestamp": 1702320799, "time_this_iter_s": 36.37125897407532, "time_total_s": 297.97117733955383, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 297.97117733955383, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 25.723529411764712, "ram_util_percent": 89.521568627451}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -7997.994140625, "min_q": -7998.751953125, "max_q": -7997.00927734375, "mean_td_error": 237.51763916015625, "model": {}}, "td_error": [496.30615234375, 311.30859375, 263.10595703125, 496.30615234375, -63.89453125, 495.10009765625, 344.30859375, 483.31201171875, 418.30859375, 444.84814453125, 318.30859375, 401.30859375, -295.15576171875, 473.10595703125, -462.89453125, 495.103515625, -3.15576171875, 495.103515625, -294.69189453125, -253.15576171875, -127.15576171875, -45.69189453125, 462.10595703125, 495.103515625, 394.84814453125, 495.103515625, 448.10595703125, -239.89453125, -79.15576171875, 495.10009765625, 244.10546875, 495.103515625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 9000.0, "diff_num_grad_updates_vs_sampler_policy": 8999.0}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "last_target_update_ts": 9501, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.665176373229766, "num_env_steps_trained_throughput_per_sec": 885.2856439433525, "timesteps_total": 10000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 10000, "timers": {"training_iteration_time_ms": 36.766, "sample_time_ms": 11.966, "load_time_ms": 0.131, "load_throughput": 244788.853, "learn_time_ms": 4.786, "learn_throughput": 6685.881, "synch_weights_time_ms": 2.98}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "last_target_update_ts": 9501, "num_target_updates": 18}, "done": false, "episodes_total": 3, "training_iteration": 10, "trial_id": "c28e8_00000", "date": "2023-12-11_10-53-56", "timestamp": 1702320836, "time_this_iter_s": 36.155537843704224, "time_total_s": 334.12671518325806, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 334.12671518325806, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 25.6, "ram_util_percent": 89.95200000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -8828.216796875, "min_q": -8829.1904296875, "max_q": -8827.1865234375, "mean_td_error": 158.6326904296875, "model": {}}, "td_error": [-201.5126953125, 397.09765625, 443.1015625, 398.09765625, -217.5126953125, 285.4873046875, -444.900390625, -137.5126953125, 492.095703125, 443.4892578125, -473.90234375, 492.095703125, 492.09375, -5.900390625, 492.09375, 399.4873046875, 492.09375, 441.09765625, -303.5126953125, -5.900390625, 293.09765625, 221.099609375, 492.095703125, -105.900390625, 492.09375, 393.1015625, -215.90234375, -263.90234375, -6.5126953125, -61.900390625, 412.1005859375, -50.9013671875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 10000.0, "diff_num_grad_updates_vs_sampler_policy": 9999.0}}, "num_env_steps_sampled": 11000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 320000, "last_target_update_ts": 10501, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 11000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.644494447283353, "num_env_steps_trained_throughput_per_sec": 884.6238223130673, "timesteps_total": 11000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 11000, "timers": {"training_iteration_time_ms": 35.419, "sample_time_ms": 11.727, "load_time_ms": 0.1, "load_throughput": 320023.195, "learn_time_ms": 4.616, "learn_throughput": 6932.555, "synch_weights_time_ms": 2.658}, "counters": {"num_env_steps_sampled": 11000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 320000, "last_target_update_ts": 10501, "num_target_updates": 20}, "done": false, "episodes_total": 3, "training_iteration": 11, "trial_id": "c28e8_00000", "date": "2023-12-11_10-54-32", "timestamp": 1702320872, "time_this_iter_s": 36.18255090713501, "time_total_s": 370.30926609039307, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 370.30926609039307, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.56274509803921, "ram_util_percent": 90.24901960784315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -9650.232421875, "min_q": -9651.61328125, "max_q": -9649.3857421875, "mean_td_error": -268.7476501464844, "model": {}}, "td_error": [290.6142578125, -149.951171875, 0.6142578125, -148.3857421875, 499.0478515625, -106.7255859375, -40.3857421875, -332.3857421875, 289.2744140625, 391.2763671875, -126.951171875, 320.048828125, -109.3857421875, -122.951171875, 457.6142578125, -204.3857421875, -13.3857421875, -9650.0478515625, 0.6142578125, -290.7255859375, -442.7255859375, 1.2744140625, -489.3857421875, 140.048828125, -98.951171875, 448.2763671875, 314.6142578125, -86.951171875, 87.2744140625, 211.6142578125, 1.2744140625, 360.2744140625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 11000.0, "diff_num_grad_updates_vs_sampler_policy": 10999.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 352000, "last_target_update_ts": 11501, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 22.57107522186394, "num_env_steps_trained_throughput_per_sec": 722.274407099646, "timesteps_total": 12000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 32.222, "sample_time_ms": 10.201, "load_time_ms": 0.298, "load_throughput": 107219.786, "learn_time_ms": 4.132, "learn_throughput": 7744.552, "synch_weights_time_ms": 2.586}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 352000, "last_target_update_ts": 11501, "num_target_updates": 22}, "done": false, "episodes_total": 3, "training_iteration": 12, "trial_id": "c28e8_00000", "date": "2023-12-11_10-55-16", "timestamp": 1702320916, "time_this_iter_s": 44.311482429504395, "time_total_s": 414.62074851989746, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 414.62074851989746, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 31.652459016393443, "ram_util_percent": 91.16885245901638}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -10455.744140625, "min_q": -10456.859375, "max_q": -10454.4697265625, "mean_td_error": 17.32720947265625, "model": {}}, "td_error": [-195.533203125, -264.2568359375, -60.2568359375, -323.8671875, 100.466796875, -118.2568359375, -416.533203125, -135.533203125, -92.8671875, 311.466796875, -79.2568359375, 497.7431640625, 497.7431640625, -385.533203125, -300.2568359375, 497.7431640625, 132.1328125, -432.2568359375, 469.466796875, -150.8671875, -186.2568359375, 466.466796875, -253.8671875, 336.466796875, -381.2568359375, -111.2568359375, 206.1328125, 47.7431640625, 153.1328125, 387.466796875, -127.5322265625, 465.744140625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 12000.0, "diff_num_grad_updates_vs_sampler_policy": 11999.0}}, "num_env_steps_sampled": 13000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 384000, "last_target_update_ts": 12501, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 13000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.35307210776614, "num_env_steps_trained_throughput_per_sec": 1003.2983074485164, "timesteps_total": 13000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 13000, "timers": {"training_iteration_time_ms": 31.783, "sample_time_ms": 9.676, "load_time_ms": 0.102, "load_throughput": 313373.168, "learn_time_ms": 4.114, "learn_throughput": 7778.844, "synch_weights_time_ms": 2.543}, "counters": {"num_env_steps_sampled": 13000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 384000, "last_target_update_ts": 12501, "num_target_updates": 24}, "done": false, "episodes_total": 3, "training_iteration": 13, "trial_id": "c28e8_00000", "date": "2023-12-11_10-55-48", "timestamp": 1702320948, "time_this_iter_s": 31.901496171951294, "time_total_s": 446.52224469184875, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 446.52224469184875, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 24.533333333333328, "ram_util_percent": 92.04666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -11255.419921875, "min_q": -11256.611328125, "max_q": -11254.0732421875, "mean_td_error": -11.461944580078125, "model": {}}, "td_error": [352.87890625, -298.2734375, 492.87890625, 417.4169921875, -218.2734375, 453.7265625, -133.12109375, -430.5830078125, -359.5830078125, -157.12109375, -107.2734375, -418.2734375, -497.5830078125, -316.12109375, -163.2734375, -133.12109375, 264.7265625, 492.87890625, 492.87890625, -247.12109375, -137.2734375, -331.2734375, -376.12109375, -85.12109375, -206.5830078125, 492.87890625, -69.5830078125, 494.7265625, -167.2734375, -454.5830078125, 492.8798828125, 492.8798828125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 13000.0, "diff_num_grad_updates_vs_sampler_policy": 12999.0}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 416000, "last_target_update_ts": 13501, "num_target_updates": 26}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 14000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.37496644210307, "num_env_steps_trained_throughput_per_sec": 1003.9989261472982, "timesteps_total": 14000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 14000, "timers": {"training_iteration_time_ms": 30.72, "sample_time_ms": 9.116, "load_time_ms": 0.403, "load_throughput": 79404.678, "learn_time_ms": 4.188, "learn_throughput": 7641.551, "synch_weights_time_ms": 2.064}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 416000, "last_target_update_ts": 13501, "num_target_updates": 26}, "done": false, "episodes_total": 3, "training_iteration": 14, "trial_id": "c28e8_00000", "date": "2023-12-11_10-56-20", "timestamp": 1702320980, "time_this_iter_s": 31.87954092025757, "time_total_s": 478.4017856121063, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 478.4017856121063, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 23.718181818181822, "ram_util_percent": 92.72954545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -12037.353515625, "min_q": -12038.66796875, "max_q": -12035.990234375, "mean_td_error": -305.1850891113281, "model": {}}, "td_error": [99.0859375, 1.0859375, 498.408203125, 498.408203125, -354.5927734375, -154.5927734375, 375.4072265625, 498.408203125, -364.9140625, -47.5927734375, -36.5927734375, 1.0859375, 498.408203125, 498.408203125, 167.408203125, 498.408203125, 1.0859375, -355.5927734375, -132.591796875, 1.0859375, 261.0859375, -339.591796875, -12036.6689453125, -87.591796875, 1.0859375, -494.9140625, -142.591796875, 417.4072265625, 498.408203125, -169.591796875, -157.5927734375, 294.408203125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 14000.0, "diff_num_grad_updates_vs_sampler_policy": 13999.0}}, "num_env_steps_sampled": 15000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 448000, "last_target_update_ts": 14501, "num_target_updates": 28}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 15000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 25.304878915126583, "num_env_steps_trained_throughput_per_sec": 809.7561252840507, "timesteps_total": 15000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 15000, "timers": {"training_iteration_time_ms": 34.158, "sample_time_ms": 10.154, "load_time_ms": 0.1, "load_throughput": 320023.195, "learn_time_ms": 3.993, "learn_throughput": 8014.003, "synch_weights_time_ms": 2.582}, "counters": {"num_env_steps_sampled": 15000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 448000, "last_target_update_ts": 14501, "num_target_updates": 28}, "done": false, "episodes_total": 3, "training_iteration": 15, "trial_id": "c28e8_00000", "date": "2023-12-11_10-57-00", "timestamp": 1702321020, "time_this_iter_s": 39.52672982215881, "time_total_s": 517.9285154342651, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 517.9285154342651, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 37.74285714285715, "ram_util_percent": 93.23035714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -12802.970703125, "min_q": -12804.919921875, "max_q": -12802.1396484375, "mean_td_error": 52.060791015625, "model": {}}, "td_error": [-331.763671875, -265.763671875, 360.0166015625, 186.369140625, 466.236328125, 408.0166015625, 151.0166015625, -128.630859375, -129.630859375, -4.9833984375, -498.763671875, -226.763671875, -4.9833984375, 274.0166015625, 355.0166015625, 396.236328125, 342.369140625, 290.0166015625, 344.0166015625, 491.369140625, -158.9833984375, -40.630859375, 239.0166015625, -347.9833984375, -441.630859375, -60.9833984375, 146.369140625, -5.630859375, -182.763671875, -36.9833984375, -238.6318359375, 321.3681640625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 15000.0, "diff_num_grad_updates_vs_sampler_policy": 14999.0}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 480000, "last_target_update_ts": 15501, "num_target_updates": 30}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.133597760699022, "num_env_steps_trained_throughput_per_sec": 996.2751283423687, "timesteps_total": 16000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 31.23, "sample_time_ms": 9.351, "load_time_ms": 0.1, "load_throughput": 319718.266, "learn_time_ms": 3.833, "learn_throughput": 8349.21, "synch_weights_time_ms": 2.533}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 480000, "last_target_update_ts": 15501, "num_target_updates": 30}, "done": false, "episodes_total": 3, "training_iteration": 16, "trial_id": "c28e8_00000", "date": "2023-12-11_10-57-32", "timestamp": 1702321052, "time_this_iter_s": 32.12647342681885, "time_total_s": 550.054988861084, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 550.054988861084, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 24.447727272727274, "ram_util_percent": 87.29545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -13545.755859375, "min_q": -13547.46484375, "max_q": -13544.580078125, "mean_td_error": 52.47808837890625, "model": {}}, "td_error": [364.154296875, 429.26953125, -181.73046875, -0.845703125, 496.26953125, -336.845703125, -0.845703125, 498.498046875, -201.73046875, 148.498046875, 253.154296875, 390.154296875, -34.845703125, 310.154296875, 496.26953125, -490.501953125, -134.73046875, -482.501953125, -0.845703125, 179.498046875, -444.73046875, -69.845703125, -203.845703125, -358.501953125, 496.26953125, 496.26953125, -0.845703125, 332.26953125, -413.501953125, -30.501953125, 496.26953125, -320.501953125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 16000.0, "diff_num_grad_updates_vs_sampler_policy": 15999.0}}, "num_env_steps_sampled": 17000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 512000, "last_target_update_ts": 16501, "num_target_updates": 32}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 17000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.39517501641467, "num_env_steps_trained_throughput_per_sec": 972.6456005252694, "timesteps_total": 17000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 17000, "timers": {"training_iteration_time_ms": 31.99, "sample_time_ms": 9.847, "load_time_ms": 0.368, "load_throughput": 86962.374, "learn_time_ms": 3.944, "learn_throughput": 8114.0, "synch_weights_time_ms": 2.465}, "counters": {"num_env_steps_sampled": 17000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 512000, "last_target_update_ts": 16501, "num_target_updates": 32}, "done": false, "episodes_total": 3, "training_iteration": 17, "trial_id": "c28e8_00000", "date": "2023-12-11_10-58-05", "timestamp": 1702321085, "time_this_iter_s": 32.905948638916016, "time_total_s": 582.9609375, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 582.9609375, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 25.826086956521745, "ram_util_percent": 91.37608695652175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -14271.9453125, "min_q": -14273.42578125, "max_q": -14270.4267578125, "mean_td_error": -344.92181396484375, "model": {}}, "td_error": [258.0166015625, 280.3564453125, -3.9833984375, -137.982421875, 493.017578125, -4.6435546875, 450.3564453125, 247.017578125, 358.0166015625, 493.017578125, 493.017578125, 476.3564453125, -3.9833984375, 395.017578125, -344.982421875, -3.9833984375, -354.9833984375, -393.982421875, -3.9833984375, -95.982421875, -199.6435546875, -14271.0869140625, -207.982421875, 350.3564453125, -397.6435546875, 493.017578125, 495.3564453125, -405.982421875, -396.9833984375, 287.3564453125, 493.0185546875, 127.0185546875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 17000.0, "diff_num_grad_updates_vs_sampler_policy": 16999.0}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 544000, "last_target_update_ts": 17501, "num_target_updates": 34}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.516916551224583, "num_env_steps_trained_throughput_per_sec": 976.5413296391866, "timesteps_total": 18000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 32.464, "sample_time_ms": 9.695, "load_time_ms": 0.2, "load_throughput": 160030.676, "learn_time_ms": 3.707, "learn_throughput": 8633.308, "synch_weights_time_ms": 2.518}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 544000, "last_target_update_ts": 17501, "num_target_updates": 34}, "done": false, "episodes_total": 3, "training_iteration": 18, "trial_id": "c28e8_00000", "date": "2023-12-11_10-58-37", "timestamp": 1702321117, "time_this_iter_s": 32.77538299560547, "time_total_s": 615.7363204956055, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 615.7363204956055, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 24.763043478260872, "ram_util_percent": 93.1478260869565}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -14980.4033203125, "min_q": -14982.2021484375, "max_q": -14979.1220703125, "mean_td_error": 102.489501953125, "model": {}}, "td_error": [391.7490234375, -382.6044921875, 5.3955078125, -38.2509765625, -126.6845703125, -16.2509765625, -238.2509765625, -45.6845703125, 475.7490234375, 502.3154296875, 5.3955078125, 502.3154296875, -224.6845703125, -73.6044921875, -146.2509765625, 5.3955078125, 5.3955078125, 450.7490234375, 272.7490234375, 385.3955078125, -96.6044921875, 423.3955078125, -401.6044921875, -148.6845703125, 502.3154296875, 261.3154296875, -299.6845703125, 455.7490234375, 502.3154296875, 354.7490234375, 373.3154296875, -357.2509765625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 18000.0, "diff_num_grad_updates_vs_sampler_policy": 17999.0}}, "num_env_steps_sampled": 19000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 576000, "last_target_update_ts": 18501, "num_target_updates": 36}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 19000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.68006053217912, "num_env_steps_trained_throughput_per_sec": 949.7619370297318, "timesteps_total": 19000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 19000, "timers": {"training_iteration_time_ms": 31.318, "sample_time_ms": 9.438, "load_time_ms": 0.201, "load_throughput": 158818.753, "learn_time_ms": 3.369, "learn_throughput": 9497.165, "synch_weights_time_ms": 2.338}, "counters": {"num_env_steps_sampled": 19000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 576000, "last_target_update_ts": 18501, "num_target_updates": 36}, "done": false, "episodes_total": 3, "training_iteration": 19, "trial_id": "c28e8_00000", "date": "2023-12-11_10-59-11", "timestamp": 1702321151, "time_this_iter_s": 33.6996533870697, "time_total_s": 649.4359738826752, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 649.4359738826752, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 26.185106382978724, "ram_util_percent": 92.85531914893615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -15676.490234375, "min_q": -15678.376953125, "max_q": -15675.2099609375, "mean_td_error": 158.32537841796875, "model": {}}, "td_error": [-157.24609375, 437.2509765625, 309.75390625, -420.7490234375, 505.2509765625, 383.75390625, 192.75390625, -264.24609375, -38.7490234375, 505.2509765625, 8.41796875, 100.41796875, -396.58203125, 212.75390625, 309.75390625, 174.2509765625, -257.58203125, 486.75390625, 505.2509765625, 505.2509765625, 371.75390625, 319.41796875, -339.24609375, 432.75390625, -110.58203125, 269.41796875, 248.2509765625, -463.58203125, 429.75390625, -156.24609375, 505.2529296875, 457.755859375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 19000.0, "diff_num_grad_updates_vs_sampler_policy": 18999.0}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 608000, "last_target_update_ts": 19501, "num_target_updates": 38}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.406379602062987, "num_env_steps_trained_throughput_per_sec": 1005.0041472660156, "timesteps_total": 20000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 31.741, "sample_time_ms": 9.374, "load_time_ms": 0.1, "load_throughput": 319870.658, "learn_time_ms": 3.738, "learn_throughput": 8560.514, "synch_weights_time_ms": 2.452}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 608000, "last_target_update_ts": 19501, "num_target_updates": 38}, "done": false, "episodes_total": 3, "training_iteration": 20, "trial_id": "c28e8_00000", "date": "2023-12-11_10-59-43", "timestamp": 1702321183, "time_this_iter_s": 31.848673820495605, "time_total_s": 681.2846477031708, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 681.2846477031708, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 23.340000000000003, "ram_util_percent": 91.27555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -16369.01953125, "min_q": -16370.939453125, "max_q": -16367.6953125, "mean_td_error": -480.96142578125, "model": {}}, "td_error": [3.0419921875, -434.9580078125, -16368.365234375, -278.2021484375, 499.798828125, 247.373046875, -125.9580078125, -464.9580078125, 446.373046875, 332.04296875, 134.04296875, -36.6279296875, 227.798828125, -163.2021484375, -400.2021484375, -395.9580078125, 366.373046875, 502.373046875, -138.2021484375, -93.6279296875, 499.798828125, 3.0419921875, -178.6279296875, -154.6279296875, 499.798828125, -209.9580078125, -131.2021484375, -468.9580078125, 3.0419921875, -114.2021484375, 499.798828125, 502.373046875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 20000.0, "diff_num_grad_updates_vs_sampler_policy": 19999.0}}, "num_env_steps_sampled": 21000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 640000, "last_target_update_ts": 20501, "num_target_updates": 40}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 21000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.864120220354142, "num_env_steps_trained_throughput_per_sec": 987.6518470513325, "timesteps_total": 21000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 21000, "timers": {"training_iteration_time_ms": 31.546, "sample_time_ms": 9.667, "load_time_ms": 0.1, "load_throughput": 320099.518, "learn_time_ms": 3.853, "learn_throughput": 8305.552, "synch_weights_time_ms": 2.231}, "counters": {"num_env_steps_sampled": 21000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 640000, "last_target_update_ts": 20501, "num_target_updates": 40}, "done": false, "episodes_total": 3, "training_iteration": 21, "trial_id": "c28e8_00000", "date": "2023-12-11_11-00-16", "timestamp": 1702321216, "time_this_iter_s": 32.40707588195801, "time_total_s": 713.6917235851288, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 713.6917235851288, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.32444444444445, "ram_util_percent": 91.65777777777781}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -17034.6875, "min_q": -17036.689453125, "max_q": -17033.40234375, "mean_td_error": 73.67755126953125, "model": {}}, "td_error": [441.517578125, -81.138671875, 232.1484375, 498.861328125, 432.861328125, 412.517578125, -435.138671875, 501.517578125, 2.1484375, -349.482421875, 2.1484375, -242.482421875, 449.517578125, 134.517578125, -257.8515625, 417.517578125, 461.861328125, 498.861328125, 138.1484375, 501.517578125, -210.482421875, -317.138671875, 2.1484375, -290.138671875, -487.482421875, 262.1484375, -155.8515625, -427.482421875, 320.517578125, -244.138671875, 452.86328125, -306.849609375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 21000.0, "diff_num_grad_updates_vs_sampler_policy": 20999.0}}, "num_env_steps_sampled": 22000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 672000, "last_target_update_ts": 21501, "num_target_updates": 42}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 22000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.735488365367786, "num_env_steps_trained_throughput_per_sec": 1015.5356276917692, "timesteps_total": 22000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 22000, "timers": {"training_iteration_time_ms": 31.525, "sample_time_ms": 9.753, "load_time_ms": 0.299, "load_throughput": 107006.081, "learn_time_ms": 3.927, "learn_throughput": 8148.532, "synch_weights_time_ms": 2.375}, "counters": {"num_env_steps_sampled": 22000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 672000, "last_target_update_ts": 21501, "num_target_updates": 42}, "done": false, "episodes_total": 3, "training_iteration": 22, "trial_id": "c28e8_00000", "date": "2023-12-11_11-00-47", "timestamp": 1702321247, "time_this_iter_s": 31.516194343566895, "time_total_s": 745.2079179286957, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 745.2079179286957, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 23.454545454545453, "ram_util_percent": 91.1909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -17707.48046875, "min_q": -17709.703125, "max_q": -17706.3359375, "mean_td_error": 98.31732177734375, "model": {}}, "td_error": [-1.7890625, 260.580078125, -1.7890625, -1.7890625, -418.154296875, -348.419921875, -1.7890625, -236.154296875, 494.845703125, 473.845703125, 290.845703125, 223.2109375, 494.845703125, 449.845703125, 234.580078125, 428.845703125, 401.580078125, 454.580078125, -494.7890625, -1.7890625, -408.419921875, 486.580078125, -374.419921875, -400.7890625, 437.580078125, -1.7890625, -91.154296875, 143.580078125, -106.7890625, -1.7890625, 365.2109375, 397.2109375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 22000.0, "diff_num_grad_updates_vs_sampler_policy": 21999.0}}, "num_env_steps_sampled": 23000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 704000, "last_target_update_ts": 22501, "num_target_updates": 44}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 23000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.781146491998793, "num_env_steps_trained_throughput_per_sec": 984.9966877439614, "timesteps_total": 23000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 23000, "timers": {"training_iteration_time_ms": 35.492, "sample_time_ms": 10.576, "load_time_ms": 0.246, "load_throughput": 130081.148, "learn_time_ms": 3.993, "learn_throughput": 8014.53, "synch_weights_time_ms": 2.499}, "counters": {"num_env_steps_sampled": 23000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 704000, "last_target_update_ts": 22501, "num_target_updates": 44}, "done": false, "episodes_total": 3, "training_iteration": 23, "trial_id": "c28e8_00000", "date": "2023-12-11_11-01-20", "timestamp": 1702321280, "time_this_iter_s": 32.4944212436676, "time_total_s": 777.7023391723633, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 777.7023391723633, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 24.48913043478261, "ram_util_percent": 91.46739130434783}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -18339.5390625, "min_q": -18341.482421875, "max_q": -18338.06640625, "mean_td_error": 110.98583984375, "model": {}}, "td_error": [0.990234375, 345.990234375, 285.990234375, -45.625, -117.42578125, -113.009765625, -268.42578125, 396.375, -150.009765625, -250.42578125, 478.57421875, -348.625, 500.375, 445.375, 327.990234375, 497.57421875, -350.42578125, 67.57421875, 334.990234375, -232.625, 497.57421875, -97.42578125, 403.57421875, 282.57421875, -464.42578125, 0.990234375, 181.375, 500.375, 404.375, -342.625, 378.9921875, 0.9921875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 23000.0, "diff_num_grad_updates_vs_sampler_policy": 22999.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 736000, "last_target_update_ts": 23501, "num_target_updates": 46}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.43267960621469, "num_env_steps_trained_throughput_per_sec": 1005.8457473988701, "timesteps_total": 24000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 31.424, "sample_time_ms": 9.121, "load_time_ms": 0.326, "load_throughput": 98055.032, "learn_time_ms": 4.275, "learn_throughput": 7484.858, "synch_weights_time_ms": 2.322}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 736000, "last_target_update_ts": 23501, "num_target_updates": 46}, "done": false, "episodes_total": 3, "training_iteration": 24, "trial_id": "c28e8_00000", "date": "2023-12-11_11-01-51", "timestamp": 1702321311, "time_this_iter_s": 31.820037364959717, "time_total_s": 809.522376537323, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 809.522376537323, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 23.502272727272725, "ram_util_percent": 92.0409090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -18961.26171875, "min_q": -18963.1328125, "max_q": -18959.666015625, "mean_td_error": 80.77337646484375, "model": {}}, "td_error": [317.15234375, 427.619140625, 12.619140625, 161.01953125, 12.619140625, -195.84765625, -64.84765625, 12.619140625, 12.619140625, -383.380859375, -31.98046875, -149.84765625, 493.01953125, -167.98046875, 287.01953125, 490.15234375, -256.84765625, 512.01953125, 509.15234375, 317.15234375, 12.619140625, -359.84765625, -51.84765625, -63.84765625, -54.84765625, 388.01953125, 343.01953125, 12.619140625, 411.15234375, -76.380859375, -199.98046875, -89.98046875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 24000.0, "diff_num_grad_updates_vs_sampler_policy": 23999.0}}, "num_env_steps_sampled": 25000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 768000, "last_target_update_ts": 24501, "num_target_updates": 48}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 25000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.663209953465994, "num_env_steps_trained_throughput_per_sec": 981.2227185109118, "timesteps_total": 25000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 25000, "timers": {"training_iteration_time_ms": 31.124, "sample_time_ms": 9.711, "load_time_ms": 0.177, "load_throughput": 180740.275, "learn_time_ms": 4.149, "learn_throughput": 7712.2, "synch_weights_time_ms": 2.098}, "counters": {"num_env_steps_sampled": 25000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 768000, "last_target_update_ts": 24501, "num_target_updates": 48}, "done": false, "episodes_total": 3, "training_iteration": 25, "trial_id": "c28e8_00000", "date": "2023-12-11_11-02-24", "timestamp": 1702321344, "time_this_iter_s": 32.6181104183197, "time_total_s": 842.1404869556427, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 842.1404869556427, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 26.043478260869573, "ram_util_percent": 90.93478260869563}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -19583.12109375, "min_q": -19584.9296875, "max_q": -19581.453125, "mean_td_error": -458.92803955078125, "model": {}}, "td_error": [494.365234375, -2.158203125, 494.365234375, 274.841796875, 345.2578125, 181.841796875, -442.634765625, 58.2578125, -409.634765625, -19581.453125, 494.365234375, -96.7421875, -297.7421875, 494.365234375, -2.158203125, 494.365234375, -404.158203125, 385.841796875, 456.365234375, 497.2578125, 411.2578125, -276.158203125, -234.634765625, -2.158203125, 262.365234375, 271.2578125, -84.634765625, 454.365234375, 494.365234375, 446.2578125, 494.3671875, -357.15625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 25000.0, "diff_num_grad_updates_vs_sampler_policy": 24999.0}}, "num_env_steps_sampled": 26000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 800000, "last_target_update_ts": 25501, "num_target_updates": 50}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 26000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.664615309678556, "num_env_steps_trained_throughput_per_sec": 1013.2676899097138, "timesteps_total": 26000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 26000, "timers": {"training_iteration_time_ms": 32.647, "sample_time_ms": 9.606, "load_time_ms": 0.201, "load_throughput": 159422.411, "learn_time_ms": 4.24, "learn_throughput": 7547.827, "synch_weights_time_ms": 2.377}, "counters": {"num_env_steps_sampled": 26000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 800000, "last_target_update_ts": 25501, "num_target_updates": 50}, "done": false, "episodes_total": 3, "training_iteration": 26, "trial_id": "c28e8_00000", "date": "2023-12-11_11-02-56", "timestamp": 1702321376, "time_this_iter_s": 31.5879807472229, "time_total_s": 873.7284677028656, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 873.7284677028656, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 23.102272727272727, "ram_util_percent": 90.86363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -20188.65625, "min_q": -20190.498046875, "max_q": -20187.00390625, "mean_td_error": 91.20245361328125, "model": {}}, "td_error": [496.173828125, -126.826171875, -0.33203125, -0.33203125, -0.33203125, 499.099609375, 284.099609375, -0.33203125, 496.173828125, -0.33203125, -440.33203125, -345.33203125, 252.66796875, 302.099609375, 496.173828125, 252.66796875, 496.173828125, -429.826171875, -379.900390625, 30.099609375, 208.173828125, 492.099609375, -115.826171875, 496.173828125, 362.173828125, -102.826171875, 431.173828125, -497.900390625, -90.826171875, -299.33203125, 496.173828125, -342.33203125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 26000.0, "diff_num_grad_updates_vs_sampler_policy": 25999.0}}, "num_env_steps_sampled": 27000, "num_env_steps_trained": 832000, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 832000, "last_target_update_ts": 26501, "num_target_updates": 52}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 27000, "num_env_steps_trained": 832000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.91827939375344, "num_env_steps_trained_throughput_per_sec": 989.3849406001101, "timesteps_total": 27000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 27000, "timers": {"training_iteration_time_ms": 33.3, "sample_time_ms": 10.212, "load_time_ms": 0.197, "load_throughput": 162353.608, "learn_time_ms": 3.874, "learn_throughput": 8260.213, "synch_weights_time_ms": 2.435}, "counters": {"num_env_steps_sampled": 27000, "num_env_steps_trained": 832000, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 832000, "last_target_update_ts": 26501, "num_target_updates": 52}, "done": false, "episodes_total": 3, "training_iteration": 27, "trial_id": "c28e8_00000", "date": "2023-12-11_11-03-28", "timestamp": 1702321408, "time_this_iter_s": 32.350162744522095, "time_total_s": 906.0786304473877, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 906.0786304473877, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 24.69555555555556, "ram_util_percent": 91.0911111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -20782.6484375, "min_q": -20784.513671875, "max_q": -20781.013671875, "mean_td_error": 93.593994140625, "model": {}}, "td_error": [493.947265625, -136.103515625, -26.103515625, -2.552734375, -2.552734375, -134.552734375, -2.552734375, 493.947265625, -2.552734375, -166.052734375, -500.052734375, -222.052734375, 436.447265625, 317.896484375, -148.552734375, 493.947265625, 493.947265625, 14.947265625, 275.896484375, 292.447265625, -2.552734375, -292.052734375, -2.552734375, 427.896484375, 276.896484375, -239.052734375, 493.947265625, 486.947265625, -68.052734375, -2.552734375, -248.052734375, 194.447265625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 27000.0, "diff_num_grad_updates_vs_sampler_policy": 26999.0}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 864000, "last_target_update_ts": 27501, "num_target_updates": 54}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.719173799157073, "num_env_steps_trained_throughput_per_sec": 1015.0135615730263, "timesteps_total": 28000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 31.536, "sample_time_ms": 9.582, "load_time_ms": 0.202, "load_throughput": 158145.078, "learn_time_ms": 3.73, "learn_throughput": 8580.05, "synch_weights_time_ms": 2.388}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 864000, "last_target_update_ts": 27501, "num_target_updates": 54}, "done": false, "episodes_total": 3, "training_iteration": 28, "trial_id": "c28e8_00000", "date": "2023-12-11_11-04-00", "timestamp": 1702321440, "time_this_iter_s": 31.532671451568604, "time_total_s": 937.6113018989563, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 937.6113018989563, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 23.254545454545454, "ram_util_percent": 90.14772727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -21363.67578125, "min_q": -21365.37109375, "max_q": -21361.861328125, "mean_td_error": 80.36993408203125, "model": {}}, "td_error": [496.548828125, 496.548828125, 0.05859375, 486.548828125, -404.94140625, 199.548828125, -289.451171875, 0.05859375, 299.51953125, 496.548828125, 454.51953125, -316.451171875, 416.548828125, -451.48046875, -481.94140625, -353.48046875, -492.94140625, 410.51953125, 239.548828125, 496.548828125, 499.51953125, -207.48046875, 0.05859375, 351.51953125, 89.51953125, -233.48046875, 496.548828125, 496.548828125, -218.451171875, -122.451171875, 0.05859375, -282.451171875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 28000.0, "diff_num_grad_updates_vs_sampler_policy": 27999.0}}, "num_env_steps_sampled": 29000, "num_env_steps_trained": 896000, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 896000, "last_target_update_ts": 28501, "num_target_updates": 56}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 29000, "num_env_steps_trained": 896000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.019608669727432, "num_env_steps_trained_throughput_per_sec": 960.6274774312778, "timesteps_total": 29000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 29000, "timers": {"training_iteration_time_ms": 33.825, "sample_time_ms": 10.554, "load_time_ms": 0.348, "load_throughput": 91980.351, "learn_time_ms": 3.555, "learn_throughput": 9002.524, "synch_weights_time_ms": 2.252}, "counters": {"num_env_steps_sampled": 29000, "num_env_steps_trained": 896000, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 896000, "last_target_update_ts": 28501, "num_target_updates": 56}, "done": false, "episodes_total": 3, "training_iteration": 29, "trial_id": "c28e8_00000", "date": "2023-12-11_11-04-33", "timestamp": 1702321473, "time_this_iter_s": 33.319279193878174, "time_total_s": 970.9305810928345, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 970.9305810928345, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 25.55744680851064, "ram_util_percent": 90.16382978723406}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -21931.59765625, "min_q": -21933.68359375, "max_q": -21930.166015625, "mean_td_error": -608.6113891601562, "model": {}}, "td_error": [-349.78515625, 495.205078125, 139.21484375, 363.21484375, -416.78515625, -152.78515625, 195.205078125, 386.21484375, 481.21484375, -150.78515625, -135.794921875, -153.794921875, -250.794921875, 275.205078125, -179.78515625, 231.21484375, 429.205078125, -123.794921875, 445.21484375, -123.794921875, -82.794921875, 300.21484375, 342.205078125, -1.27734375, 294.72265625, 416.72265625, 482.21484375, -1.27734375, -406.78515625, -291.27734375, -21930.166015625, -1.275390625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 29000.0, "diff_num_grad_updates_vs_sampler_policy": 28999.0}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 928000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 928000, "last_target_update_ts": 29501, "num_target_updates": 58}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 30000, "num_env_steps_trained": 928000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.926496048003408, "num_env_steps_trained_throughput_per_sec": 989.647873536109, "timesteps_total": 30000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 31.46, "sample_time_ms": 9.509, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 4.186, "learn_throughput": 7644.206, "synch_weights_time_ms": 2.294}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 928000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 928000, "last_target_update_ts": 29501, "num_target_updates": 58}, "done": false, "episodes_total": 3, "training_iteration": 30, "trial_id": "c28e8_00000", "date": "2023-12-11_11-05-05", "timestamp": 1702321505, "time_this_iter_s": 32.340736627578735, "time_total_s": 1003.2713177204132, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1003.2713177204132, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 23.026666666666664, "ram_util_percent": 91.17777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -22465.98828125, "min_q": -22467.857421875, "max_q": -22464.322265625, "mean_td_error": 156.843017578125, "model": {}}, "td_error": [521.69140625, 22.1640625, 22.1640625, 22.1640625, -130.37109375, 377.69140625, -356.37109375, 375.1640625, -141.37109375, -174.30859375, 518.62890625, -203.30859375, -215.37109375, 518.62890625, 22.1640625, 417.69140625, 22.1640625, 435.1640625, 518.62890625, 518.62890625, 22.1640625, -54.37109375, 514.69140625, 221.62890625, 358.1640625, 325.62890625, 442.69140625, 518.62890625, -473.30859375, 436.62890625, 22.1640625, -407.37109375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 30000.0, "diff_num_grad_updates_vs_sampler_policy": 29999.0}}, "num_env_steps_sampled": 31000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 960000, "last_target_update_ts": 30501, "num_target_updates": 60}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 31000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.933420512941012, "num_env_steps_trained_throughput_per_sec": 989.8694564141124, "timesteps_total": 31000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 31000, "timers": {"training_iteration_time_ms": 32.805, "sample_time_ms": 9.537, "load_time_ms": 0.201, "load_throughput": 159082.29, "learn_time_ms": 4.216, "learn_throughput": 7590.856, "synch_weights_time_ms": 2.314}, "counters": {"num_env_steps_sampled": 31000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 960000, "last_target_update_ts": 30501, "num_target_updates": 60}, "done": false, "episodes_total": 3, "training_iteration": 31, "trial_id": "c28e8_00000", "date": "2023-12-11_11-05-38", "timestamp": 1702321538, "time_this_iter_s": 32.333481550216675, "time_total_s": 1035.6047992706299, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1035.6047992706299, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 24.593333333333334, "ram_util_percent": 90.95555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -23021.779296875, "min_q": -23023.97265625, "max_q": -23020.421875, "mean_td_error": 23.364013671875, "model": {}}, "td_error": [505.12890625, -395.435546875, -471.87109375, -454.435546875, -400.986328125, -55.435546875, 5.564453125, -86.986328125, 146.12890625, -89.986328125, -132.87109375, -451.435546875, 488.013671875, 5.564453125, 502.013671875, 253.12890625, 502.013671875, 502.013671875, 452.564453125, 147.564453125, -314.986328125, -309.435546875, -181.986328125, 502.013671875, 5.564453125, -19.87109375, -397.87109375, 5.564453125, 20.12890625, -226.986328125, 190.12890625, 505.12890625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 31000.0, "diff_num_grad_updates_vs_sampler_policy": 30999.0}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 992000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 992000, "last_target_update_ts": 31501, "num_target_updates": 62}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 992000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.41994658865026, "num_env_steps_trained_throughput_per_sec": 973.4382908368083, "timesteps_total": 32000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 31.797, "sample_time_ms": 9.366, "load_time_ms": 0.199, "load_throughput": 160528.32, "learn_time_ms": 3.904, "learn_throughput": 8196.903, "synch_weights_time_ms": 2.43}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 992000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 992000, "last_target_update_ts": 31501, "num_target_updates": 62}, "done": false, "episodes_total": 3, "training_iteration": 32, "trial_id": "c28e8_00000", "date": "2023-12-11_11-06-11", "timestamp": 1702321571, "time_this_iter_s": 32.879852056503296, "time_total_s": 1068.4846513271332, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1068.4846513271332, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 25.713043478260865, "ram_util_percent": 91.0608695652174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -23555.77734375, "min_q": -23558.26953125, "max_q": -23554.6953125, "mean_td_error": 149.2440185546875, "model": {}}, "td_error": [469.455078125, 419.455078125, -301.142578125, 502.455078125, 499.283203125, 499.283203125, -0.544921875, 420.455078125, 2.857421875, 499.283203125, -489.716796875, -380.716796875, 344.455078125, 456.455078125, 440.283203125, 2.857421875, -427.544921875, 397.283203125, -49.544921875, 447.455078125, 453.455078125, -316.544921875, 2.857421875, -374.544921875, 499.283203125, 2.857421875, 2.857421875, 2.857421875, -132.142578125, -113.142578125, 493.455078125, 502.455078125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 32000.0, "diff_num_grad_updates_vs_sampler_policy": 31999.0}}, "num_env_steps_sampled": 33000, "num_env_steps_trained": 1024000, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 1024000, "last_target_update_ts": 32501, "num_target_updates": 64}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 33000, "num_env_steps_trained": 1024000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.97409236720606, "num_env_steps_trained_throughput_per_sec": 991.170955750594, "timesteps_total": 33000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 33000, "timers": {"training_iteration_time_ms": 40.572, "sample_time_ms": 11.999, "load_time_ms": 0.199, "load_throughput": 160489.929, "learn_time_ms": 4.273, "learn_throughput": 7489.703, "synch_weights_time_ms": 3.104}, "counters": {"num_env_steps_sampled": 33000, "num_env_steps_trained": 1024000, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 1024000, "last_target_update_ts": 32501, "num_target_updates": 64}, "done": false, "episodes_total": 3, "training_iteration": 33, "trial_id": "c28e8_00000", "date": "2023-12-11_11-06-43", "timestamp": 1702321603, "time_this_iter_s": 32.29165720939636, "time_total_s": 1100.7763085365295, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1100.7763085365295, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 24.44888888888889, "ram_util_percent": 91.07777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -24069.21484375, "min_q": -24071.55859375, "max_q": -24067.97265625, "mean_td_error": -1347.3956298828125, "model": {}}, "td_error": [4.03515625, 500.44921875, -243.3203125, 459.6796875, 335.44921875, -24067.97265625, 282.6796875, -268.96484375, 4.03515625, -88.3203125, 454.6796875, 470.6796875, 500.44921875, 500.44921875, 169.03515625, -24068.328125, 4.03515625, 500.44921875, -133.55078125, 4.03515625, 136.03515625, 4.03515625, 397.6796875, -193.96484375, -495.3203125, 376.6796875, 503.6796875, 500.44921875, -310.55078125, 379.03515625, -234.55078125, 500.44921875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 33000.0, "diff_num_grad_updates_vs_sampler_policy": 32999.0}}, "num_env_steps_sampled": 34000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 1056000, "last_target_update_ts": 33501, "num_target_updates": 66}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 34000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.793494125136718, "num_env_steps_trained_throughput_per_sec": 953.391812004375, "timesteps_total": 34000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 34000, "timers": {"training_iteration_time_ms": 33.047, "sample_time_ms": 10.318, "load_time_ms": 0.281, "load_throughput": 113830.657, "learn_time_ms": 3.766, "learn_throughput": 8497.321, "synch_weights_time_ms": 2.305}, "counters": {"num_env_steps_sampled": 34000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 1056000, "last_target_update_ts": 33501, "num_target_updates": 66}, "done": false, "episodes_total": 3, "training_iteration": 34, "trial_id": "c28e8_00000", "date": "2023-12-11_11-07-17", "timestamp": 1702321637, "time_this_iter_s": 33.571316719055176, "time_total_s": 1134.3476252555847, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1134.3476252555847, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 26.546808510638293, "ram_util_percent": 90.94255319148938}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -24585.41015625, "min_q": -24587.458984375, "max_q": -24583.853515625, "mean_td_error": 108.89251708984375, "model": {}}, "td_error": [-94.0625, 499.9375, 356.216796875, 3.54296875, 499.9375, 499.9375, 391.9375, 149.216796875, -408.0625, 499.9375, -139.783203125, -213.0625, 378.54296875, 499.9375, 301.216796875, -128.0625, 273.9375, 258.216796875, 3.54296875, 3.54296875, -158.783203125, -467.0625, -224.45703125, 3.54296875, 272.54296875, 3.54296875, -202.783203125, 499.9375, 252.216796875, -123.783203125, 3.5390625, -10.4609375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 34000.0, "diff_num_grad_updates_vs_sampler_policy": 33999.0}}, "num_env_steps_sampled": 35000, "num_env_steps_trained": 1088000, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 1088000, "last_target_update_ts": 34501, "num_target_updates": 68}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 35000, "num_env_steps_trained": 1088000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.05792309350866, "num_env_steps_trained_throughput_per_sec": 993.8535389922771, "timesteps_total": 35000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 35000, "timers": {"training_iteration_time_ms": 31.624, "sample_time_ms": 8.982, "load_time_ms": 0.158, "load_throughput": 202165.579, "learn_time_ms": 4.2, "learn_throughput": 7619.167, "synch_weights_time_ms": 2.178}, "counters": {"num_env_steps_sampled": 35000, "num_env_steps_trained": 1088000, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 1088000, "last_target_update_ts": 34501, "num_target_updates": 68}, "done": false, "episodes_total": 3, "training_iteration": 35, "trial_id": "c28e8_00000", "date": "2023-12-11_11-07-49", "timestamp": 1702321669, "time_this_iter_s": 32.20365810394287, "time_total_s": 1166.5512833595276, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1166.5512833595276, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 23.38666666666667, "ram_util_percent": 89.58666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -25082.4375, "min_q": -25084.4921875, "max_q": -25080.896484375, "mean_td_error": -26.43408203125, "model": {}}, "td_error": [-176.830078125, -15.1171875, 124.8828125, -442.830078125, 402.169921875, 331.57421875, 6.169921875, 6.169921875, 502.57421875, -233.830078125, -225.1171875, 6.169921875, 502.57421875, 502.57421875, 438.8828125, -180.42578125, 6.169921875, -484.1171875, -272.42578125, -29.1171875, 468.57421875, -470.42578125, 6.169921875, -478.830078125, -364.42578125, -147.1171875, -468.42578125, -405.42578125, 301.8828125, -120.42578125, -118.42578125, 180.8828125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 35000.0, "diff_num_grad_updates_vs_sampler_policy": 34999.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 1120000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 1120000, "last_target_update_ts": 35501, "num_target_updates": 70}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 1120000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.98877351607947, "num_env_steps_trained_throughput_per_sec": 991.640752514543, "timesteps_total": 36000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 31.805, "sample_time_ms": 9.382, "load_time_ms": 0.199, "load_throughput": 160913.233, "learn_time_ms": 3.697, "learn_throughput": 8655.411, "synch_weights_time_ms": 2.443}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 1120000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 1120000, "last_target_update_ts": 35501, "num_target_updates": 70}, "done": false, "episodes_total": 3, "training_iteration": 36, "trial_id": "c28e8_00000", "date": "2023-12-11_11-08-21", "timestamp": 1702321701, "time_this_iter_s": 32.275755405426025, "time_total_s": 1198.8270387649536, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1198.8270387649536, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 24.813333333333336, "ram_util_percent": 89.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -25592.177734375, "min_q": -25594.45703125, "max_q": -25590.87890625, "mean_td_error": 117.8592529296875, "model": {}}, "td_error": [206.830078125, -472.833984375, 489.830078125, -6.59375, -6.59375, 463.166015625, 489.830078125, -6.59375, -6.59375, -198.833984375, -6.59375, -357.169921875, -100.833984375, 489.830078125, -320.59375, 263.166015625, -6.59375, -6.59375, -321.169921875, 476.830078125, -6.59375, 163.166015625, -6.59375, 489.830078125, -88.169921875, 489.830078125, 341.166015625, 493.166015625, -6.59375, -6.59375, 357.1640625, 489.828125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 36000.0, "diff_num_grad_updates_vs_sampler_policy": 35999.0}}, "num_env_steps_sampled": 37000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 1152000, "last_target_update_ts": 36501, "num_target_updates": 72}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 37000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.544429767645937, "num_env_steps_trained_throughput_per_sec": 1009.42175256467, "timesteps_total": 37000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 37000, "timers": {"training_iteration_time_ms": 30.735, "sample_time_ms": 9.308, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3.899, "learn_throughput": 8206.777, "synch_weights_time_ms": 2.369}, "counters": {"num_env_steps_sampled": 37000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 1152000, "last_target_update_ts": 36501, "num_target_updates": 72}, "done": false, "episodes_total": 3, "training_iteration": 37, "trial_id": "c28e8_00000", "date": "2023-12-11_11-08-53", "timestamp": 1702321733, "time_this_iter_s": 31.707300662994385, "time_total_s": 1230.534339427948, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1230.534339427948, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 23.66590909090909, "ram_util_percent": 90.02727272727275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -26059.87109375, "min_q": -26062.17578125, "max_q": -26058.591796875, "mean_td_error": 11.07135009765625, "model": {}}, "td_error": [-323.32421875, -136.32421875, 7.259765625, 486.05859375, 7.259765625, -235.94140625, 148.05859375, -100.740234375, 7.259765625, -449.740234375, 328.259765625, 503.67578125, -459.740234375, -436.740234375, 503.67578125, 7.259765625, -37.94140625, -164.32421875, -28.740234375, -231.94140625, 503.67578125, 503.67578125, 7.259765625, -368.94140625, 358.67578125, 7.259765625, -439.94140625, -271.32421875, -442.740234375, 503.67578125, 423.677734375, 176.060546875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 37000.0, "diff_num_grad_updates_vs_sampler_policy": 36999.0}}, "num_env_steps_sampled": 38000, "num_env_steps_trained": 1184000, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 1184000, "last_target_update_ts": 37501, "num_target_updates": 74}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 38000, "num_env_steps_trained": 1184000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.058952045906455, "num_env_steps_trained_throughput_per_sec": 993.8864654690066, "timesteps_total": 38000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 38000, "timers": {"training_iteration_time_ms": 32.123, "sample_time_ms": 9.32, "load_time_ms": 0.327, "load_throughput": 97840.595, "learn_time_ms": 3.631, "learn_throughput": 8812.778, "synch_weights_time_ms": 2.441}, "counters": {"num_env_steps_sampled": 38000, "num_env_steps_trained": 1184000, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 1184000, "last_target_update_ts": 37501, "num_target_updates": 74}, "done": false, "episodes_total": 3, "training_iteration": 38, "trial_id": "c28e8_00000", "date": "2023-12-11_11-09-25", "timestamp": 1702321765, "time_this_iter_s": 32.2028374671936, "time_total_s": 1262.7371768951416, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1262.7371768951416, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 23.520000000000003, "ram_util_percent": 90.21555555555554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -26540.875, "min_q": -26543.673828125, "max_q": -26540.11328125, "mean_td_error": 130.21710205078125, "model": {}}, "td_error": [-90.95703125, 243.603515625, 1.603515625, 492.4453125, 1.603515625, 499.4453125, 241.04296875, 126.4453125, 1.603515625, 182.4453125, 453.4453125, -159.396484375, 303.4453125, 1.603515625, -416.5546875, 498.4453125, 358.4453125, -206.5546875, 1.603515625, 201.4453125, -341.5546875, -480.95703125, -426.5546875, 498.04296875, 482.4453125, 126.4453125, 377.4453125, 189.4453125, 498.04296875, 439.4453125, -365.552734375, 435.044921875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 38000.0, "diff_num_grad_updates_vs_sampler_policy": 37999.0}}, "num_env_steps_sampled": 39000, "num_env_steps_trained": 1216000, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 1216000, "last_target_update_ts": 38501, "num_target_updates": 76}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 39000, "num_env_steps_trained": 1216000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.989829718425565, "num_env_steps_trained_throughput_per_sec": 991.6745509896181, "timesteps_total": 39000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 39000, "timers": {"training_iteration_time_ms": 37.787, "sample_time_ms": 11.939, "load_time_ms": 0.202, "load_throughput": 158425.08, "learn_time_ms": 4.355, "learn_throughput": 7347.914, "synch_weights_time_ms": 2.864}, "counters": {"num_env_steps_sampled": 39000, "num_env_steps_trained": 1216000, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 1216000, "last_target_update_ts": 38501, "num_target_updates": 76}, "done": false, "episodes_total": 3, "training_iteration": 39, "trial_id": "c28e8_00000", "date": "2023-12-11_11-09-58", "timestamp": 1702321798, "time_this_iter_s": 32.277669191360474, "time_total_s": 1295.014846086502, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1295.014846086502, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 23.30222222222222, "ram_util_percent": 90.19555555555554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -27006.6796875, "min_q": -27009.0703125, "max_q": -27005.5390625, "mean_td_error": 50.0982666015625, "model": {}}, "td_error": [-192.103515625, 388.79296875, 0.896484375, -400.20703125, -256.20703125, 0.896484375, -142.20703125, -396.20703125, 0.896484375, 418.79296875, 497.3671875, 0.896484375, 419.79296875, 497.3671875, 208.896484375, 0.896484375, 0.896484375, 497.3671875, -188.6328125, 497.3671875, -474.20703125, -233.6328125, -88.6328125, -33.103515625, -285.20703125, 367.3671875, 158.79296875, 500.79296875, 484.79296875, -431.6328125, -218.63671875, 0.892578125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 39000.0, "diff_num_grad_updates_vs_sampler_policy": 38999.0}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 1248000, "last_target_update_ts": 39501, "num_target_updates": 78}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 1248000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.06731198981794, "num_env_steps_trained_throughput_per_sec": 962.1539836741741, "timesteps_total": 40000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 30.759, "sample_time_ms": 9.09, "load_time_ms": 0.1, "load_throughput": 320023.195, "learn_time_ms": 3.873, "learn_throughput": 8262.705, "synch_weights_time_ms": 2.307}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 1248000, "last_target_update_ts": 39501, "num_target_updates": 78}, "done": false, "episodes_total": 3, "training_iteration": 40, "trial_id": "c28e8_00000", "date": "2023-12-11_11-10-31", "timestamp": 1702321831, "time_this_iter_s": 33.26421284675598, "time_total_s": 1328.279058933258, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1328.279058933258, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 25.426086956521743, "ram_util_percent": 90.62391304347825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -27472.841796875, "min_q": -27475.126953125, "max_q": -27471.619140625, "mean_td_error": 63.33758544921875, "model": {}}, "td_error": [400.248046875, 496.740234375, 496.740234375, 0.248046875, -484.259765625, -237.259765625, 122.1875, -202.259765625, -149.259765625, 301.1875, 276.1875, 0.248046875, 477.740234375, 435.1875, 356.1875, 0.248046875, 0.248046875, -188.8125, 0.248046875, 260.248046875, 0.248046875, 325.740234375, 202.248046875, -192.751953125, -262.259765625, -157.8125, 0.248046875, 188.1875, -471.751953125, -357.259765625, -106.814453125, 496.73828125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 40000.0, "diff_num_grad_updates_vs_sampler_policy": 39999.0}}, "num_env_steps_sampled": 41000, "num_env_steps_trained": 1280000, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 1280000, "last_target_update_ts": 40501, "num_target_updates": 80}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 41000, "num_env_steps_trained": 1280000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.787810447730767, "num_env_steps_trained_throughput_per_sec": 1017.2099343273845, "timesteps_total": 41000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 41000, "timers": {"training_iteration_time_ms": 31.062, "sample_time_ms": 9.648, "load_time_ms": 0.303, "load_throughput": 105666.61, "learn_time_ms": 3.691, "learn_throughput": 8670.732, "synch_weights_time_ms": 2.256}, "counters": {"num_env_steps_sampled": 41000, "num_env_steps_trained": 1280000, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 1280000, "last_target_update_ts": 40501, "num_target_updates": 80}, "done": false, "episodes_total": 3, "training_iteration": 41, "trial_id": "c28e8_00000", "date": "2023-12-11_11-11-02", "timestamp": 1702321862, "time_this_iter_s": 31.46509099006653, "time_total_s": 1359.7441499233246, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1359.7441499233246, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 23.327272727272728, "ram_util_percent": 90.85909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -27909.34375, "min_q": -27911.853515625, "max_q": -27908.359375, "mean_td_error": 53.21905517578125, "model": {}}, "td_error": [502.974609375, 2.986328125, -227.5078125, -420.025390625, 2.986328125, -366.013671875, -151.025390625, 499.4921875, -285.013671875, 2.986328125, 2.986328125, -156.5078125, -126.5078125, -133.5078125, 2.986328125, 306.4921875, 388.974609375, 173.986328125, 2.986328125, 422.974609375, 499.4921875, -32.025390625, 2.986328125, -118.5078125, 327.974609375, 499.4921875, -280.013671875, 2.986328125, -36.025390625, 383.974609375, 2.986328125, 2.986328125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 41000.0, "diff_num_grad_updates_vs_sampler_policy": 40999.0}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 1312000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 1312000, "last_target_update_ts": 41501, "num_target_updates": 82}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 1312000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.499871290971235, "num_env_steps_trained_throughput_per_sec": 1007.9958813110795, "timesteps_total": 42000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 31.571, "sample_time_ms": 9.615, "load_time_ms": 0.1, "load_throughput": 318428.773, "learn_time_ms": 4.13, "learn_throughput": 7749.023, "synch_weights_time_ms": 2.561}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 1312000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 1312000, "last_target_update_ts": 41501, "num_target_updates": 82}, "done": false, "episodes_total": 3, "training_iteration": 42, "trial_id": "c28e8_00000", "date": "2023-12-11_11-11-34", "timestamp": 1702321894, "time_this_iter_s": 31.751986742019653, "time_total_s": 1391.4961366653442, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1391.4961366653442, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 22.655555555555555, "ram_util_percent": 90.99111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -28350.16015625, "min_q": -28352.900390625, "max_q": -28349.369140625, "mean_td_error": 22.4691162109375, "model": {}}, "td_error": [387.728515625, -330.779296875, -123.271484375, 353.259765625, 272.259765625, -0.779296875, -279.779296875, 390.220703125, 121.728515625, -0.779296875, -326.779296875, -44.740234375, -156.740234375, -179.740234375, -0.779296875, -0.779296875, -309.779296875, 206.259765625, -0.779296875, -0.779296875, 226.220703125, 495.728515625, 495.728515625, 152.259765625, -23.779296875, -281.271484375, -283.271484375, 65.259765625, -224.740234375, 475.259765625, -352.77734375, -0.77734375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 42000.0, "diff_num_grad_updates_vs_sampler_policy": 41999.0}}, "num_env_steps_sampled": 43000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 1344000, "last_target_update_ts": 42501, "num_target_updates": 84}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}}, "episode_reward_max": -99112.0, "episode_reward_min": -1093293.0, "episode_reward_mean": -508755.3333333333, "episode_len_mean": 1063.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0], "episode_lengths": [768, 2276, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2107442279644214, "mean_inference_ms": 1.5415408910323247, "mean_action_processing_ms": 0.11515257119527877, "mean_env_wait_ms": 0.05839801608911719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.12520154317220053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 43000, "num_env_steps_trained": 1344000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.359639801500542, "num_env_steps_trained_throughput_per_sec": 1003.5084736480173, "timesteps_total": 43000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 43000, "timers": {"training_iteration_time_ms": 31.616, "sample_time_ms": 9.272, "load_time_ms": 0.302, "load_throughput": 106092.584, "learn_time_ms": 4.112, "learn_throughput": 7781.821, "synch_weights_time_ms": 2.265}, "counters": {"num_env_steps_sampled": 43000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 1344000, "last_target_update_ts": 42501, "num_target_updates": 84}, "done": false, "episodes_total": 3, "training_iteration": 43, "trial_id": "c28e8_00000", "date": "2023-12-11_11-12-06", "timestamp": 1702321926, "time_this_iter_s": 31.893782138824463, "time_total_s": 1423.3899188041687, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1423.3899188041687, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 22.93409090909091, "ram_util_percent": 91.14318181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -28776.880859375, "min_q": -28778.97265625, "max_q": -28775.404296875, "mean_td_error": 108.961181640625, "model": {}}, "td_error": [-151.564453125, 0.900390625, 0.900390625, -399.564453125, 394.900390625, -304.0, -109.564453125, 490.435546875, 497.435546875, -369.0, 339.435546875, -210.099609375, 371.435546875, 497.435546875, 351.0, 0.900390625, 76.900390625, 458.0, 0.900390625, -204.0, 0.900390625, 0.900390625, -265.0, 481.0, 477.0, 457.0, 205.435546875, 113.435546875, -119.564453125, 77.0, 497.431640625, -171.568359375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 43000.0, "diff_num_grad_updates_vs_sampler_policy": 42999.0}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 1376000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 1376000, "last_target_update_ts": 43501, "num_target_updates": 86}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -5391834.25, "episode_len_mean": 10762.5, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0], "episode_lengths": [768, 2276, 146, 39860]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1836886717336552, "mean_inference_ms": 1.4748766900518706, "mean_action_processing_ms": 0.1244184713956358, "mean_env_wait_ms": 0.05962019866542392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0004649162292480469, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11135339736938477}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -5391834.25, "episode_len_mean": 10762.5, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0], "episode_lengths": [768, 2276, 146, 39860]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1836886717336552, "mean_inference_ms": 1.4748766900518706, "mean_action_processing_ms": 0.1244184713956358, "mean_env_wait_ms": 0.05962019866542392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0004649162292480469, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11135339736938477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 1376000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 26.58977314544893, "num_env_steps_trained_throughput_per_sec": 850.8727406543658, "timesteps_total": 44000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 31.82, "sample_time_ms": 9.424, "load_time_ms": 0.1, "load_throughput": 320023.195, "learn_time_ms": 3.708, "learn_throughput": 8630.2, "synch_weights_time_ms": 2.712}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 1376000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 1376000, "last_target_update_ts": 43501, "num_target_updates": 86}, "done": false, "episodes_total": 4, "training_iteration": 44, "trial_id": "c28e8_00000", "date": "2023-12-11_11-12-44", "timestamp": 1702321964, "time_this_iter_s": 37.61544394493103, "time_total_s": 1461.0053627490997, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1461.0053627490997, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 34.08679245283019, "ram_util_percent": 92.39433962264148}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -29189.38671875, "min_q": -29192.00390625, "max_q": -29188.42578125, "mean_td_error": -20.6387939453125, "model": {}}, "td_error": [-409.8359375, 301.048828125, 417.048828125, 8.048828125, 504.587890625, 8.048828125, -205.412109375, 8.048828125, 8.048828125, 8.048828125, 137.1640625, 8.048828125, 8.048828125, 504.587890625, 508.1640625, -131.412109375, -468.951171875, -324.412109375, -204.951171875, -138.412109375, 8.048828125, -50.951171875, -36.951171875, -343.8359375, 8.048828125, 8.048828125, 8.048828125, 475.587890625, -468.8359375, -334.951171875, -132.416015625, -345.83984375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 44000.0, "diff_num_grad_updates_vs_sampler_policy": 43999.0}}, "num_env_steps_sampled": 45000, "num_env_steps_trained": 1408000, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 1408000, "last_target_update_ts": 44501, "num_target_updates": 88}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -5391834.25, "episode_len_mean": 10762.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0], "episode_lengths": [768, 2276, 146, 39860]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1836886717336552, "mean_inference_ms": 1.4748766900518706, "mean_action_processing_ms": 0.1244184713956358, "mean_env_wait_ms": 0.05962019866542392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0004649162292480469, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11135339736938477}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -5391834.25, "episode_len_mean": 10762.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0], "episode_lengths": [768, 2276, 146, 39860]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1836886717336552, "mean_inference_ms": 1.4748766900518706, "mean_action_processing_ms": 0.1244184713956358, "mean_env_wait_ms": 0.05962019866542392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0004649162292480469, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11135339736938477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 45000, "num_env_steps_trained": 1408000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 15.310996065585538, "num_env_steps_trained_throughput_per_sec": 489.9518740987372, "timesteps_total": 45000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 45000, "timers": {"training_iteration_time_ms": 67.867, "sample_time_ms": 17.99, "load_time_ms": 0.525, "load_throughput": 60952.647, "learn_time_ms": 6.339, "learn_throughput": 5047.772, "synch_weights_time_ms": 4.012}, "counters": {"num_env_steps_sampled": 45000, "num_env_steps_trained": 1408000, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 1408000, "last_target_update_ts": 44501, "num_target_updates": 88}, "done": false, "episodes_total": 4, "training_iteration": 45, "trial_id": "c28e8_00000", "date": "2023-12-11_11-13-49", "timestamp": 1702322029, "time_this_iter_s": 65.32453680038452, "time_total_s": 1526.3298995494843, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1526.3298995494843, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 73.57111111111112, "ram_util_percent": 94.00999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -29607.306640625, "min_q": -29609.380859375, "max_q": -29605.7890625, "mean_td_error": -852.779296875, "model": {}}, "td_error": [-0.37890625, 496.1640625, 450.1640625, 227.62109375, -0.37890625, 496.1640625, -0.37890625, 253.755859375, -0.37890625, -160.37890625, -0.37890625, -0.37890625, 417.62109375, 204.1640625, -180.8359375, -493.37890625, 496.1640625, -0.37890625, -0.37890625, -231.244140625, -80.8359375, -0.37890625, 496.1640625, -262.8359375, -0.37890625, -40.244140625, 182.1640625, -29605.7890625, -107.8359375, 204.1640625, 274.755859375, -320.8359375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 45000.0, "diff_num_grad_updates_vs_sampler_policy": 44999.0}}, "num_env_steps_sampled": 46000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 1440000, "last_target_update_ts": 45501, "num_target_updates": 90}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 46000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 15.177151507171702, "num_env_steps_trained_throughput_per_sec": 485.6688482294945, "timesteps_total": 46000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 46000, "timers": {"training_iteration_time_ms": 50.316, "sample_time_ms": 14.693, "load_time_ms": 0.303, "load_throughput": 105758.197, "learn_time_ms": 5.813, "learn_throughput": 5504.833, "synch_weights_time_ms": 3.066}, "counters": {"num_env_steps_sampled": 46000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 1440000, "last_target_update_ts": 45501, "num_target_updates": 90}, "done": false, "episodes_total": 5, "training_iteration": 46, "trial_id": "c28e8_00000", "date": "2023-12-11_11-14-55", "timestamp": 1702322095, "time_this_iter_s": 65.89851784706116, "time_total_s": 1592.2284173965454, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1592.2284173965454, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 77.24615384615385, "ram_util_percent": 95.60989010989012}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -30002.951171875, "min_q": -30005.841796875, "max_q": -30002.22265625, "mean_td_error": 94.47235107421875, "model": {}}, "td_error": [-57.298828125, 483.08203125, 112.701171875, -63.4765625, 2.5234375, -391.4765625, 2.5234375, -484.298828125, 499.08203125, -198.91796875, 229.701171875, -337.298828125, -483.298828125, 2.5234375, 499.08203125, 2.5234375, -259.298828125, 279.701171875, -246.298828125, 216.701171875, 2.5234375, -102.298828125, 430.701171875, 360.5234375, -117.298828125, 488.701171875, 470.701171875, 466.701171875, 486.701171875, 499.08203125, 366.51953125, -137.921875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 46000.0, "diff_num_grad_updates_vs_sampler_policy": 45999.0}}, "num_env_steps_sampled": 47000, "num_env_steps_trained": 1472000, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 1472000, "last_target_update_ts": 46501, "num_target_updates": 92}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 47000, "num_env_steps_trained": 1472000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.715562141294047, "num_env_steps_trained_throughput_per_sec": 598.8979885214095, "timesteps_total": 47000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 47000, "timers": {"training_iteration_time_ms": 62.42, "sample_time_ms": 16.823, "load_time_ms": 0.278, "load_throughput": 114961.651, "learn_time_ms": 5.982, "learn_throughput": 5349.558, "synch_weights_time_ms": 4.568}, "counters": {"num_env_steps_sampled": 47000, "num_env_steps_trained": 1472000, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 1472000, "last_target_update_ts": 46501, "num_target_updates": 92}, "done": false, "episodes_total": 5, "training_iteration": 47, "trial_id": "c28e8_00000", "date": "2023-12-11_11-15-49", "timestamp": 1702322149, "time_this_iter_s": 53.44238233566284, "time_total_s": 1645.6707997322083, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1645.6707997322083, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 59.83513513513514, "ram_util_percent": 92.82972972972973}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -30412.703125, "min_q": -30415.58203125, "max_q": -30411.91015625, "mean_td_error": -40.44219970703125, "model": {}}, "td_error": [-3.21875, -265.21875, -413.21875, 475.037109375, -484.962890625, 181.037109375, 493.3671875, -172.21875, -3.21875, -201.21875, -3.21875, -445.6328125, 362.037109375, 286.037109375, -378.21875, -3.21875, -436.6328125, 207.037109375, 261.3671875, -283.962890625, -3.21875, 83.037109375, 414.037109375, -434.962890625, -149.962890625, -462.6328125, -448.21875, 493.3671875, -457.21875, 433.78125, -399.958984375, 466.041015625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 47000.0, "diff_num_grad_updates_vs_sampler_policy": 46999.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 1504000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 1504000, "last_target_update_ts": 47501, "num_target_updates": 94}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 1504000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.966693171157523, "num_env_steps_trained_throughput_per_sec": 638.9341814770407, "timesteps_total": 48000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 47.701, "sample_time_ms": 13.811, "load_time_ms": 0.255, "load_throughput": 125425.407, "learn_time_ms": 5.059, "learn_throughput": 6325.893, "synch_weights_time_ms": 3.052}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 1504000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 1504000, "last_target_update_ts": 47501, "num_target_updates": 94}, "done": false, "episodes_total": 5, "training_iteration": 48, "trial_id": "c28e8_00000", "date": "2023-12-11_11-16-39", "timestamp": 1702322199, "time_this_iter_s": 50.09340858459473, "time_total_s": 1695.764208316803, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1695.764208316803, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 54.169999999999995, "ram_util_percent": 94.13999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -30786.6953125, "min_q": -30788.927734375, "max_q": -30785.18359375, "mean_td_error": -914.3511962890625, "model": {}}, "td_error": [5.046875, 376.4296875, 303.4296875, 308.685546875, 288.685546875, -132.5703125, -299.5703125, 374.4296875, -171.953125, 160.685546875, 438.685546875, 393.685546875, 5.046875, -41.953125, -470.5703125, 501.685546875, -147.314453125, 505.4296875, 501.685546875, -160.953125, 5.046875, 5.046875, 266.685546875, -375.5703125, -132.314453125, -383.5703125, -70.314453125, -397.5703125, -437.314453125, -30785.56640625, 302.4296875, 5.046875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 48000.0, "diff_num_grad_updates_vs_sampler_policy": 47999.0}}, "num_env_steps_sampled": 49000, "num_env_steps_trained": 1536000, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 1536000, "last_target_update_ts": 48501, "num_target_updates": 96}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 49000, "num_env_steps_trained": 1536000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 22.559072423546276, "num_env_steps_trained_throughput_per_sec": 721.8903175534808, "timesteps_total": 49000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 49000, "timers": {"training_iteration_time_ms": 39.738, "sample_time_ms": 11.848, "load_time_ms": 0.329, "load_throughput": 97287.422, "learn_time_ms": 3.903, "learn_throughput": 8198.705, "synch_weights_time_ms": 2.964}, "counters": {"num_env_steps_sampled": 49000, "num_env_steps_trained": 1536000, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 1536000, "last_target_update_ts": 48501, "num_target_updates": 96}, "done": false, "episodes_total": 5, "training_iteration": 49, "trial_id": "c28e8_00000", "date": "2023-12-11_11-17-23", "timestamp": 1702322243, "time_this_iter_s": 44.338075399398804, "time_total_s": 1740.1022837162018, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1740.1022837162018, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 43.95806451612904, "ram_util_percent": 91.49193548387095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -31192.03515625, "min_q": -31194.66015625, "max_q": -31190.890625, "mean_td_error": 45.17681884765625, "model": {}}, "td_error": [129.662109375, -245.337890625, -151.337890625, -433.337890625, 462.662109375, 287.89453125, 424.662109375, -329.775390625, -127.10546875, -282.337890625, -150.10546875, -326.10546875, 490.89453125, -5.775390625, 458.89453125, 377.662109375, -140.337890625, -507.10546875, 452.662109375, 494.662109375, 106.662109375, -372.337890625, 490.89453125, 490.89453125, -5.775390625, -183.337890625, -5.775390625, 456.662109375, -30.337890625, -166.775390625, -5.7734375, -210.3359375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 49000.0, "diff_num_grad_updates_vs_sampler_policy": 48999.0}}, "num_env_steps_sampled": 50000, "num_env_steps_trained": 1568000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 1568000, "last_target_update_ts": 49501, "num_target_updates": 98}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 50000, "num_env_steps_trained": 1568000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 22.269894134398584, "num_env_steps_trained_throughput_per_sec": 712.6366123007547, "timesteps_total": 50000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 50000, "timers": {"training_iteration_time_ms": 68.159, "sample_time_ms": 18.873, "load_time_ms": 0.236, "load_throughput": 135382.013, "learn_time_ms": 6.405, "learn_throughput": 4996.23, "synch_weights_time_ms": 3.841}, "counters": {"num_env_steps_sampled": 50000, "num_env_steps_trained": 1568000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 1568000, "last_target_update_ts": 49501, "num_target_updates": 98}, "done": false, "episodes_total": 5, "training_iteration": 50, "trial_id": "c28e8_00000", "date": "2023-12-11_11-18-08", "timestamp": 1702322288, "time_this_iter_s": 44.911688804626465, "time_total_s": 1785.0139725208282, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1785.0139725208282, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 42.361666666666665, "ram_util_percent": 91.34666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -31561.140625, "min_q": -31563.90625, "max_q": -31560.1328125, "mean_td_error": 41.6500244140625, "model": {}}, "td_error": [-391.8828125, 404.7890625, 293.5625, 489.7890625, -6.8828125, 489.7890625, 71.5625, -6.8828125, 371.5625, -249.4375, -260.8828125, -261.4375, -301.4375, -306.4375, -6.8828125, -72.2109375, 140.1171875, -264.4375, -6.8828125, -125.2109375, -6.8828125, -262.4375, -6.8828125, -6.8828125, 489.7890625, 493.5625, 489.7890625, -6.8828125, -478.8828125, 272.5625, 362.564453125, -6.880859375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 50000.0, "diff_num_grad_updates_vs_sampler_policy": 49999.0}}, "num_env_steps_sampled": 51000, "num_env_steps_trained": 1600000, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 1600000, "last_target_update_ts": 50501, "num_target_updates": 100}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 51000, "num_env_steps_trained": 1600000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 20.30840999977156, "num_env_steps_trained_throughput_per_sec": 649.8691199926899, "timesteps_total": 51000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 51000, "timers": {"training_iteration_time_ms": 43.103, "sample_time_ms": 13.342, "load_time_ms": 0.622, "load_throughput": 51477.67, "learn_time_ms": 4.428, "learn_throughput": 7227.275, "synch_weights_time_ms": 3.364}, "counters": {"num_env_steps_sampled": 51000, "num_env_steps_trained": 1600000, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 1600000, "last_target_update_ts": 50501, "num_target_updates": 100}, "done": false, "episodes_total": 5, "training_iteration": 51, "trial_id": "c28e8_00000", "date": "2023-12-11_11-18-58", "timestamp": 1702322338, "time_this_iter_s": 49.24969673156738, "time_total_s": 1834.2636692523956, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1834.2636692523956, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 50.24705882352941, "ram_util_percent": 92.99264705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -31943.21484375, "min_q": -31946.013671875, "max_q": -31942.25, "mean_td_error": 79.00897216796875, "model": {}}, "td_error": [-5.1328125, -63.1328125, -5.1328125, 491.552734375, -5.1328125, -65.68359375, 281.8671875, -182.68359375, 403.8671875, -476.68359375, 379.552734375, 369.8671875, 270.31640625, -5.1328125, 409.31640625, -145.447265625, 16.31640625, -107.447265625, 495.31640625, -50.68359375, 212.31640625, 143.31640625, -74.447265625, -465.1328125, 436.31640625, 97.31640625, 292.31640625, 221.31640625, -463.447265625, 279.31640625, -151.447265625, -5.1328125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 51000.0, "diff_num_grad_updates_vs_sampler_policy": 50999.0}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 1632000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 1632000, "last_target_update_ts": 51501, "num_target_updates": 102}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 1632000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 16.790405535164094, "num_env_steps_trained_throughput_per_sec": 537.292977125251, "timesteps_total": 52000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 62.949, "sample_time_ms": 16.782, "load_time_ms": 0.281, "load_throughput": 113878.948, "learn_time_ms": 5.606, "learn_throughput": 5708.478, "synch_weights_time_ms": 3.825}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 1632000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 1632000, "last_target_update_ts": 51501, "num_target_updates": 102}, "done": false, "episodes_total": 5, "training_iteration": 52, "trial_id": "c28e8_00000", "date": "2023-12-11_11-19-57", "timestamp": 1702322397, "time_this_iter_s": 59.56982159614563, "time_total_s": 1893.8334908485413, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1893.8334908485413, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 67.53780487804879, "ram_util_percent": 94.13780487804878}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -32300.05078125, "min_q": -32303.400390625, "max_q": -32299.623046875, "mean_td_error": 84.76165771484375, "model": {}}, "td_error": [463.75, 502.75, -342.25, 2.2890625, 2.75, 150.75, -83.25, -276.25, -72.25, 2.2890625, 210.75, -365.25, 463.75, 484.974609375, 2.2890625, -491.25, 385.75, 144.75, -376.25, 427.75, 278.75, -253.25, 489.75, -440.25, -28.7109375, 371.75, 140.75, 502.75, -186.7109375, 498.974609375, -398.248046875, 498.9765625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 52000.0, "diff_num_grad_updates_vs_sampler_policy": 51999.0}}, "num_env_steps_sampled": 53000, "num_env_steps_trained": 1664000, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 1664000, "last_target_update_ts": 52501, "num_target_updates": 104}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 1664000, "num_env_steps_sampled": 53000, "num_env_steps_trained": 1664000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 17.509672349144044, "num_env_steps_trained_throughput_per_sec": 560.3095151726094, "timesteps_total": 53000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 53000, "timers": {"training_iteration_time_ms": 44.907, "sample_time_ms": 13.85, "load_time_ms": 0.449, "load_throughput": 71255.961, "learn_time_ms": 4.461, "learn_throughput": 7173.467, "synch_weights_time_ms": 3.057}, "counters": {"num_env_steps_sampled": 53000, "num_env_steps_trained": 1664000, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 1664000, "last_target_update_ts": 52501, "num_target_updates": 104}, "done": false, "episodes_total": 5, "training_iteration": 53, "trial_id": "c28e8_00000", "date": "2023-12-11_11-20-54", "timestamp": 1702322454, "time_this_iter_s": 57.12029147148132, "time_total_s": 1950.9537823200226, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1950.9537823200226, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 58.665, "ram_util_percent": 95.20875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -32655.1796875, "min_q": -32658.353515625, "max_q": -32654.5546875, "mean_td_error": 133.1051025390625, "model": {}}, "td_error": [482.16796875, 394.73046875, -358.83203125, 3.73046875, 278.16796875, 385.16796875, -62.630859375, 435.16796875, 3.73046875, 3.73046875, 500.369140625, -182.83203125, -486.83203125, -446.83203125, 3.73046875, 474.16796875, 502.16796875, 3.73046875, 3.73046875, 500.369140625, 3.73046875, 288.16796875, -349.83203125, 446.73046875, -205.83203125, 374.73046875, 156.16796875, 3.73046875, 500.369140625, -34.83203125, 385.166015625, 254.166015625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 53000.0, "diff_num_grad_updates_vs_sampler_policy": 52999.0}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 1696000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 1696000, "last_target_update_ts": 53501, "num_target_updates": 106}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 1696000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 1696000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.11456225834808, "num_env_steps_trained_throughput_per_sec": 611.6659922671386, "timesteps_total": 54000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 64.32, "sample_time_ms": 17.913, "load_time_ms": 0.633, "load_throughput": 50520.468, "learn_time_ms": 5.502, "learn_throughput": 5816.158, "synch_weights_time_ms": 3.978}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 1696000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 1696000, "last_target_update_ts": 53501, "num_target_updates": 106}, "done": false, "episodes_total": 5, "training_iteration": 54, "trial_id": "c28e8_00000", "date": "2023-12-11_11-21-47", "timestamp": 1702322507, "time_this_iter_s": 52.32913613319397, "time_total_s": 2003.2829184532166, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2003.2829184532166, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 57.856944444444444, "ram_util_percent": 96.01944444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -33010.52734375, "min_q": -33013.78515625, "max_q": -33010.0703125, "mean_td_error": 67.402587890625, "model": {}}, "td_error": [-165.35546875, 380.359375, 501.359375, 184.359375, 0.97265625, 501.359375, -197.35546875, 384.359375, 409.359375, 465.359375, -330.640625, 0.97265625, 500.359375, -361.640625, -180.640625, -335.640625, -433.640625, 423.359375, -143.640625, 253.359375, 0.97265625, 0.97265625, -409.640625, 0.97265625, -34.640625, 410.359375, 199.64453125, 127.359375, 0.97265625, 0.97265625, 0.9765625, 0.9765625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 54000.0, "diff_num_grad_updates_vs_sampler_policy": 53999.0}}, "num_env_steps_sampled": 55000, "num_env_steps_trained": 1728000, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 1728000, "last_target_update_ts": 54501, "num_target_updates": 108}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 55000, "num_env_steps_trained": 1728000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 16.534535448590233, "num_env_steps_trained_throughput_per_sec": 529.1051343548875, "timesteps_total": 55000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 55000, "timers": {"training_iteration_time_ms": 74.711, "sample_time_ms": 20.309, "load_time_ms": 0.443, "load_throughput": 72229.969, "learn_time_ms": 6.875, "learn_throughput": 4654.552, "synch_weights_time_ms": 4.186}, "counters": {"num_env_steps_sampled": 55000, "num_env_steps_trained": 1728000, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 1728000, "last_target_update_ts": 54501, "num_target_updates": 108}, "done": false, "episodes_total": 5, "training_iteration": 55, "trial_id": "c28e8_00000", "date": "2023-12-11_11-22-47", "timestamp": 1702322567, "time_this_iter_s": 60.49347400665283, "time_total_s": 2063.7763924598694, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2063.7763924598694, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 69.69047619047618, "ram_util_percent": 91.38928571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -33349.75, "min_q": -33353.13671875, "max_q": -33349.55078125, "mean_td_error": -25.234375, "model": {}}, "td_error": [288.05859375, 71.05859375, -75.52734375, -78.94140625, -236.94140625, 3.66015625, 3.66015625, -306.94140625, -296.94140625, -274.94140625, 256.05859375, 302.05859375, 3.66015625, 3.66015625, 3.66015625, -241.94140625, 448.05859375, -222.94140625, -481.94140625, 183.05859375, 3.66015625, -197.94140625, -411.94140625, -378.94140625, -178.94140625, -387.94140625, -188.94140625, 458.05859375, 245.05859375, 434.05859375, 3.66015625, 443.05859375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 55000.0, "diff_num_grad_updates_vs_sampler_policy": 54999.0}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 1760000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 1760000, "last_target_update_ts": 55501, "num_target_updates": 110}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 1760000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 16.631802289818264, "num_env_steps_trained_throughput_per_sec": 532.2176732741844, "timesteps_total": 56000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 65.816, "sample_time_ms": 17.827, "load_time_ms": 0.587, "load_throughput": 54493.596, "learn_time_ms": 6.203, "learn_throughput": 5159.184, "synch_weights_time_ms": 4.162}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 1760000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 1760000, "last_target_update_ts": 55501, "num_target_updates": 110}, "done": false, "episodes_total": 5, "training_iteration": 56, "trial_id": "c28e8_00000", "date": "2023-12-11_11-23-48", "timestamp": 1702322628, "time_this_iter_s": 60.13877487182617, "time_total_s": 2123.9151673316956, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2123.9151673316956, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 70.02738095238097, "ram_util_percent": 91.37857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -33703.296875, "min_q": -33706.57421875, "max_q": -33703.1328125, "mean_td_error": 40.0643310546875, "model": {}}, "td_error": [192.38671875, 275.38671875, 316.38671875, -8.92578125, 78.38671875, 294.38671875, 122.38671875, -130.61328125, -8.92578125, 491.38671875, 482.38671875, -55.61328125, -94.0546875, 201.38671875, -87.61328125, -465.61328125, 419.38671875, -8.92578125, 147.38671875, 446.38671875, -507.61328125, -8.92578125, -178.61328125, -303.61328125, -250.61328125, -8.92578125, -488.61328125, 425.38671875, -428.61328125, -8.92578125, 361.38671875, 72.38671875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 56000.0, "diff_num_grad_updates_vs_sampler_policy": 55999.0}}, "num_env_steps_sampled": 57000, "num_env_steps_trained": 1792000, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 1792000, "last_target_update_ts": 56501, "num_target_updates": 112}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 1792000, "num_env_steps_sampled": 57000, "num_env_steps_trained": 1792000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 15.633113760658535, "num_env_steps_trained_throughput_per_sec": 500.2596403410731, "timesteps_total": 57000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 57000, "timers": {"training_iteration_time_ms": 91.878, "sample_time_ms": 26.072, "load_time_ms": 0.573, "load_throughput": 55821.714, "learn_time_ms": 9.487, "learn_throughput": 3373.144, "synch_weights_time_ms": 5.175}, "counters": {"num_env_steps_sampled": 57000, "num_env_steps_trained": 1792000, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 1792000, "last_target_update_ts": 56501, "num_target_updates": 112}, "done": false, "episodes_total": 5, "training_iteration": 57, "trial_id": "c28e8_00000", "date": "2023-12-11_11-24-52", "timestamp": 1702322692, "time_this_iter_s": 63.97978377342224, "time_total_s": 2187.894951105118, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2187.894951105118, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 74.0284090909091, "ram_util_percent": 89.69886363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -34014.6328125, "min_q": -34017.7734375, "max_q": -34014.46484375, "mean_td_error": -2034.6373291015625, "model": {}}, "td_error": [411.59375, -178.40625, 4.375, 270.59375, 399.375, 228.59375, 278.59375, 405.59375, 4.375, -407.40625, -424.40625, -219.40625, 353.59375, 504.59375, -56.40625, 390.59375, 225.59375, 4.375, -34014.46484375, 468.59375, 4.375, -77.71484375, 4.375, -34014.46484375, 313.59375, 4.59375, 4.375, -238.40625, 44.59375, 187.59375, 4.375, 4.375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 57000.0, "diff_num_grad_updates_vs_sampler_policy": 56999.0}}, "num_env_steps_sampled": 58000, "num_env_steps_trained": 1824000, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 1824000, "last_target_update_ts": 57501, "num_target_updates": 114}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 58000, "num_env_steps_trained": 1824000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 12.381955438677004, "num_env_steps_trained_throughput_per_sec": 396.2225740376641, "timesteps_total": 58000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 58000, "timers": {"training_iteration_time_ms": 57.49, "sample_time_ms": 16.888, "load_time_ms": 0.523, "load_throughput": 61135.888, "learn_time_ms": 6.217, "learn_throughput": 5147.392, "synch_weights_time_ms": 4.271}, "counters": {"num_env_steps_sampled": 58000, "num_env_steps_trained": 1824000, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 1824000, "last_target_update_ts": 57501, "num_target_updates": 114}, "done": false, "episodes_total": 5, "training_iteration": 58, "trial_id": "c28e8_00000", "date": "2023-12-11_11-26-13", "timestamp": 1702322773, "time_this_iter_s": 80.77271389961243, "time_total_s": 2268.66766500473, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2268.66766500473, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 87.63153153153152, "ram_util_percent": 95.11621621621622}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -34338.9375, "min_q": -34339.06640625, "max_q": -34338.9140625, "mean_td_error": 35.4879150390625, "model": {}}, "td_error": [140.01171875, 6.859375, 387.01171875, -396.98828125, 424.01171875, 295.01171875, 479.01171875, -220.98828125, 6.859375, 6.859375, 444.01171875, 6.859375, -199.98828125, 192.01171875, -218.98828125, 363.01171875, -345.98828125, 384.01171875, 6.859375, 92.01171875, -157.98828125, 217.01171875, -200.98828125, -473.98828125, 291.01171875, -184.98828125, -408.98828125, 431.01171875, -222.98828125, -92.98828125, 507.01171875, -418.98828125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 58000.0, "diff_num_grad_updates_vs_sampler_policy": 57999.0}}, "num_env_steps_sampled": 59000, "num_env_steps_trained": 1856000, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 1856000, "last_target_update_ts": 58501, "num_target_updates": 116}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4557080.8, "episode_len_mean": 9037.6, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0], "episode_lengths": [768, 2276, 146, 39860, 2138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1754833826386106, "mean_inference_ms": 1.4388712291270198, "mean_action_processing_ms": 0.13149272873808088, "mean_env_wait_ms": 0.060938127186550714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0003719329833984375, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.20913124084472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 1856000, "num_env_steps_sampled": 59000, "num_env_steps_trained": 1856000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 21.920836343157685, "num_env_steps_trained_throughput_per_sec": 701.4667629810459, "timesteps_total": 59000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 59000, "timers": {"training_iteration_time_ms": 44.122, "sample_time_ms": 13.169, "load_time_ms": 0.1, "load_throughput": 320099.518, "learn_time_ms": 4.782, "learn_throughput": 6691.181, "synch_weights_time_ms": 3.374}, "counters": {"num_env_steps_sampled": 59000, "num_env_steps_trained": 1856000, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 1856000, "last_target_update_ts": 58501, "num_target_updates": 116}, "done": false, "episodes_total": 5, "training_iteration": 59, "trial_id": "c28e8_00000", "date": "2023-12-11_11-26-58", "timestamp": 1702322818, "time_this_iter_s": 45.62870502471924, "time_total_s": 2314.2963700294495, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2314.2963700294495, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 42.24126984126984, "ram_util_percent": 95.02857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -34637.546875, "min_q": -34640.58203125, "max_q": -34637.421875, "mean_td_error": 9.6693115234375, "model": {}}, "td_error": [214.4453125, -216.5546875, -111.7109375, -2.69140625, -162.5546875, 366.4453125, 336.4453125, 497.4453125, 468.4453125, -116.5546875, 272.4453125, -197.5546875, -322.5546875, -2.69140625, -333.5546875, -2.69140625, -179.5546875, -2.69140625, 434.4453125, 400.4453125, -456.5546875, -2.69140625, -157.5546875, -449.5546875, -142.5546875, -410.5546875, 346.4453125, 483.4453125, 132.4453125, -322.5546875, -181.55078125, 131.44921875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 59000.0, "diff_num_grad_updates_vs_sampler_policy": 58999.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 1888000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 1888000, "last_target_update_ts": 59501, "num_target_updates": 118}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4991663.5, "episode_len_mean": 9974.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.195099246592232, "mean_inference_ms": 1.427041402252318, "mean_action_processing_ms": 0.1403676381178887, "mean_env_wait_ms": 0.06346939132540697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00030994415283203125, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2715746561686198}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4991663.5, "episode_len_mean": 9974.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.195099246592232, "mean_inference_ms": 1.427041402252318, "mean_action_processing_ms": 0.1403676381178887, "mean_env_wait_ms": 0.06346939132540697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00030994415283203125, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2715746561686198}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 1888000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 1888000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 15.902475344959273, "num_env_steps_trained_throughput_per_sec": 508.8792110386967, "timesteps_total": 60000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 57.12, "sample_time_ms": 16.575, "load_time_ms": 0.397, "load_throughput": 80674.237, "learn_time_ms": 5.584, "learn_throughput": 5730.388, "synch_weights_time_ms": 3.632}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 1888000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 1888000, "last_target_update_ts": 59501, "num_target_updates": 118}, "done": false, "episodes_total": 6, "training_iteration": 60, "trial_id": "c28e8_00000", "date": "2023-12-11_11-28-01", "timestamp": 1702322881, "time_this_iter_s": 62.90179967880249, "time_total_s": 2377.198169708252, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2377.198169708252, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 51.577215189873414, "ram_util_percent": 95.02531645569618}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -34947.890625, "min_q": -34948.01953125, "max_q": -34947.84765625, "mean_td_error": 43.765625, "model": {}}, "td_error": [-8.95703125, -8.95703125, -8.95703125, 325.20703125, -8.95703125, -231.79296875, 144.20703125, 474.20703125, -299.79296875, 468.20703125, 462.20703125, -140.79296875, -243.79296875, 248.20703125, 482.20703125, -8.95703125, -494.79296875, 241.04296875, -187.79296875, 147.20703125, -208.79296875, -365.79296875, 448.20703125, 292.20703125, 470.20703125, -429.79296875, 226.20703125, -349.79296875, -274.79296875, -26.95703125, -105.78125, 376.21875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 60000.0, "diff_num_grad_updates_vs_sampler_policy": 59999.0}}, "num_env_steps_sampled": 61000, "num_env_steps_trained": 1920000, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 1920000, "last_target_update_ts": 60501, "num_target_updates": 120}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4991663.5, "episode_len_mean": 9974.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.195099246592232, "mean_inference_ms": 1.427041402252318, "mean_action_processing_ms": 0.1403676381178887, "mean_env_wait_ms": 0.06346939132540697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00030994415283203125, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2715746561686198}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4991663.5, "episode_len_mean": 9974.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.195099246592232, "mean_inference_ms": 1.427041402252318, "mean_action_processing_ms": 0.1403676381178887, "mean_env_wait_ms": 0.06346939132540697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00030994415283203125, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2715746561686198}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 61000, "num_env_steps_trained": 1920000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 21.267325098056357, "num_env_steps_trained_throughput_per_sec": 680.5544031378034, "timesteps_total": 61000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 61000, "timers": {"training_iteration_time_ms": 38.264, "sample_time_ms": 11.43, "load_time_ms": 0.1, "load_throughput": 320023.195, "learn_time_ms": 4.692, "learn_throughput": 6820.769, "synch_weights_time_ms": 2.918}, "counters": {"num_env_steps_sampled": 61000, "num_env_steps_trained": 1920000, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 1920000, "last_target_update_ts": 60501, "num_target_updates": 120}, "done": false, "episodes_total": 6, "training_iteration": 61, "trial_id": "c28e8_00000", "date": "2023-12-11_11-28-48", "timestamp": 1702322928, "time_this_iter_s": 47.02950096130371, "time_total_s": 2424.2276706695557, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2424.2276706695557, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 43.56923076923077, "ram_util_percent": 96.88461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -35217.6328125, "min_q": -35217.78125, "max_q": -35217.60546875, "mean_td_error": 43.7420654296875, "model": {}}, "td_error": [163.11328125, -131.88671875, -408.88671875, -260.88671875, -47.88671875, 488.11328125, -317.88671875, 15.9375, -283.88671875, -115.88671875, 379.11328125, 516.11328125, -300.88671875, 168.11328125, 516.11328125, 148.11328125, -439.88671875, 501.11328125, 15.9375, -471.88671875, -338.88671875, 311.11328125, -33.88671875, 513.11328125, 15.9375, 15.9375, 118.11328125, -350.88671875, 419.11328125, 230.11328125, 184.9375, 183.11328125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 61000.0, "diff_num_grad_updates_vs_sampler_policy": 60999.0}}, "num_env_steps_sampled": 62000, "num_env_steps_trained": 1952000, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 1952000, "last_target_update_ts": 61501, "num_target_updates": 122}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4408735.857142857, "episode_len_mean": 8741.42857142857, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.209340778363005, "mean_inference_ms": 1.4190086192938405, "mean_action_processing_ms": 0.1466856672356645, "mean_env_wait_ms": 0.06527677421580197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030200822012765065, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2731800079345703}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4408735.857142857, "episode_len_mean": 8741.42857142857, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.209340778363005, "mean_inference_ms": 1.4190086192938405, "mean_action_processing_ms": 0.1466856672356645, "mean_env_wait_ms": 0.06527677421580197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030200822012765065, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2731800079345703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 1952000, "num_env_steps_sampled": 62000, "num_env_steps_trained": 1952000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 25.62710491795057, "num_env_steps_trained_throughput_per_sec": 820.0673573744183, "timesteps_total": 62000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 62000, "timers": {"training_iteration_time_ms": 38.558, "sample_time_ms": 11.484, "load_time_ms": 0.218, "load_throughput": 146702.075, "learn_time_ms": 4.008, "learn_throughput": 7984.303, "synch_weights_time_ms": 2.702}, "counters": {"num_env_steps_sampled": 62000, "num_env_steps_trained": 1952000, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 1952000, "last_target_update_ts": 61501, "num_target_updates": 122}, "done": false, "episodes_total": 7, "training_iteration": 62, "trial_id": "c28e8_00000", "date": "2023-12-11_11-29-27", "timestamp": 1702322967, "time_this_iter_s": 39.030118465423584, "time_total_s": 2463.2577891349792, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2463.2577891349792, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 35.66727272727273, "ram_util_percent": 94.05999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -35520.8046875, "min_q": -35523.7109375, "max_q": -35520.69921875, "mean_td_error": 30.0806884765625, "model": {}}, "td_error": [477.62109375, 195.62109375, 415.62109375, -228.37890625, -353.37890625, -173.37890625, -166.37890625, 326.62109375, 478.62109375, -234.37890625, 362.62109375, 304.62109375, -163.37890625, 113.62109375, -390.37890625, -350.37890625, -6.4765625, 424.62109375, 313.62109375, -113.38671875, -270.37890625, -395.37890625, 430.62109375, -56.37890625, -6.4765625, -6.4765625, -94.37890625, 186.62109375, -92.37890625, -260.37890625, 367.625, -73.375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 62000.0, "diff_num_grad_updates_vs_sampler_policy": 61999.0}}, "num_env_steps_sampled": 63000, "num_env_steps_trained": 1984000, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 1984000, "last_target_update_ts": 62501, "num_target_updates": 124}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4408735.857142857, "episode_len_mean": 8741.42857142857, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.209340778363005, "mean_inference_ms": 1.4190086192938405, "mean_action_processing_ms": 0.1466856672356645, "mean_env_wait_ms": 0.06527677421580197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030200822012765065, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2731800079345703}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4408735.857142857, "episode_len_mean": 8741.42857142857, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.209340778363005, "mean_inference_ms": 1.4190086192938405, "mean_action_processing_ms": 0.1466856672356645, "mean_env_wait_ms": 0.06527677421580197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030200822012765065, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2731800079345703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 1984000, "num_env_steps_sampled": 63000, "num_env_steps_trained": 1984000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.208905744076418, "num_env_steps_trained_throughput_per_sec": 902.6849838104454, "timesteps_total": 63000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 63000, "timers": {"training_iteration_time_ms": 33.626, "sample_time_ms": 9.841, "load_time_ms": 0.1, "load_throughput": 319946.908, "learn_time_ms": 3.974, "learn_throughput": 8053.096, "synch_weights_time_ms": 2.652}, "counters": {"num_env_steps_sampled": 63000, "num_env_steps_trained": 1984000, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 1984000, "last_target_update_ts": 62501, "num_target_updates": 124}, "done": false, "episodes_total": 7, "training_iteration": 63, "trial_id": "c28e8_00000", "date": "2023-12-11_11-30-03", "timestamp": 1702323003, "time_this_iter_s": 35.45585012435913, "time_total_s": 2498.7136392593384, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2498.7136392593384, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 28.406122448979588, "ram_util_percent": 94.37142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -35802.96875, "min_q": -35805.80859375, "max_q": -35802.87109375, "mean_td_error": 155.9947509765625, "model": {}}, "td_error": [-137.41015625, 116.58984375, 415.58984375, -332.41015625, 390.58984375, 343.58984375, -314.41015625, 497.65234375, 0.5546875, 437.58984375, 455.58984375, 432.58984375, 181.58984375, 0.5546875, -276.41015625, 141.58984375, -214.41015625, 140.58984375, -231.41015625, 264.58984375, 500.58984375, 312.5546875, 413.58984375, 260.58984375, 104.58984375, 385.58984375, 242.58984375, -438.41015625, 333.58984375, 328.58984375, -222.41015625, 457.58984375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 63000.0, "diff_num_grad_updates_vs_sampler_policy": 62999.0}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 2016000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 2016000, "last_target_update_ts": 63501, "num_target_updates": 126}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 2016000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.232113471703837, "num_env_steps_trained_throughput_per_sec": 935.4276310945228, "timesteps_total": 64000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 32.577, "sample_time_ms": 9.781, "load_time_ms": 0.253, "load_throughput": 126560.8, "learn_time_ms": 3.855, "learn_throughput": 8301.032, "synch_weights_time_ms": 2.338}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 2016000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 2016000, "last_target_update_ts": 63501, "num_target_updates": 126}, "done": false, "episodes_total": 8, "training_iteration": 64, "trial_id": "c28e8_00000", "date": "2023-12-11_11-30-37", "timestamp": 1702323037, "time_this_iter_s": 34.21683692932129, "time_total_s": 2532.9304761886597, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2532.9304761886597, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 26.054166666666664, "ram_util_percent": 95.15000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -36069.2421875, "min_q": -36072.015625, "max_q": -36069.109375, "mean_td_error": 19.3720703125, "model": {}}, "td_error": [-371.69921875, 492.44140625, -167.69921875, -4.65234375, 462.30078125, 237.30078125, -432.69921875, 365.30078125, -4.65234375, 480.30078125, -251.69921875, 455.30078125, -375.69921875, -228.69921875, -283.69921875, -309.69921875, 243.30078125, 232.30078125, -336.69921875, -192.69921875, 243.30078125, -236.69921875, 392.30078125, 269.30078125, 130.30078125, -387.69921875, 442.30078125, 258.30078125, -4.65234375, -159.69921875, 138.30078125, -473.69921875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 64000.0, "diff_num_grad_updates_vs_sampler_policy": 63999.0}}, "num_env_steps_sampled": 65000, "num_env_steps_trained": 2048000, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 2048000, "last_target_update_ts": 64501, "num_target_updates": 128}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 2048000, "num_env_steps_sampled": 65000, "num_env_steps_trained": 2048000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.50882330287349, "num_env_steps_trained_throughput_per_sec": 976.2823456919517, "timesteps_total": 65000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 65000, "timers": {"training_iteration_time_ms": 32.189, "sample_time_ms": 9.695, "load_time_ms": 0.302, "load_throughput": 106017.163, "learn_time_ms": 3.606, "learn_throughput": 8874.193, "synch_weights_time_ms": 2.475}, "counters": {"num_env_steps_sampled": 65000, "num_env_steps_trained": 2048000, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 2048000, "last_target_update_ts": 64501, "num_target_updates": 128}, "done": false, "episodes_total": 8, "training_iteration": 65, "trial_id": "c28e8_00000", "date": "2023-12-11_11-31-10", "timestamp": 1702323070, "time_this_iter_s": 32.78308892250061, "time_total_s": 2565.7135651111603, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2565.7135651111603, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 24.023913043478263, "ram_util_percent": 95.2173913043478}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -36351.43359375, "min_q": -36351.4453125, "max_q": -36351.33203125, "mean_td_error": 56.4364013671875, "model": {}}, "td_error": [393.58203125, 468.58203125, 8.6953125, 444.58203125, 108.58203125, 8.6953125, 8.6953125, 497.58203125, -226.41796875, 112.58203125, -457.41796875, -355.41796875, 199.58203125, -474.41796875, -202.41796875, 399.58203125, -317.41796875, 355.58203125, -451.41796875, -367.41796875, -148.41796875, -486.41796875, 508.58203125, 366.58203125, 508.58203125, 464.58203125, 384.58203125, -318.41796875, -313.41796875, 495.58203125, 313.58203125, -123.41796875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 65000.0, "diff_num_grad_updates_vs_sampler_policy": 64999.0}}, "num_env_steps_sampled": 66000, "num_env_steps_trained": 2080000, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 2080000, "last_target_update_ts": 65501, "num_target_updates": 130}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 66000, "num_env_steps_trained": 2080000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.709906967148186, "num_env_steps_trained_throughput_per_sec": 982.7170229487419, "timesteps_total": 66000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 66000, "timers": {"training_iteration_time_ms": 32.739, "sample_time_ms": 10.001, "load_time_ms": 0.181, "load_throughput": 177208.513, "learn_time_ms": 3.836, "learn_throughput": 8341.893, "synch_weights_time_ms": 2.358}, "counters": {"num_env_steps_sampled": 66000, "num_env_steps_trained": 2080000, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 2080000, "last_target_update_ts": 65501, "num_target_updates": 130}, "done": false, "episodes_total": 8, "training_iteration": 66, "trial_id": "c28e8_00000", "date": "2023-12-11_11-31-43", "timestamp": 1702323103, "time_this_iter_s": 32.56902003288269, "time_total_s": 2598.282585144043, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2598.282585144043, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 22.764444444444447, "ram_util_percent": 94.92000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -36638.921875, "min_q": -36638.93359375, "max_q": -36638.7265625, "mean_td_error": -2241.65673828125, "model": {}}, "td_error": [388.0546875, -303.9453125, 202.0546875, -36638.9296875, -253.9453125, 405.0546875, -384.9453125, 470.0546875, -297.9453125, 442.0546875, -395.9453125, 180.0546875, 373.0546875, 489.0546875, 502.0546875, 127.0546875, -100.9453125, -180.9453125, -356.9453125, 502.0546875, 2.2578125, 457.0546875, -426.9453125, 351.0546875, 276.0546875, -36638.9296875, -428.9453125, 125.0546875, 415.0546875, -473.9453125, -481.94921875, -74.94921875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 66000.0, "diff_num_grad_updates_vs_sampler_policy": 65999.0}}, "num_env_steps_sampled": 67000, "num_env_steps_trained": 2112000, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 2112000, "last_target_update_ts": 66501, "num_target_updates": 132}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 67000, "num_env_steps_trained": 2112000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.086012285751956, "num_env_steps_trained_throughput_per_sec": 962.7523931440626, "timesteps_total": 67000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 67000, "timers": {"training_iteration_time_ms": 31.541, "sample_time_ms": 9.218, "load_time_ms": 0.216, "load_throughput": 148454.516, "learn_time_ms": 3.797, "learn_throughput": 8427.004, "synch_weights_time_ms": 2.252}, "counters": {"num_env_steps_sampled": 67000, "num_env_steps_trained": 2112000, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 2112000, "last_target_update_ts": 66501, "num_target_updates": 132}, "done": false, "episodes_total": 8, "training_iteration": 67, "trial_id": "c28e8_00000", "date": "2023-12-11_11-32-16", "timestamp": 1702323136, "time_this_iter_s": 33.244704246520996, "time_total_s": 2631.527289390564, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2631.527289390564, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 25.355319148936168, "ram_util_percent": 93.95744680851065}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -36911.7578125, "min_q": -36911.78125, "max_q": -36911.484375, "mean_td_error": -40.33740234375, "model": {}}, "td_error": [-252.16796875, -427.16796875, -81.16796875, -244.16796875, -481.16796875, -298.16796875, 383.83203125, -267.16796875, 300.83203125, 452.83203125, -377.16796875, -85.16796875, -352.16796875, -128.16796875, -48.875, -191.16796875, -352.16796875, 183.83203125, 97.83203125, -422.16796875, 2.125, 466.83203125, 387.83203125, 208.83203125, -86.16796875, -98.16796875, -402.16796875, 457.83203125, 88.83203125, 417.83203125, 268.828125, -414.171875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 67000.0, "diff_num_grad_updates_vs_sampler_policy": 66999.0}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 2144000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 2144000, "last_target_update_ts": 67501, "num_target_updates": 134}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 2144000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 2144000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.72799415474884, "num_env_steps_trained_throughput_per_sec": 983.2958129519628, "timesteps_total": 68000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 31.998, "sample_time_ms": 9.478, "load_time_ms": 0.1, "load_throughput": 320788.069, "learn_time_ms": 3.815, "learn_throughput": 8388.084, "synch_weights_time_ms": 2.542}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 2144000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 2144000, "last_target_update_ts": 67501, "num_target_updates": 134}, "done": false, "episodes_total": 8, "training_iteration": 68, "trial_id": "c28e8_00000", "date": "2023-12-11_11-32-49", "timestamp": 1702323169, "time_this_iter_s": 32.54961657524109, "time_total_s": 2664.076905965805, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2664.076905965805, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 23.0, "ram_util_percent": 90.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -37181.71875, "min_q": -37181.7734375, "max_q": -37181.37890625, "mean_td_error": 48.298583984375, "model": {}}, "td_error": [-107.5, -245.5, 497.5, 444.5, -2.109375, 226.5, -320.5, -83.5, 164.5, 497.5, -133.5, -386.5, -96.5, 148.5, 496.5, -2.109375, -2.109375, -129.5, 168.5, 155.5, -122.5, 303.5, -181.5, -2.109375, -137.5, -417.5, -307.5, -348.5, 462.5, 306.5, 218.49609375, 481.49609375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 68000.0, "diff_num_grad_updates_vs_sampler_policy": 67999.0}}, "num_env_steps_sampled": 69000, "num_env_steps_trained": 2176000, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 2176000, "last_target_update_ts": 68501, "num_target_updates": 136}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 2176000, "num_env_steps_sampled": 69000, "num_env_steps_trained": 2176000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.654160461305683, "num_env_steps_trained_throughput_per_sec": 980.9331347617818, "timesteps_total": 69000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 69000, "timers": {"training_iteration_time_ms": 31.887, "sample_time_ms": 9.637, "load_time_ms": 0.158, "load_throughput": 202684.579, "learn_time_ms": 3.97, "learn_throughput": 8061.367, "synch_weights_time_ms": 2.393}, "counters": {"num_env_steps_sampled": 69000, "num_env_steps_trained": 2176000, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 2176000, "last_target_update_ts": 68501, "num_target_updates": 136}, "done": false, "episodes_total": 8, "training_iteration": 69, "trial_id": "c28e8_00000", "date": "2023-12-11_11-33-21", "timestamp": 1702323201, "time_this_iter_s": 32.62776017189026, "time_total_s": 2696.7046661376953, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2696.7046661376953, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 23.578260869565216, "ram_util_percent": 91.49565217391303}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -37437.015625, "min_q": -37437.07421875, "max_q": -37436.609375, "mean_td_error": -35.45361328125, "model": {}}, "td_error": [253.23828125, 481.23828125, -484.76171875, 5.703125, -487.76171875, -381.76171875, -344.76171875, 5.703125, 495.23828125, -430.76171875, 410.23828125, 487.23828125, -147.76171875, 279.23828125, 175.23828125, -302.76171875, 158.23828125, -57.76171875, -46.76171875, -396.76171875, -156.76171875, -232.76171875, 174.23828125, -177.76171875, -428.76171875, 5.703125, -92.76171875, 505.23828125, -392.76171875, 227.23828125, 5.703125, -240.76171875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 69000.0, "diff_num_grad_updates_vs_sampler_policy": 68999.0}}, "num_env_steps_sampled": 70000, "num_env_steps_trained": 2208000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 2208000, "last_target_update_ts": 69501, "num_target_updates": 138}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 70000, "num_env_steps_trained": 2208000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.8199279731556, "num_env_steps_trained_throughput_per_sec": 986.2376951409792, "timesteps_total": 70000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 70000, "timers": {"training_iteration_time_ms": 32.175, "sample_time_ms": 9.465, "load_time_ms": 0.301, "load_throughput": 106429.092, "learn_time_ms": 3.586, "learn_throughput": 8924.288, "synch_weights_time_ms": 2.415}, "counters": {"num_env_steps_sampled": 70000, "num_env_steps_trained": 2208000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 2208000, "last_target_update_ts": 69501, "num_target_updates": 138}, "done": false, "episodes_total": 8, "training_iteration": 70, "trial_id": "c28e8_00000", "date": "2023-12-11_11-33-54", "timestamp": 1702323234, "time_this_iter_s": 32.45354151725769, "time_total_s": 2729.158207654953, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2729.158207654953, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 22.86, "ram_util_percent": 91.92000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -37692.5625, "min_q": -37694.9375, "max_q": -37692.0390625, "mean_td_error": -15.5269775390625, "model": {}}, "td_error": [-90.796875, 322.203125, -244.796875, -177.796875, -357.796875, 6.71484375, -312.796875, 6.71484375, -380.796875, -220.796875, -175.796875, 506.203125, 351.203125, -265.796875, 350.203125, -87.796875, -43.796875, 137.203125, 412.203125, -113.796875, 465.203125, -395.796875, -112.18359375, 66.203125, -181.796875, 243.203125, -458.796875, 6.71484375, -318.796875, 484.203125, 78.19140625, 6.703125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 70000.0, "diff_num_grad_updates_vs_sampler_policy": 69999.0}}, "num_env_steps_sampled": 71000, "num_env_steps_trained": 2240000, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 2240000, "last_target_update_ts": 70501, "num_target_updates": 140}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 71000, "num_env_steps_trained": 2240000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.074908149518212, "num_env_steps_trained_throughput_per_sec": 994.3970607845828, "timesteps_total": 71000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 71000, "timers": {"training_iteration_time_ms": 31.63, "sample_time_ms": 9.668, "load_time_ms": 0.293, "load_throughput": 109084.629, "learn_time_ms": 3.808, "learn_throughput": 8403.261, "synch_weights_time_ms": 2.298}, "counters": {"num_env_steps_sampled": 71000, "num_env_steps_trained": 2240000, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 2240000, "last_target_update_ts": 70501, "num_target_updates": 140}, "done": false, "episodes_total": 8, "training_iteration": 71, "trial_id": "c28e8_00000", "date": "2023-12-11_11-34-26", "timestamp": 1702323266, "time_this_iter_s": 32.18701529502869, "time_total_s": 2761.3452229499817, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2761.3452229499817, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 23.31111111111111, "ram_util_percent": 91.86444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -37978.5234375, "min_q": -37978.578125, "max_q": -37978.0078125, "mean_td_error": 94.2646484375, "model": {}}, "td_error": [483.3984375, 290.3984375, 393.3984375, -174.6015625, -279.6015625, -16.03125, -16.03125, 350.3984375, 447.3984375, 174.3984375, 483.3984375, 330.3984375, -187.6015625, -277.6015625, 399.3984375, -349.6015625, 225.3984375, 448.3984375, -16.03125, -253.6015625, -75.6015625, -138.6015625, 322.3984375, 358.3984375, 382.3984375, -513.6015625, 60.3984375, 271.3984375, 84.3984375, -268.6015625, -393.59765625, 471.40234375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 71000.0, "diff_num_grad_updates_vs_sampler_policy": 70999.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 2272000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 2272000, "last_target_update_ts": 71501, "num_target_updates": 142}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 2272000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 2272000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.160577704063662, "num_env_steps_trained_throughput_per_sec": 997.1384865300372, "timesteps_total": 72000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 31.697, "sample_time_ms": 9.49, "load_time_ms": 0.471, "load_throughput": 67886.161, "learn_time_ms": 3.782, "learn_throughput": 8461.803, "synch_weights_time_ms": 2.262}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 2272000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 2272000, "last_target_update_ts": 71501, "num_target_updates": 142}, "done": false, "episodes_total": 8, "training_iteration": 72, "trial_id": "c28e8_00000", "date": "2023-12-11_11-34-58", "timestamp": 1702323298, "time_this_iter_s": 32.09901022911072, "time_total_s": 2793.4442331790924, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2793.4442331790924, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 23.439999999999998, "ram_util_percent": 91.65555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -38248.11328125, "min_q": -38248.17578125, "max_q": -38247.52734375, "mean_td_error": 106.427978515625, "model": {}}, "td_error": [323.9921875, -4.359375, -84.0078125, -379.0078125, 234.9921875, 485.9921875, 374.9921875, 419.9921875, 494.9921875, -272.0078125, -419.0078125, 379.9921875, 487.9921875, 427.9921875, -438.0078125, -458.0078125, -4.359375, 374.9921875, -190.0078125, 280.9921875, 389.9921875, -391.0078125, 304.9921875, -407.0078125, -396.0078125, 373.9921875, 441.9921875, 452.9921875, -227.0078125, 361.9921875, 466.9921875, -4.359375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 72000.0, "diff_num_grad_updates_vs_sampler_policy": 71999.0}}, "num_env_steps_sampled": 73000, "num_env_steps_trained": 2304000, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 2304000, "last_target_update_ts": 72501, "num_target_updates": 144}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 73000, "num_env_steps_trained": 2304000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.961078330597196, "num_env_steps_trained_throughput_per_sec": 990.7545065791103, "timesteps_total": 73000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 73000, "timers": {"training_iteration_time_ms": 30.977, "sample_time_ms": 8.832, "load_time_ms": 0.5, "load_throughput": 63989.382, "learn_time_ms": 3.692, "learn_throughput": 8666.365, "synch_weights_time_ms": 2.416}, "counters": {"num_env_steps_sampled": 73000, "num_env_steps_trained": 2304000, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 2304000, "last_target_update_ts": 72501, "num_target_updates": 144}, "done": false, "episodes_total": 8, "training_iteration": 73, "trial_id": "c28e8_00000", "date": "2023-12-11_11-35-30", "timestamp": 1702323330, "time_this_iter_s": 32.30586242675781, "time_total_s": 2825.75009560585, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2825.75009560585, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 24.03777777777778, "ram_util_percent": 91.61999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -38479.125, "min_q": -38479.2109375, "max_q": -38478.51953125, "mean_td_error": 191.39892578125, "model": {}}, "td_error": [432.6875, -326.3125, 457.6875, 121.6875, -2.62109375, 371.6875, 496.6875, 362.6875, 440.6875, -464.3125, 202.6875, 143.6875, 451.6875, 426.6875, 93.6875, 496.6875, 414.6875, 193.6875, 107.6875, 178.6875, -2.62109375, 136.6875, 445.6875, 343.6875, -2.62109375, 491.6875, -2.62109375, -309.3125, -279.3125, 125.6875, 256.6875, 320.6875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 73000.0, "diff_num_grad_updates_vs_sampler_policy": 72999.0}}, "num_env_steps_sampled": 74000, "num_env_steps_trained": 2336000, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 2336000, "last_target_update_ts": 73501, "num_target_updates": 146}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 2336000, "num_env_steps_sampled": 74000, "num_env_steps_trained": 2336000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.581863603603896, "num_env_steps_trained_throughput_per_sec": 978.6196353153247, "timesteps_total": 74000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 74000, "timers": {"training_iteration_time_ms": 31.566, "sample_time_ms": 9.203, "load_time_ms": 0.297, "load_throughput": 107692.954, "learn_time_ms": 4.002, "learn_throughput": 7996.624, "synch_weights_time_ms": 2.534}, "counters": {"num_env_steps_sampled": 74000, "num_env_steps_trained": 2336000, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 2336000, "last_target_update_ts": 73501, "num_target_updates": 146}, "done": false, "episodes_total": 8, "training_iteration": 74, "trial_id": "c28e8_00000", "date": "2023-12-11_11-36-03", "timestamp": 1702323363, "time_this_iter_s": 32.70513367652893, "time_total_s": 2858.455229282379, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2858.455229282379, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 22.971739130434784, "ram_util_percent": 91.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -38703.9375, "min_q": -38704.078125, "max_q": -38703.34765625, "mean_td_error": 58.847900390625, "model": {}}, "td_error": [-384.1328125, -149.1328125, 477.8671875, -223.1328125, -176.1328125, 85.8671875, -0.40234375, 481.8671875, -0.40234375, 72.8671875, 498.8671875, -0.40234375, -398.1328125, -276.1328125, -333.1328125, -148.1328125, 306.8671875, 163.8671875, 335.8671875, 347.8671875, -288.1328125, 328.8671875, -114.1328125, 258.59765625, -82.1328125, -0.40234375, 390.8671875, 206.8671875, 341.8671875, -340.1328125, 498.8671875, -0.40234375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 74000.0, "diff_num_grad_updates_vs_sampler_policy": 73999.0}}, "num_env_steps_sampled": 75000, "num_env_steps_trained": 2368000, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 2368000, "last_target_update_ts": 74501, "num_target_updates": 148}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 2368000, "num_env_steps_sampled": 75000, "num_env_steps_trained": 2368000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.675437365090783, "num_env_steps_trained_throughput_per_sec": 885.613995682905, "timesteps_total": 75000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 75000, "timers": {"training_iteration_time_ms": 35.916, "sample_time_ms": 10.816, "load_time_ms": 0.553, "load_throughput": 57830.035, "learn_time_ms": 4.307, "learn_throughput": 7430.04, "synch_weights_time_ms": 2.744}, "counters": {"num_env_steps_sampled": 75000, "num_env_steps_trained": 2368000, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 2368000, "last_target_update_ts": 74501, "num_target_updates": 148}, "done": false, "episodes_total": 8, "training_iteration": 75, "trial_id": "c28e8_00000", "date": "2023-12-11_11-36-39", "timestamp": 1702323399, "time_this_iter_s": 36.14013385772705, "time_total_s": 2894.595363140106, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2894.595363140106, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 31.465999999999998, "ram_util_percent": 92.34000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -38908.7578125, "min_q": -38908.83984375, "max_q": -38907.9765625, "mean_td_error": 46.7918701171875, "model": {}}, "td_error": [492.8984375, 437.8984375, -6.23828125, 371.8984375, -6.23828125, -208.1015625, -153.1015625, -288.1015625, 395.8984375, -445.1015625, -51.1015625, 428.8984375, 311.8984375, -472.1015625, -256.1015625, 265.8984375, 290.8984375, 157.8984375, -242.1015625, -414.1015625, -273.1015625, 187.8984375, -404.1015625, 155.8984375, 380.8984375, -351.1015625, 290.8984375, -6.23828125, 211.8984375, 397.8984375, 462.8984375, -168.1015625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 75000.0, "diff_num_grad_updates_vs_sampler_policy": 74999.0}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 2400000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 2400000, "last_target_update_ts": 75501, "num_target_updates": 150}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 2400000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 3.9312030616367326, "num_env_steps_trained_throughput_per_sec": 125.79849797237544, "timesteps_total": 76000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 31.484, "sample_time_ms": 9.524, "load_time_ms": 0.142, "load_throughput": 225651.863, "learn_time_ms": 3.508, "learn_throughput": 9123.01, "synch_weights_time_ms": 2.373}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 2400000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 2400000, "last_target_update_ts": 75501, "num_target_updates": 150}, "done": false, "episodes_total": 8, "training_iteration": 76, "trial_id": "c28e8_00000", "date": "2023-12-11_11-40-54", "timestamp": 1702323654, "time_this_iter_s": 254.3840537071228, "time_total_s": 3148.979416847229, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3148.979416847229, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 38.667857142857144, "ram_util_percent": 94.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -39125.8125, "min_q": -39125.87109375, "max_q": -39124.9375, "mean_td_error": 73.37890625, "model": {}}, "td_error": [-174.2734375, 453.7265625, 353.7265625, -191.2734375, -394.2734375, -127.2734375, 426.7265625, 220.7265625, 8.66015625, 504.7265625, 390.7265625, -305.2734375, -134.2734375, -295.2734375, 133.7265625, 507.7265625, -36.2734375, 111.7265625, -386.2734375, -476.2734375, 150.7265625, 498.7265625, 420.7265625, -331.2734375, 286.7265625, 143.7265625, 412.7265625, 507.7265625, 447.7265625, 8.66015625, -425.26953125, -364.26953125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 76000.0, "diff_num_grad_updates_vs_sampler_policy": 75999.0}}, "num_env_steps_sampled": 77000, "num_env_steps_trained": 2432000, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 2432000, "last_target_update_ts": 76501, "num_target_updates": 152}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 2432000, "num_env_steps_sampled": 77000, "num_env_steps_trained": 2432000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.801654811874826, "num_env_steps_trained_throughput_per_sec": 921.6529539799944, "timesteps_total": 77000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 77000, "timers": {"training_iteration_time_ms": 46.03, "sample_time_ms": 14.016, "load_time_ms": 0.311, "load_throughput": 102990.89, "learn_time_ms": 4.567, "learn_throughput": 7007.149, "synch_weights_time_ms": 3.518}, "counters": {"num_env_steps_sampled": 77000, "num_env_steps_trained": 2432000, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 2432000, "last_target_update_ts": 76501, "num_target_updates": 152}, "done": false, "episodes_total": 8, "training_iteration": 77, "trial_id": "c28e8_00000", "date": "2023-12-11_11-41-29", "timestamp": 1702323689, "time_this_iter_s": 34.73121523857117, "time_total_s": 3183.7106320858, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3183.7106320858, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 29.893877551020402, "ram_util_percent": 93.68163265306121}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -39361.9140625, "min_q": -39361.9765625, "max_q": -39360.9765625, "mean_td_error": 134.875, "model": {}}, "td_error": [244.59375, -42.40625, 346.59375, 367.59375, 335.59375, -254.40625, 178.59375, 181.59375, 456.59375, 448.59375, -293.40625, 416.59375, 52.59375, -292.40625, 365.59375, -482.40625, 406.59375, 376.59375, 361.59375, 76.59375, 401.59375, 406.59375, 169.59375, -326.40625, 370.59375, -265.40625, -430.40625, 393.59375, -268.40625, 433.59375, -42.40625, 222.59375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 77000.0, "diff_num_grad_updates_vs_sampler_policy": 76999.0}}, "num_env_steps_sampled": 78000, "num_env_steps_trained": 2464000, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 2464000, "last_target_update_ts": 77501, "num_target_updates": 154}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 2464000, "num_env_steps_sampled": 78000, "num_env_steps_trained": 2464000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 25.426618057939887, "num_env_steps_trained_throughput_per_sec": 813.6517778540764, "timesteps_total": 78000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 78000, "timers": {"training_iteration_time_ms": 34.489, "sample_time_ms": 10.689, "load_time_ms": 0.101, "load_throughput": 315955.104, "learn_time_ms": 3.924, "learn_throughput": 8155.711, "synch_weights_time_ms": 2.508}, "counters": {"num_env_steps_sampled": 78000, "num_env_steps_trained": 2464000, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 2464000, "last_target_update_ts": 77501, "num_target_updates": 154}, "done": false, "episodes_total": 8, "training_iteration": 78, "trial_id": "c28e8_00000", "date": "2023-12-11_11-42-08", "timestamp": 1702323728, "time_this_iter_s": 39.33488702774048, "time_total_s": 3223.0455191135406, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3223.0455191135406, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 33.51090909090909, "ram_util_percent": 93.19090909090913}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -39559.8359375, "min_q": -39559.8359375, "max_q": -39559.8359375, "mean_td_error": 47.83984375, "model": {}}, "td_error": [-51.75390625, -347.75390625, -414.75390625, 389.24609375, 447.24609375, 478.24609375, -345.75390625, 117.24609375, 322.24609375, 397.24609375, 234.24609375, 449.24609375, -433.75390625, -270.75390625, -271.75390625, -414.75390625, 12.24609375, 498.24609375, -317.75390625, -405.75390625, -393.75390625, 206.24609375, 498.24609375, 469.24609375, 285.24609375, -29.75390625, -104.75390625, -375.75390625, 431.24609375, 475.24609375, -354.75390625, 353.24609375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 78000.0, "diff_num_grad_updates_vs_sampler_policy": 77999.0}}, "num_env_steps_sampled": 79000, "num_env_steps_trained": 2496000, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 2496000, "last_target_update_ts": 78501, "num_target_updates": 156}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 2496000, "num_env_steps_sampled": 79000, "num_env_steps_trained": 2496000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.4249562623542, "num_env_steps_trained_throughput_per_sec": 909.5986003953344, "timesteps_total": 79000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 79000, "timers": {"training_iteration_time_ms": 33.996, "sample_time_ms": 10.46, "load_time_ms": 0.302, "load_throughput": 105933.487, "learn_time_ms": 3.913, "learn_throughput": 8178.771, "synch_weights_time_ms": 2.435}, "counters": {"num_env_steps_sampled": 79000, "num_env_steps_trained": 2496000, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 2496000, "last_target_update_ts": 78501, "num_target_updates": 156}, "done": false, "episodes_total": 8, "training_iteration": 79, "trial_id": "c28e8_00000", "date": "2023-12-11_11-42-43", "timestamp": 1702323763, "time_this_iter_s": 35.18791913986206, "time_total_s": 3258.2334382534027, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3258.2334382534027, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 22.651020408163266, "ram_util_percent": 89.99183673469389}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -39794.1484375, "min_q": -39796.10546875, "max_q": -39793.1171875, "mean_td_error": -1131.4735107421875, "model": {}}, "td_error": [-393.0390625, 475.16796875, 277.9609375, 414.9609375, -293.0390625, -21.84375, 454.9609375, 316.9609375, -408.0390625, 180.9609375, 345.9609375, -447.0390625, 401.9609375, -514.0390625, 430.9609375, 249.9609375, 443.9609375, 122.9609375, -184.0390625, 309.9609375, -21.84375, -21.84375, 360.9609375, 427.9609375, 98.9609375, -39794.3125, -21.84375, 453.9609375, -222.0390625, -21.84375, -21.84765625, 410.95703125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 79000.0, "diff_num_grad_updates_vs_sampler_policy": 78999.0}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 2528000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 2528000, "last_target_update_ts": 79501, "num_target_updates": 158}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 2528000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 2528000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.939094816423243, "num_env_steps_trained_throughput_per_sec": 894.0510341255438, "timesteps_total": 80000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 29.717, "sample_time_ms": 8.75, "load_time_ms": 0.097, "load_throughput": 330097.708, "learn_time_ms": 3.781, "learn_throughput": 8463.51, "synch_weights_time_ms": 2.687}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 2528000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 2528000, "last_target_update_ts": 79501, "num_target_updates": 158}, "done": false, "episodes_total": 8, "training_iteration": 80, "trial_id": "c28e8_00000", "date": "2023-12-11_11-43-19", "timestamp": 1702323799, "time_this_iter_s": 35.79784631729126, "time_total_s": 3294.031284570694, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3294.031284570694, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 27.729999999999997, "ram_util_percent": 91.21799999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -39980.8984375, "min_q": -39981.0234375, "max_q": -39979.7265625, "mean_td_error": 23.85205078125, "model": {}}, "td_error": [-0.67578125, -267.67578125, 499.32421875, 185.32421875, 253.32421875, -228.67578125, -393.37890625, 471.32421875, 253.32421875, 0.62109375, 372.32421875, 229.32421875, 394.32421875, 110.32421875, 134.32421875, 164.32421875, 239.32421875, -163.67578125, 458.32421875, -435.67578125, 0.62109375, -399.67578125, -225.67578125, -124.67578125, 499.32421875, -298.67578125, 499.32421875, -472.67578125, -131.67578125, -446.67578125, -87.67578125, -324.67578125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 80000.0, "diff_num_grad_updates_vs_sampler_policy": 79999.0}}, "num_env_steps_sampled": 81000, "num_env_steps_trained": 2560000, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 2560000, "last_target_update_ts": 80501, "num_target_updates": 160}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 81000, "num_env_steps_trained": 2560000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 24.083696412477217, "num_env_steps_trained_throughput_per_sec": 770.6782851992709, "timesteps_total": 81000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 81000, "timers": {"training_iteration_time_ms": 41.714, "sample_time_ms": 11.856, "load_time_ms": 0.423, "load_throughput": 75658.246, "learn_time_ms": 4.403, "learn_throughput": 7267.937, "synch_weights_time_ms": 2.932}, "counters": {"num_env_steps_sampled": 81000, "num_env_steps_trained": 2560000, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 2560000, "last_target_update_ts": 80501, "num_target_updates": 160}, "done": false, "episodes_total": 8, "training_iteration": 81, "trial_id": "c28e8_00000", "date": "2023-12-11_11-44-01", "timestamp": 1702323841, "time_this_iter_s": 41.528719425201416, "time_total_s": 3335.5600039958954, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3335.5600039958954, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 40.72931034482758, "ram_util_percent": 93.50000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -40177.7421875, "min_q": -40179.44140625, "max_q": -40176.40625, "mean_td_error": 64.0784912109375, "model": {}}, "td_error": [-368.44140625, 299.55859375, 247.55859375, -288.44140625, 498.55859375, -341.44140625, -338.44140625, -453.44140625, -180.44140625, 256.55859375, 470.55859375, -427.44140625, 374.94140625, -355.44140625, -150.44140625, 297.55859375, 279.55859375, 401.55859375, -0.0234375, -188.44140625, 453.55859375, 367.55859375, 462.55859375, -212.44140625, -0.0234375, -0.0234375, 479.55859375, 344.55859375, -291.44140625, 404.55859375, -439.44140625, 447.55859375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 81000.0, "diff_num_grad_updates_vs_sampler_policy": 80999.0}}, "num_env_steps_sampled": 82000, "num_env_steps_trained": 2592000, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 2592000, "last_target_update_ts": 81501, "num_target_updates": 162}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 2592000, "num_env_steps_sampled": 82000, "num_env_steps_trained": 2592000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.410061287995518, "num_env_steps_trained_throughput_per_sec": 909.1219612158566, "timesteps_total": 82000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 82000, "timers": {"training_iteration_time_ms": 36.405, "sample_time_ms": 11.075, "load_time_ms": 0.303, "load_throughput": 105649.975, "learn_time_ms": 4.226, "learn_throughput": 7571.416, "synch_weights_time_ms": 3.129}, "counters": {"num_env_steps_sampled": 82000, "num_env_steps_trained": 2592000, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 2592000, "last_target_update_ts": 81501, "num_target_updates": 162}, "done": false, "episodes_total": 8, "training_iteration": 82, "trial_id": "c28e8_00000", "date": "2023-12-11_11-44-36", "timestamp": 1702323876, "time_this_iter_s": 35.205806732177734, "time_total_s": 3370.765810728073, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3370.765810728073, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 29.195918367346938, "ram_util_percent": 93.5326530612245}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -40398.9921875, "min_q": -40399.0859375, "max_q": -40397.6015625, "mean_td_error": 73.647705078125, "model": {}}, "td_error": [-218.5390625, 137.4609375, 398.4609375, 275.4609375, 341.4609375, 221.4609375, 295.4609375, -1.0546875, -239.5390625, -341.5390625, 126.4609375, -236.5390625, 350.4609375, 429.4609375, 44.4609375, -49.5390625, 497.4609375, -256.5390625, -470.5390625, 393.4609375, -352.5390625, -221.5390625, 229.4609375, 152.4609375, 354.4609375, 151.4609375, -1.0546875, 472.4609375, 70.4609375, -49.5390625, -453.53515625, 306.46484375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 82000.0, "diff_num_grad_updates_vs_sampler_policy": 81999.0}}, "num_env_steps_sampled": 83000, "num_env_steps_trained": 2624000, "num_agent_steps_sampled": 83000, "num_agent_steps_trained": 2624000, "last_target_update_ts": 82501, "num_target_updates": 164}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83000, "num_agent_steps_trained": 2624000, "num_env_steps_sampled": 83000, "num_env_steps_trained": 2624000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.487915647339666, "num_env_steps_trained_throughput_per_sec": 879.6133007148693, "timesteps_total": 83000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 83000, "timers": {"training_iteration_time_ms": 32.527, "sample_time_ms": 9.507, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 4.103, "learn_throughput": 7800.0, "synch_weights_time_ms": 2.635}, "counters": {"num_env_steps_sampled": 83000, "num_env_steps_trained": 2624000, "num_agent_steps_sampled": 83000, "num_agent_steps_trained": 2624000, "last_target_update_ts": 82501, "num_target_updates": 164}, "done": false, "episodes_total": 8, "training_iteration": 83, "trial_id": "c28e8_00000", "date": "2023-12-11_11-45-12", "timestamp": 1702323912, "time_this_iter_s": 36.385608434677124, "time_total_s": 3407.1514191627502, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3407.1514191627502, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 31.029411764705884, "ram_util_percent": 93.79607843137254}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -40576.85546875, "min_q": -40577.109375, "max_q": -40575.48828125, "mean_td_error": 23.533447265625, "model": {}}, "td_error": [416.75, 156.75, -2.6328125, -455.25, 286.75, 432.75, 455.75, -396.25, -2.6328125, 162.75, -220.25, -2.6328125, 283.75, -430.25, -2.6328125, -344.25, -289.25, -2.6328125, 280.75, 489.75, 301.75, -430.25, 446.75, -460.25, 191.75, 392.75, -480.25, -255.25, 234.75, 495.75, -309.2578125, -192.2578125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 83000.0, "diff_num_grad_updates_vs_sampler_policy": 82999.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 2656000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 2656000, "last_target_update_ts": 83501, "num_target_updates": 166}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 2656000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 2656000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 24.378141763952367, "num_env_steps_trained_throughput_per_sec": 780.1005364464758, "timesteps_total": 84000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 52.253, "sample_time_ms": 15.322, "load_time_ms": 0.415, "load_throughput": 77189.86, "learn_time_ms": 4.854, "learn_throughput": 6592.809, "synch_weights_time_ms": 3.066}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 2656000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 2656000, "last_target_update_ts": 83501, "num_target_updates": 166}, "done": false, "episodes_total": 8, "training_iteration": 84, "trial_id": "c28e8_00000", "date": "2023-12-11_11-45-53", "timestamp": 1702323953, "time_this_iter_s": 41.030275106430054, "time_total_s": 3448.1816942691803, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3448.1816942691803, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 36.82807017543859, "ram_util_percent": 89.41228070175438}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -40762.37109375, "min_q": -40763.8359375, "max_q": -40760.7265625, "mean_td_error": 57.496337890625, "model": {}}, "td_error": [85.515625, 454.515625, -392.484375, 467.515625, -276.484375, -355.484375, -174.484375, -340.484375, -7.765625, 347.515625, -275.484375, 186.515625, 410.515625, 95.515625, 271.515625, 278.515625, 258.515625, 473.515625, -130.875, 452.125, 156.515625, -195.484375, -265.484375, 367.515625, 150.515625, -7.765625, -7.765625, 257.515625, -303.484375, -337.484375, 490.51953125, -293.48046875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 84000.0, "diff_num_grad_updates_vs_sampler_policy": 83999.0}}, "num_env_steps_sampled": 85000, "num_env_steps_trained": 2688000, "num_agent_steps_sampled": 85000, "num_agent_steps_trained": 2688000, "last_target_update_ts": 84501, "num_target_updates": 168}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85000, "num_agent_steps_trained": 2688000, "num_env_steps_sampled": 85000, "num_env_steps_trained": 2688000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 26.496720737811835, "num_env_steps_trained_throughput_per_sec": 847.8950636099787, "timesteps_total": 85000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 85000, "timers": {"training_iteration_time_ms": 35.168, "sample_time_ms": 10.842, "load_time_ms": 0.399, "load_throughput": 80125.203, "learn_time_ms": 3.701, "learn_throughput": 8646.879, "synch_weights_time_ms": 2.273}, "counters": {"num_env_steps_sampled": 85000, "num_env_steps_trained": 2688000, "num_agent_steps_sampled": 85000, "num_agent_steps_trained": 2688000, "last_target_update_ts": 84501, "num_target_updates": 168}, "done": false, "episodes_total": 8, "training_iteration": 85, "trial_id": "c28e8_00000", "date": "2023-12-11_11-46-31", "timestamp": 1702323991, "time_this_iter_s": 37.747530937194824, "time_total_s": 3485.929225206375, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3485.929225206375, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 31.380769230769236, "ram_util_percent": 86.85576923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -40960.359375, "min_q": -40960.53125, "max_q": -40958.68359375, "mean_td_error": -16.1119384765625, "model": {}}, "td_error": [-204.81640625, 352.18359375, -390.81640625, -323.81640625, -280.81640625, 342.18359375, 292.18359375, -465.81640625, -7.96875, -478.81640625, -264.81640625, -293.81640625, 221.18359375, 427.18359375, -464.81640625, 457.18359375, -444.81640625, -7.96875, -339.81640625, -328.81640625, -52.81640625, 490.18359375, 463.18359375, -337.81640625, 96.18359375, -7.96875, 490.18359375, -340.81640625, 377.18359375, 441.18359375, 466.18359375, -394.81640625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 85000.0, "diff_num_grad_updates_vs_sampler_policy": 84999.0}}, "num_env_steps_sampled": 86000, "num_env_steps_trained": 2720000, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 2720000, "last_target_update_ts": 85501, "num_target_updates": 170}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 86000, "num_env_steps_trained": 2720000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.326973490111556, "num_env_steps_trained_throughput_per_sec": 874.4631516835698, "timesteps_total": 86000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 86000, "timers": {"training_iteration_time_ms": 39.975, "sample_time_ms": 12.19, "load_time_ms": 0.248, "load_throughput": 129030.694, "learn_time_ms": 4.048, "learn_throughput": 7905.624, "synch_weights_time_ms": 3.051}, "counters": {"num_env_steps_sampled": 86000, "num_env_steps_trained": 2720000, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 2720000, "last_target_update_ts": 85501, "num_target_updates": 170}, "done": false, "episodes_total": 8, "training_iteration": 86, "trial_id": "c28e8_00000", "date": "2023-12-11_11-47-08", "timestamp": 1702324028, "time_this_iter_s": 36.60388135910034, "time_total_s": 3522.5331065654755, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3522.5331065654755, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 28.765384615384612, "ram_util_percent": 86.70769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -41140.9765625, "min_q": -41142.3359375, "max_q": -41139.1796875, "mean_td_error": 26.476318359375, "model": {}}, "td_error": [397.80078125, 398.80078125, -209.19921875, 465.80078125, 321.80078125, -446.19921875, -324.19921875, -150.19921875, 431.80078125, -378.19921875, -238.19921875, 109.80078125, 469.80078125, 178.80078125, -349.4140625, 315.80078125, -491.19921875, -116.19921875, 352.80078125, -382.19921875, 466.80078125, -338.19921875, -4.19921875, -474.19921875, 284.80078125, -464.19921875, -28.2578125, -28.2578125, 233.80078125, 445.80078125, -28.25390625, 423.8046875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 86000.0, "diff_num_grad_updates_vs_sampler_policy": 85999.0}}, "num_env_steps_sampled": 87000, "num_env_steps_trained": 2752000, "num_agent_steps_sampled": 87000, "num_agent_steps_trained": 2752000, "last_target_update_ts": 86501, "num_target_updates": 172}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87000, "num_agent_steps_trained": 2752000, "num_env_steps_sampled": 87000, "num_env_steps_trained": 2752000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.309807747815235, "num_env_steps_trained_throughput_per_sec": 905.9138479300875, "timesteps_total": 87000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 87000, "timers": {"training_iteration_time_ms": 32.201, "sample_time_ms": 10.091, "load_time_ms": 0.23, "load_throughput": 139273.351, "learn_time_ms": 3.67, "learn_throughput": 8719.457, "synch_weights_time_ms": 2.339}, "counters": {"num_env_steps_sampled": 87000, "num_env_steps_trained": 2752000, "num_agent_steps_sampled": 87000, "num_agent_steps_trained": 2752000, "last_target_update_ts": 86501, "num_target_updates": 172}, "done": false, "episodes_total": 8, "training_iteration": 87, "trial_id": "c28e8_00000", "date": "2023-12-11_11-47-43", "timestamp": 1702324063, "time_this_iter_s": 35.33045744895935, "time_total_s": 3557.863564014435, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3557.863564014435, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 27.230612244897962, "ram_util_percent": 84.34285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -41319.9296875, "min_q": -41321.1640625, "max_q": -41317.9765625, "mean_td_error": 63.522216796875, "model": {}}, "td_error": [169.2734375, 311.2734375, 50.2734375, 330.2734375, 467.2734375, 473.2734375, 496.2734375, -358.7265625, 220.2734375, 473.2734375, -327.7265625, 420.2734375, 263.2734375, 128.2734375, 155.1328125, -388.7265625, 470.2734375, 82.2734375, 363.2734375, -466.7265625, 82.2734375, -299.7265625, -230.7265625, -1.68359375, -433.7265625, -399.7265625, 357.2734375, -178.7265625, 413.2734375, -238.7265625, -367.71875, -1.67578125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 87000.0, "diff_num_grad_updates_vs_sampler_policy": 86999.0}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 2784000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 2784000, "last_target_update_ts": 87501, "num_target_updates": 174}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 2784000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 2784000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.140959423558062, "num_env_steps_trained_throughput_per_sec": 964.510701553858, "timesteps_total": 88000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 33.2, "sample_time_ms": 9.826, "load_time_ms": 0.197, "load_throughput": 162550.234, "learn_time_ms": 3.689, "learn_throughput": 8675.608, "synch_weights_time_ms": 2.621}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 2784000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 2784000, "last_target_update_ts": 87501, "num_target_updates": 174}, "done": false, "episodes_total": 8, "training_iteration": 88, "trial_id": "c28e8_00000", "date": "2023-12-11_11-48-16", "timestamp": 1702324096, "time_this_iter_s": 33.18345332145691, "time_total_s": 3591.0470173358917, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3591.0470173358917, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 25.652173913043473, "ram_util_percent": 84.64347826086957}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -41465.84375, "min_q": -41466.11328125, "max_q": -41463.93359375, "mean_td_error": -1257.0177001953125, "model": {}}, "td_error": [-229.328125, -425.328125, -291.328125, 84.671875, 459.671875, -1.1484375, 230.671875, -281.328125, 425.671875, -450.328125, -149.328125, 487.671875, 113.671875, -1.1484375, -41466.11328125, -47.328125, -320.328125, 393.671875, 483.671875, -65.328125, 318.671875, 363.671875, -112.328125, -335.328125, -1.1484375, 349.671875, 449.671875, -474.328125, -1.1484375, 496.671875, -358.328125, 128.671875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 88000.0, "diff_num_grad_updates_vs_sampler_policy": 87999.0}}, "num_env_steps_sampled": 89000, "num_env_steps_trained": 2816000, "num_agent_steps_sampled": 89000, "num_agent_steps_trained": 2816000, "last_target_update_ts": 88501, "num_target_updates": 176}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89000, "num_agent_steps_trained": 2816000, "num_env_steps_sampled": 89000, "num_env_steps_trained": 2816000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 26.256539612734596, "num_env_steps_trained_throughput_per_sec": 840.2092676075071, "timesteps_total": 89000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 89000, "timers": {"training_iteration_time_ms": 41.396, "sample_time_ms": 12.202, "load_time_ms": 0.302, "load_throughput": 106050.67, "learn_time_ms": 4.375, "learn_throughput": 7315.075, "synch_weights_time_ms": 2.937}, "counters": {"num_env_steps_sampled": 89000, "num_env_steps_trained": 2816000, "num_agent_steps_sampled": 89000, "num_agent_steps_trained": 2816000, "last_target_update_ts": 88501, "num_target_updates": 176}, "done": false, "episodes_total": 8, "training_iteration": 89, "trial_id": "c28e8_00000", "date": "2023-12-11_11-48-55", "timestamp": 1702324135, "time_this_iter_s": 38.096723794937134, "time_total_s": 3629.143741130829, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3629.143741130829, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 29.857407407407408, "ram_util_percent": 86.17407407407407}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -41633.859375, "min_q": -41634.07421875, "max_q": -41631.8125, "mean_td_error": 11.3409423828125, "model": {}}, "td_error": [196.06640625, 473.06640625, 309.06640625, -87.93359375, 44.06640625, -288.93359375, -396.93359375, 179.06640625, -437.93359375, -7.671875, -413.93359375, -382.93359375, -295.93359375, 455.06640625, -80.93359375, -7.671875, 154.06640625, 27.06640625, -413.93359375, -51.93359375, -90.93359375, 427.06640625, -7.671875, 240.06640625, 490.06640625, -228.93359375, 368.06640625, -468.93359375, 490.06640625, -462.93359375, 332.06640625, 304.06640625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 89000.0, "diff_num_grad_updates_vs_sampler_policy": 88999.0}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 2848000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 2848000, "last_target_update_ts": 89501, "num_target_updates": 178}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 2848000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 2848000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 26.28739681503074, "num_env_steps_trained_throughput_per_sec": 841.1966980809837, "timesteps_total": 90000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 40.214, "sample_time_ms": 14.187, "load_time_ms": 0.41, "load_throughput": 78056.254, "learn_time_ms": 3.94, "learn_throughput": 8122.249, "synch_weights_time_ms": 2.451}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 2848000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 2848000, "last_target_update_ts": 89501, "num_target_updates": 178}, "done": false, "episodes_total": 8, "training_iteration": 90, "trial_id": "c28e8_00000", "date": "2023-12-11_11-49-33", "timestamp": 1702324173, "time_this_iter_s": 38.05007219314575, "time_total_s": 3667.1938133239746, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3667.1938133239746, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 26.69622641509434, "ram_util_percent": 86.50377358490564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -41849.1328125, "min_q": -41849.35546875, "max_q": -41846.95703125, "mean_td_error": -20.900390625, "model": {}}, "td_error": [-375.875, -527.875, 205.125, -281.875, 301.125, -28.4765625, -422.875, 392.125, 208.125, 349.125, -285.875, -28.4765625, -502.875, -266.875, -71.875, 259.125, 197.125, 253.125, -81.875, -311.875, 21.125, 399.125, 338.125, -28.4765625, 219.125, -461.875, 283.125, -128.875, -347.875, -179.875, 469.12109375, -229.87890625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 90000.0, "diff_num_grad_updates_vs_sampler_policy": 89999.0}}, "num_env_steps_sampled": 91000, "num_env_steps_trained": 2880000, "num_agent_steps_sampled": 91000, "num_agent_steps_trained": 2880000, "last_target_update_ts": 90501, "num_target_updates": 180}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 91000, "num_env_steps_trained": 2880000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.310643956996575, "num_env_steps_trained_throughput_per_sec": 873.9406066238904, "timesteps_total": 91000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 91000, "timers": {"training_iteration_time_ms": 35.936, "sample_time_ms": 11.416, "load_time_ms": 0.301, "load_throughput": 106327.916, "learn_time_ms": 4.029, "learn_throughput": 7941.971, "synch_weights_time_ms": 2.869}, "counters": {"num_env_steps_sampled": 91000, "num_env_steps_trained": 2880000, "num_agent_steps_sampled": 91000, "num_agent_steps_trained": 2880000, "last_target_update_ts": 90501, "num_target_updates": 180}, "done": false, "episodes_total": 8, "training_iteration": 91, "trial_id": "c28e8_00000", "date": "2023-12-11_11-50-09", "timestamp": 1702324209, "time_this_iter_s": 36.62471318244934, "time_total_s": 3703.818526506424, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3703.818526506424, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 26.288235294117648, "ram_util_percent": 86.63921568627454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -41996.91796875, "min_q": -41996.99609375, "max_q": -41994.5390625, "mean_td_error": -1272.216552734375, "model": {}}, "td_error": [-408.3671875, 6.08984375, 371.6328125, -346.3671875, 332.6328125, 427.6328125, -224.3671875, -372.3671875, 370.6328125, -412.3671875, 485.6328125, 415.6328125, -41996.99609375, -260.3671875, 275.6328125, -135.3671875, -208.3671875, -397.3671875, -376.3671875, 194.6328125, 449.6328125, 429.6328125, 281.6328125, 303.6328125, 41.6328125, -447.3671875, 88.6328125, 232.6328125, 327.6328125, -275.3671875, -280.37109375, 395.62890625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 91000.0, "diff_num_grad_updates_vs_sampler_policy": 90999.0}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 2912000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 2912000, "last_target_update_ts": 91501, "num_target_updates": 182}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 2912000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 2912000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 24.536790209245627, "num_env_steps_trained_throughput_per_sec": 785.1772866958601, "timesteps_total": 92000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 51.718, "sample_time_ms": 15.521, "load_time_ms": 0.314, "load_throughput": 101849.847, "learn_time_ms": 5.505, "learn_throughput": 5812.984, "synch_weights_time_ms": 4.057}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 2912000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 2912000, "last_target_update_ts": 91501, "num_target_updates": 182}, "done": false, "episodes_total": 8, "training_iteration": 92, "trial_id": "c28e8_00000", "date": "2023-12-11_11-50-50", "timestamp": 1702324250, "time_this_iter_s": 40.76312780380249, "time_total_s": 3744.5816543102264, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3744.5816543102264, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 34.343636363636364, "ram_util_percent": 88.27636363636366}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -42187.5703125, "min_q": -42187.8125, "max_q": -42185.23046875, "mean_td_error": -12.9688720703125, "model": {}}, "td_error": [-346.3671875, -265.3671875, -255.3671875, 463.6328125, -130.3671875, -422.78515625, -330.3671875, -392.3671875, -492.3671875, 475.6328125, -218.3671875, -369.3671875, -381.3671875, 382.6328125, 288.6328125, -482.3671875, 174.6328125, 345.6328125, 493.6328125, 284.6328125, 377.6328125, -478.3671875, 371.6328125, -427.3671875, 116.6328125, -3.78515625, 171.6328125, 447.6328125, 40.6328125, 320.6328125, -3.78515625, -170.3671875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 92000.0, "diff_num_grad_updates_vs_sampler_policy": 91999.0}}, "num_env_steps_sampled": 93000, "num_env_steps_trained": 2944000, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 2944000, "last_target_update_ts": 92501, "num_target_updates": 184}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 2944000, "num_env_steps_sampled": 93000, "num_env_steps_trained": 2944000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 24.762187614125324, "num_env_steps_trained_throughput_per_sec": 792.3900036520104, "timesteps_total": 93000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 93000, "timers": {"training_iteration_time_ms": 41.287, "sample_time_ms": 12.459, "load_time_ms": 0.26, "load_throughput": 122865.002, "learn_time_ms": 4.227, "learn_throughput": 7569.964, "synch_weights_time_ms": 2.834}, "counters": {"num_env_steps_sampled": 93000, "num_env_steps_trained": 2944000, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 2944000, "last_target_update_ts": 92501, "num_target_updates": 184}, "done": false, "episodes_total": 8, "training_iteration": 93, "trial_id": "c28e8_00000", "date": "2023-12-11_11-51-31", "timestamp": 1702324291, "time_this_iter_s": 40.391162157058716, "time_total_s": 3784.972816467285, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3784.972816467285, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 35.87543859649123, "ram_util_percent": 86.08421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -42342.08203125, "min_q": -42342.25, "max_q": -42339.58203125, "mean_td_error": 45.24072265625, "model": {}}, "td_error": [152.98046875, 356.98046875, 277.98046875, 144.98046875, -353.01953125, 141.98046875, -71.01953125, 364.98046875, -114.01953125, -384.01953125, -7.3515625, 84.98046875, -187.01953125, 183.98046875, -387.01953125, 453.98046875, -170.01953125, 337.98046875, -7.3515625, 364.98046875, -125.01953125, 136.98046875, -495.01953125, -87.01953125, 341.98046875, 442.98046875, -168.01953125, 410.98046875, -312.01953125, -459.01953125, 469.9765625, 105.9765625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 93000.0, "diff_num_grad_updates_vs_sampler_policy": 92999.0}}, "num_env_steps_sampled": 94000, "num_env_steps_trained": 2976000, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 2976000, "last_target_update_ts": 93501, "num_target_updates": 186}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 2976000, "num_env_steps_sampled": 94000, "num_env_steps_trained": 2976000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.196692512232016, "num_env_steps_trained_throughput_per_sec": 902.2941603914245, "timesteps_total": 94000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 94000, "timers": {"training_iteration_time_ms": 36.717, "sample_time_ms": 11.217, "load_time_ms": 0.397, "load_throughput": 80577.372, "learn_time_ms": 3.863, "learn_throughput": 8284.278, "synch_weights_time_ms": 2.38}, "counters": {"num_env_steps_sampled": 94000, "num_env_steps_trained": 2976000, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 2976000, "last_target_update_ts": 93501, "num_target_updates": 186}, "done": false, "episodes_total": 8, "training_iteration": 94, "trial_id": "c28e8_00000", "date": "2023-12-11_11-52-06", "timestamp": 1702324326, "time_this_iter_s": 35.47213125228882, "time_total_s": 3820.444947719574, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3820.444947719574, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 26.957142857142856, "ram_util_percent": 85.57551020408165}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -42494.7421875, "min_q": -42495.07421875, "max_q": -42492.3984375, "mean_td_error": -1309.5294189453125, "model": {}}, "td_error": [-16.98828125, -16.98828125, -42495.07421875, -167.6640625, 171.3359375, 240.3359375, 471.3359375, 480.3359375, -432.6640625, 476.3359375, -16.98828125, -381.6640625, 480.3359375, -356.6640625, 452.3359375, -399.6640625, -373.6640625, 424.3359375, 129.01171875, -471.6640625, 269.3359375, -386.6640625, 422.3359375, -340.6640625, -428.6640625, -265.6640625, -261.6640625, 410.3359375, 428.3359375, 122.3359375, 246.34375, -316.65625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 94000.0, "diff_num_grad_updates_vs_sampler_policy": 93999.0}}, "num_env_steps_sampled": 95000, "num_env_steps_trained": 3008000, "num_agent_steps_sampled": 95000, "num_agent_steps_trained": 3008000, "last_target_update_ts": 94501, "num_target_updates": 188}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95000, "num_agent_steps_trained": 3008000, "num_env_steps_sampled": 95000, "num_env_steps_trained": 3008000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.288061091956155, "num_env_steps_trained_throughput_per_sec": 905.217954942597, "timesteps_total": 95000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 95000, "timers": {"training_iteration_time_ms": 35.408, "sample_time_ms": 10.771, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3.769, "learn_throughput": 8489.312, "synch_weights_time_ms": 2.849}, "counters": {"num_env_steps_sampled": 95000, "num_env_steps_trained": 3008000, "num_agent_steps_sampled": 95000, "num_agent_steps_trained": 3008000, "last_target_update_ts": 94501, "num_target_updates": 188}, "done": false, "episodes_total": 8, "training_iteration": 95, "trial_id": "c28e8_00000", "date": "2023-12-11_11-52-42", "timestamp": 1702324362, "time_this_iter_s": 35.356613874435425, "time_total_s": 3855.8015615940094, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3855.8015615940094, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 23.434, "ram_util_percent": 85.72599999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -42614.6796875, "min_q": -42615.1171875, "max_q": -42612.3359375, "mean_td_error": -7.1318359375, "model": {}}, "td_error": [-243.00390625, 166.99609375, 359.99609375, 9.77734375, -189.00390625, -452.00390625, 439.99609375, 506.99609375, -312.00390625, 69.99609375, -81.00390625, 333.77734375, 9.77734375, 485.99609375, -275.00390625, -454.00390625, 484.99609375, 241.99609375, -414.00390625, -477.00390625, -292.00390625, 83.99609375, 9.77734375, 187.99609375, 120.99609375, -135.00390625, -464.00390625, 9.77734375, -337.00390625, 506.99609375, -124.00390625, -9.00390625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 95000.0, "diff_num_grad_updates_vs_sampler_policy": 94999.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 3040000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 3040000, "last_target_update_ts": 95501, "num_target_updates": 190}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 3040000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.247126610372757, "num_env_steps_trained_throughput_per_sec": 903.9080515319282, "timesteps_total": 96000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 34.373, "sample_time_ms": 10.246, "load_time_ms": 0.194, "load_throughput": 165048.854, "learn_time_ms": 3.776, "learn_throughput": 8473.823, "synch_weights_time_ms": 2.642}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 3040000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 3040000, "last_target_update_ts": 95501, "num_target_updates": 190}, "done": false, "episodes_total": 8, "training_iteration": 96, "trial_id": "c28e8_00000", "date": "2023-12-11_11-53-17", "timestamp": 1702324397, "time_this_iter_s": 35.408843994140625, "time_total_s": 3891.21040558815, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3891.21040558815, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 22.434693877551023, "ram_util_percent": 86.27142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -42798.34375, "min_q": -42798.5234375, "max_q": -42795.6171875, "mean_td_error": 20.255859375, "model": {}}, "td_error": [410.04296875, -10.05078125, -10.05078125, -390.95703125, 70.04296875, 441.04296875, 413.04296875, -217.95703125, 469.04296875, 348.04296875, -497.95703125, -375.95703125, -463.95703125, 455.04296875, 307.04296875, -446.95703125, 64.04296875, -197.95703125, 155.04296875, 390.04296875, 404.04296875, -205.95703125, -474.95703125, -189.95703125, 466.04296875, 391.04296875, 481.04296875, -304.95703125, 67.04296875, -349.95703125, -403.95703125, -141.95703125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 96000.0, "diff_num_grad_updates_vs_sampler_policy": 95999.0}}, "num_env_steps_sampled": 97000, "num_env_steps_trained": 3072000, "num_agent_steps_sampled": 97000, "num_agent_steps_trained": 3072000, "last_target_update_ts": 96501, "num_target_updates": 192}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97000, "num_agent_steps_trained": 3072000, "num_env_steps_sampled": 97000, "num_env_steps_trained": 3072000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 23.18735743973695, "num_env_steps_trained_throughput_per_sec": 741.9954380715824, "timesteps_total": 97000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 97000, "timers": {"training_iteration_time_ms": 39.875, "sample_time_ms": 11.787, "load_time_ms": 0.418, "load_throughput": 76525.302, "learn_time_ms": 4.306, "learn_throughput": 7430.739, "synch_weights_time_ms": 2.863}, "counters": {"num_env_steps_sampled": 97000, "num_env_steps_trained": 3072000, "num_agent_steps_sampled": 97000, "num_agent_steps_trained": 3072000, "last_target_update_ts": 96501, "num_target_updates": 192}, "done": false, "episodes_total": 8, "training_iteration": 97, "trial_id": "c28e8_00000", "date": "2023-12-11_11-54-00", "timestamp": 1702324440, "time_this_iter_s": 43.13395977020264, "time_total_s": 3934.3443653583527, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3934.3443653583527, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 43.41666666666666, "ram_util_percent": 90.38499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -42919.85546875, "min_q": -42920.25, "max_q": -42917.0859375, "mean_td_error": -18.5576171875, "model": {}}, "td_error": [-425.546875, 404.453125, -253.546875, 472.453125, -458.546875, -190.546875, -276.546875, -243.546875, 421.453125, 331.453125, -144.546875, 319.453125, -452.546875, 265.453125, 138.453125, 8.6171875, -147.546875, -417.546875, 285.453125, 414.453125, 8.6171875, -459.546875, -414.546875, -361.546875, 364.453125, -229.546875, 496.453125, -404.546875, 87.453125, 8.6171875, 250.453125, 8.6171875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 97000.0, "diff_num_grad_updates_vs_sampler_policy": 96999.0}}, "num_env_steps_sampled": 98000, "num_env_steps_trained": 3104000, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 3104000, "last_target_update_ts": 97501, "num_target_updates": 194}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 3104000, "num_env_steps_sampled": 98000, "num_env_steps_trained": 3104000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 25.586332925340002, "num_env_steps_trained_throughput_per_sec": 818.7626536108801, "timesteps_total": 98000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 98000, "timers": {"training_iteration_time_ms": 32.644, "sample_time_ms": 9.953, "load_time_ms": 0.442, "load_throughput": 72448.304, "learn_time_ms": 3.77, "learn_throughput": 8488.453, "synch_weights_time_ms": 2.245}, "counters": {"num_env_steps_sampled": 98000, "num_env_steps_trained": 3104000, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 3104000, "last_target_update_ts": 97501, "num_target_updates": 194}, "done": false, "episodes_total": 8, "training_iteration": 98, "trial_id": "c28e8_00000", "date": "2023-12-11_11-54-39", "timestamp": 1702324479, "time_this_iter_s": 39.08902978897095, "time_total_s": 3973.4333951473236, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3973.4333951473236, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 34.60363636363636, "ram_util_percent": 94.1909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -43055.9765625, "min_q": -43056.19140625, "max_q": -43052.79296875, "mean_td_error": 79.02490234375, "model": {}}, "td_error": [-314.375, 348.625, 435.625, -430.375, 391.625, 208.625, 253.625, 257.625, 433.625, 494.625, 444.625, 163.625, 350.625, -183.375, 263.625, -1.9765625, 494.625, -452.375, 410.625, -34.375, -410.375, 63.625, -427.375, -25.375, -464.375, -381.375, -83.375, 431.625, -1.9765625, 239.625, -350.375, 403.625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 98000.0, "diff_num_grad_updates_vs_sampler_policy": 97999.0}}, "num_env_steps_sampled": 99000, "num_env_steps_trained": 3136000, "num_agent_steps_sampled": 99000, "num_agent_steps_trained": 3136000, "last_target_update_ts": 98501, "num_target_updates": 196}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99000, "num_agent_steps_trained": 3136000, "num_env_steps_sampled": 99000, "num_env_steps_trained": 3136000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.123101426327235, "num_env_steps_trained_throughput_per_sec": 931.9392456424715, "timesteps_total": 99000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 99000, "timers": {"training_iteration_time_ms": 34.647, "sample_time_ms": 10.134, "load_time_ms": 0.29, "load_throughput": 110494.548, "learn_time_ms": 4.139, "learn_throughput": 7732.059, "synch_weights_time_ms": 2.564}, "counters": {"num_env_steps_sampled": 99000, "num_env_steps_trained": 3136000, "num_agent_steps_sampled": 99000, "num_agent_steps_trained": 3136000, "last_target_update_ts": 98501, "num_target_updates": 196}, "done": false, "episodes_total": 8, "training_iteration": 99, "trial_id": "c28e8_00000", "date": "2023-12-11_11-55-14", "timestamp": 1702324514, "time_this_iter_s": 34.34370517730713, "time_total_s": 4007.7771003246307, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4007.7771003246307, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 26.522916666666664, "ram_util_percent": 94.6104166666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -43170.19140625, "min_q": -43170.72265625, "max_q": -43167.33984375, "mean_td_error": -0.3238525390625, "model": {}}, "td_error": [10.87109375, -491.5078125, 10.87109375, 270.4921875, 409.4921875, 354.4921875, -284.5078125, -201.5078125, 437.4921875, 454.4921875, -343.5078125, 10.87109375, -320.5078125, -273.5078125, 393.4921875, 267.4921875, 337.4921875, 10.87109375, -140.5078125, 150.4921875, 481.4921875, -358.5078125, -439.5078125, -459.5078125, 507.4921875, 127.4921875, 345.4921875, -386.5078125, 10.87109375, -300.5078125, -296.51171875, -305.51171875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 99000.0, "diff_num_grad_updates_vs_sampler_policy": 98999.0}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 3168000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 3168000, "last_target_update_ts": 99501, "num_target_updates": 198}, "sampler_results": {"episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}}, "episode_reward_max": -99112.0, "episode_reward_min": -20041071.0, "episode_reward_mean": -4060493.0, "episode_len_mean": 7925.375, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333861.0, -1093293.0, -99112.0, -20041071.0, -1218067.0, -7164577.0, -911170.0, -1622793.0], "episode_lengths": [768, 2276, 146, 39860, 2138, 14656, 1346, 2213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2191776301162505, "mean_inference_ms": 1.412539604505103, "mean_action_processing_ms": 0.15137220514616492, "mean_env_wait_ms": 0.06658011257945617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026425719261169434, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28925836086273193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 3168000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 3168000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.762095156478903, "num_env_steps_trained_throughput_per_sec": 920.3870450073249, "timesteps_total": 100000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 34.145, "sample_time_ms": 9.949, "load_time_ms": 0.212, "load_throughput": 151146.09, "learn_time_ms": 4.307, "learn_throughput": 7429.67, "synch_weights_time_ms": 2.462}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 3168000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 3168000, "last_target_update_ts": 99501, "num_target_updates": 198}, "done": true, "episodes_total": 8, "training_iteration": 100, "trial_id": "c28e8_00000", "date": "2023-12-11_11-55-49", "timestamp": 1702324549, "time_this_iter_s": 34.77499198913574, "time_total_s": 4042.5520923137665, "pid": 17512, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001C259E9A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4042.5520923137665, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 27.585714285714293, "ram_util_percent": 88.92244897959185}}
