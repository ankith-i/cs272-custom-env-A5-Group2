{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 22502276.0, "policy_loss": 8290.7021484375, "entropy": 1.041247844696045, "var_gnorm": 22.659997940063477, "vf_loss": 44987972.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9997937083244324, "var_IS": 1.1070993423345499e-05, "model": {}, "grad_gnorm": [97.9795913696289]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000000018}}, "num_env_steps_sampled": 4400, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4400, "num_agent_steps_trained": 4000, "num_training_step_calls_since_last_synch_worker_weights": 422, "last_target_update_ts": 4400, "num_weight_broadcasts": 88, "num_target_updates": 88, "num_samples_added_to_queue": 4000, "learner_queue": {"size_count": 8, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 111.56, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 1037.765, "learner_dequeue_time_ms": 1302.126}}, "sampler_results": {"episode_reward_max": -149168.0, "episode_reward_min": -149168.0, "episode_reward_mean": -149168.0, "episode_len_mean": 379.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0], "episode_lengths": [379]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48448249674510807, "mean_inference_ms": 1.1982446881141484, "mean_action_processing_ms": 0.19321609036018256, "mean_env_wait_ms": 0.07356720165633222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.30274391174316406}}, "episode_reward_max": -149168.0, "episode_reward_min": -149168.0, "episode_reward_mean": -149168.0, "episode_len_mean": 379.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0], "episode_lengths": [379]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48448249674510807, "mean_inference_ms": 1.1982446881141484, "mean_action_processing_ms": 0.19321609036018256, "mean_env_wait_ms": 0.07356720165633222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.30274391174316406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4400, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4400, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4400, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 439.9832893996236, "num_env_steps_trained_throughput_per_sec": 399.9848085451123, "timesteps_total": 4400, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4400, "timers": {"training_iteration_time_ms": 0.301, "sample_time_ms": 0.202, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 4400, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4400, "num_agent_steps_trained": 4000, "num_training_step_calls_since_last_synch_worker_weights": 422, "last_target_update_ts": 4400, "num_weight_broadcasts": 88, "num_target_updates": 88, "num_samples_added_to_queue": 4000}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "304dd_00000", "date": "2023-12-11_01-47-32", "timestamp": 1702288052, "time_this_iter_s": 10.090845346450806, "time_total_s": 10.090845346450806, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10.090845346450806, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.059999999999995, "ram_util_percent": 92.23999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 17930058.0, "policy_loss": 7186.76123046875, "entropy": 1.0774202346801758, "var_gnorm": 22.760698318481445, "vf_loss": 35845744.0, "vf_explained_var": -2.384185791015625e-06, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0002589225769043, "var_IS": 8.034631900954992e-05, "model": {}, "grad_gnorm": [96.73831176757812]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 0.1999999999999993}}, "num_env_steps_sampled": 9400, "num_env_steps_trained": 9000, "num_agent_steps_sampled": 9400, "num_agent_steps_trained": 9000, "num_training_step_calls_since_last_synch_worker_weights": 103, "last_target_update_ts": 9400, "num_weight_broadcasts": 187, "num_target_updates": 187, "num_samples_added_to_queue": 9000, "learner_queue": {"size_count": 18, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.834, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 1003.343, "learner_dequeue_time_ms": 9126.627}}, "sampler_results": {"episode_reward_max": -149168.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -1271123.5, "episode_len_mean": 3557.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0], "episode_lengths": [379, 6735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4750220975872338, "mean_inference_ms": 1.1902547492625577, "mean_action_processing_ms": 0.1872013837950438, "mean_env_wait_ms": 0.07203596214785629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.22263526916503906}}, "episode_reward_max": -149168.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -1271123.5, "episode_len_mean": 3557.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0], "episode_lengths": [379, 6735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4750220975872338, "mean_inference_ms": 1.1902547492625577, "mean_action_processing_ms": 0.1872013837950438, "mean_env_wait_ms": 0.07203596214785629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.22263526916503906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9400, "num_agent_steps_trained": 9000, "num_env_steps_sampled": 9400, "num_env_steps_trained": 9000, "num_env_steps_sampled_this_iter": 5000, "num_env_steps_trained_this_iter": 5000, "num_env_steps_sampled_throughput_per_sec": 499.9897839726242, "num_env_steps_trained_throughput_per_sec": 499.9897839726242, "timesteps_total": 9400, "num_steps_trained_this_iter": 5000, "agent_timesteps_total": 9400, "timers": {"training_iteration_time_ms": 0.3, "sample_time_ms": 0.2, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 9400, "num_env_steps_trained": 9000, "num_agent_steps_sampled": 9400, "num_agent_steps_trained": 9000, "num_training_step_calls_since_last_synch_worker_weights": 103, "last_target_update_ts": 9400, "num_weight_broadcasts": 187, "num_target_updates": 187, "num_samples_added_to_queue": 9000}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "304dd_00000", "date": "2023-12-11_01-47-43", "timestamp": 1702288063, "time_this_iter_s": 10.147000789642334, "time_total_s": 20.23784613609314, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 20.23784613609314, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 38.57142857142857, "ram_util_percent": 84.68571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 15437178.0, "policy_loss": 6647.70849609375, "entropy": 1.0274113416671753, "var_gnorm": 22.936140060424805, "vf_loss": 30861060.0, "vf_explained_var": -5.0067901611328125e-06, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0006003379821777, "var_IS": 0.00010595849016681314, "model": {}, "grad_gnorm": [88.91758728027344]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 0.1999999999999993}}, "num_env_steps_sampled": 14850, "num_env_steps_trained": 14500, "num_agent_steps_sampled": 14850, "num_agent_steps_trained": 14500, "num_training_step_calls_since_last_synch_worker_weights": 173, "last_target_update_ts": 14850, "num_weight_broadcasts": 295, "num_target_updates": 295, "num_samples_added_to_queue": 14500, "learner_queue": {"size_count": 29, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.964, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 920.504, "learner_dequeue_time_ms": 9126.627}}, "sampler_results": {"episode_reward_max": -149168.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -1223241.25, "episode_len_mean": 3491.75, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0], "episode_lengths": [379, 6735, 3467, 3386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45553280762372333, "mean_inference_ms": 1.1700154691564022, "mean_action_processing_ms": 0.1797863770431145, "mean_env_wait_ms": 0.06825075052599697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.16126632690429688}}, "episode_reward_max": -149168.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -1223241.25, "episode_len_mean": 3491.75, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0], "episode_lengths": [379, 6735, 3467, 3386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45553280762372333, "mean_inference_ms": 1.1700154691564022, "mean_action_processing_ms": 0.1797863770431145, "mean_env_wait_ms": 0.06825075052599697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.16126632690429688}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14850, "num_agent_steps_trained": 14500, "num_env_steps_sampled": 14850, "num_env_steps_trained": 14500, "num_env_steps_sampled_this_iter": 5450, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 544.9908914896265, "num_env_steps_trained_throughput_per_sec": 549.9908079253112, "timesteps_total": 14850, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 14850, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 14850, "num_env_steps_trained": 14500, "num_agent_steps_sampled": 14850, "num_agent_steps_trained": 14500, "num_training_step_calls_since_last_synch_worker_weights": 173, "last_target_update_ts": 14850, "num_weight_broadcasts": 295, "num_target_updates": 295, "num_samples_added_to_queue": 14500}, "done": false, "episodes_total": 4, "training_iteration": 3, "trial_id": "304dd_00000", "date": "2023-12-11_01-47-53", "timestamp": 1702288073, "time_this_iter_s": 10.132312774658203, "time_total_s": 30.370158910751343, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 30.370158910751343, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 36.11428571428572, "ram_util_percent": 85.61428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 52909860.0, "policy_loss": 11076.9462890625, "entropy": 1.033995509147644, "var_gnorm": 23.216411590576172, "vf_loss": 105797568.0, "vf_explained_var": -2.562999725341797e-05, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0010915994644165, "var_IS": 0.00016235903603956103, "model": {}, "grad_gnorm": [105.8300552368164]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000000284}}, "num_env_steps_sampled": 20450, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20450, "num_agent_steps_trained": 20000, "num_training_step_calls_since_last_synch_worker_weights": 360, "last_target_update_ts": 20450, "num_weight_broadcasts": 406, "num_target_updates": 406, "num_samples_added_to_queue": 20000, "learner_queue": {"size_count": 40, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.23, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 887.066, "learner_dequeue_time_ms": 11123.295}}, "sampler_results": {"episode_reward_max": -149168.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -1187722.3333333333, "episode_len_mean": 3131.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4443238865083907, "mean_inference_ms": 1.1548707289000926, "mean_action_processing_ms": 0.17478595297678268, "mean_env_wait_ms": 0.06578831929091161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.010498364766438803, "ViewRequirementAgentConnector_ms": 0.1377582550048828}}, "episode_reward_max": -149168.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -1187722.3333333333, "episode_len_mean": 3131.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4443238865083907, "mean_inference_ms": 1.1548707289000926, "mean_action_processing_ms": 0.17478595297678268, "mean_env_wait_ms": 0.06578831929091161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.010498364766438803, "ViewRequirementAgentConnector_ms": 0.1377582550048828}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20450, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20450, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 5600, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 559.9734452442506, "num_env_steps_trained_throughput_per_sec": 549.9739194363175, "timesteps_total": 20450, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 20450, "timers": {"training_iteration_time_ms": 0.201, "sample_time_ms": 0.201, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 20450, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20450, "num_agent_steps_trained": 20000, "num_training_step_calls_since_last_synch_worker_weights": 360, "last_target_update_ts": 20450, "num_weight_broadcasts": 406, "num_target_updates": 406, "num_samples_added_to_queue": 20000}, "done": false, "episodes_total": 6, "training_iteration": 4, "trial_id": "304dd_00000", "date": "2023-12-11_01-48-03", "timestamp": 1702288083, "time_this_iter_s": 10.09789752960205, "time_total_s": 40.468056440353394, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 40.468056440353394, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 34.19285714285714, "ram_util_percent": 85.53571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 16217222.0, "policy_loss": 6673.02294921875, "entropy": 0.9411168694496155, "var_gnorm": 23.528139114379883, "vf_loss": 32421098.0, "vf_explained_var": -1.1563301086425781e-05, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9997234344482422, "var_IS": 0.0002280054468428716, "model": {}, "grad_gnorm": [87.28253936767578]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000000284}}, "num_env_steps_sampled": 25950, "num_env_steps_trained": 25500, "num_agent_steps_sampled": 25950, "num_agent_steps_trained": 25500, "num_training_step_calls_since_last_synch_worker_weights": 404, "last_target_update_ts": 25950, "num_weight_broadcasts": 515, "num_target_updates": 515, "num_samples_added_to_queue": 25500, "learner_queue": {"size_count": 51, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.7, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 896.902, "learner_dequeue_time_ms": 12003.878}}, "sampler_results": {"episode_reward_max": -149168.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -1097014.0, "episode_len_mean": 2837.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4345416261173707, "mean_inference_ms": 1.1411623952468235, "mean_action_processing_ms": 0.17012270320066342, "mean_env_wait_ms": 0.06380890107041272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01811981201171875, "ViewRequirementAgentConnector_ms": 0.13329188028971353}}, "episode_reward_max": -149168.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -1097014.0, "episode_len_mean": 2837.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4345416261173707, "mean_inference_ms": 1.1411623952468235, "mean_action_processing_ms": 0.17012270320066342, "mean_env_wait_ms": 0.06380890107041272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01811981201171875, "ViewRequirementAgentConnector_ms": 0.13329188028971353}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25950, "num_agent_steps_trained": 25500, "num_env_steps_sampled": 25950, "num_env_steps_trained": 25500, "num_env_steps_sampled_this_iter": 5500, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 549.9823504389836, "num_env_steps_trained_throughput_per_sec": 549.9823504389836, "timesteps_total": 25950, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 25950, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 25950, "num_env_steps_trained": 25500, "num_agent_steps_sampled": 25950, "num_agent_steps_trained": 25500, "num_training_step_calls_since_last_synch_worker_weights": 404, "last_target_update_ts": 25950, "num_weight_broadcasts": 515, "num_target_updates": 515, "num_samples_added_to_queue": 25500}, "done": false, "episodes_total": 9, "training_iteration": 5, "trial_id": "304dd_00000", "date": "2023-12-11_01-48-13", "timestamp": 1702288093, "time_this_iter_s": 10.085344076156616, "time_total_s": 50.55340051651001, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 50.55340051651001, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 33.04285714285714, "ram_util_percent": 85.58571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 25880226.0, "policy_loss": 8152.578125, "entropy": 0.9612574577331543, "var_gnorm": 23.824586868286133, "vf_loss": 51744148.0, "vf_explained_var": -1.4066696166992188e-05, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0008678436279297, "var_IS": 0.00035493430914357305, "model": {}, "grad_gnorm": [92.42385864257812]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000000284}}, "num_env_steps_sampled": 31350, "num_env_steps_trained": 31000, "num_agent_steps_sampled": 31350, "num_agent_steps_trained": 31000, "num_training_step_calls_since_last_synch_worker_weights": 414, "last_target_update_ts": 31350, "num_weight_broadcasts": 622, "num_target_updates": 622, "num_samples_added_to_queue": 31000, "learner_queue": {"size_count": 62, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.279, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 916.162, "learner_dequeue_time_ms": 12003.878}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -773291.25, "episode_len_mean": 1914.5625, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42459450718199265, "mean_inference_ms": 1.1285277718047924, "mean_action_processing_ms": 0.16500986450610022, "mean_env_wait_ms": 0.06167718698068227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.010192394256591797, "ViewRequirementAgentConnector_ms": 0.15423893928527832}}, "episode_reward_max": -20206.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -773291.25, "episode_len_mean": 1914.5625, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42459450718199265, "mean_inference_ms": 1.1285277718047924, "mean_action_processing_ms": 0.16500986450610022, "mean_env_wait_ms": 0.06167718698068227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.010192394256591797, "ViewRequirementAgentConnector_ms": 0.15423893928527832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31350, "num_agent_steps_trained": 31000, "num_env_steps_sampled": 31350, "num_env_steps_trained": 31000, "num_env_steps_sampled_this_iter": 5400, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 539.9966140005712, "num_env_steps_trained_throughput_per_sec": 549.9965512968781, "timesteps_total": 31350, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 31350, "timers": {"training_iteration_time_ms": 0.238, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 31350, "num_env_steps_trained": 31000, "num_agent_steps_sampled": 31350, "num_agent_steps_trained": 31000, "num_training_step_calls_since_last_synch_worker_weights": 414, "last_target_update_ts": 31350, "num_weight_broadcasts": 622, "num_target_updates": 622, "num_samples_added_to_queue": 31000}, "done": false, "episodes_total": 16, "training_iteration": 6, "trial_id": "304dd_00000", "date": "2023-12-11_01-48-23", "timestamp": 1702288103, "time_this_iter_s": 10.082651853561401, "time_total_s": 60.63605237007141, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 60.63605237007141, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.42142857142857, "ram_util_percent": 85.97857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 16678547.0, "policy_loss": 7043.962890625, "entropy": 0.9507079124450684, "var_gnorm": 24.091463088989258, "vf_loss": 33343006.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0013508796691895, "var_IS": 0.00029014190658926964, "model": {}, "grad_gnorm": [80.00041961669922]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000000284}}, "num_env_steps_sampled": 36800, "num_env_steps_trained": 36500, "num_agent_steps_sampled": 36800, "num_agent_steps_trained": 36500, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 36800, "num_weight_broadcasts": 730, "num_target_updates": 730, "num_samples_added_to_queue": 36500, "learner_queue": {"size_count": 73, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.054, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 922.398, "learner_dequeue_time_ms": 12590.501}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -775991.2777777778, "episode_len_mean": 1960.7222222222222, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42282946869831506, "mean_inference_ms": 1.126369053233387, "mean_action_processing_ms": 0.1643839404119601, "mean_env_wait_ms": 0.06126726262449002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009059906005859375, "ViewRequirementAgentConnector_ms": 0.14904605017768013}}, "episode_reward_max": -20206.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -775991.2777777778, "episode_len_mean": 1960.7222222222222, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42282946869831506, "mean_inference_ms": 1.126369053233387, "mean_action_processing_ms": 0.1643839404119601, "mean_env_wait_ms": 0.06126726262449002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009059906005859375, "ViewRequirementAgentConnector_ms": 0.14904605017768013}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 1, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36800, "num_agent_steps_trained": 36500, "num_env_steps_sampled": 36800, "num_env_steps_trained": 36500, "num_env_steps_sampled_this_iter": 5450, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 544.7866212221757, "num_env_steps_trained_throughput_per_sec": 549.7846636187094, "timesteps_total": 36800, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 36800, "timers": {"training_iteration_time_ms": 1.433, "sample_time_ms": 0.191, "synch_weights_time_ms": 0.816}, "counters": {"num_env_steps_sampled": 36800, "num_env_steps_trained": 36500, "num_agent_steps_sampled": 36800, "num_agent_steps_trained": 36500, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 36800, "num_weight_broadcasts": 730, "num_target_updates": 730, "num_samples_added_to_queue": 36500}, "done": false, "episodes_total": 18, "training_iteration": 7, "trial_id": "304dd_00000", "date": "2023-12-11_01-48-33", "timestamp": 1702288113, "time_this_iter_s": 10.082102537155151, "time_total_s": 70.71815490722656, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 70.71815490722656, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.22666666666666, "ram_util_percent": 85.98666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 23874940.0, "policy_loss": 7663.09521484375, "entropy": 0.9406302571296692, "var_gnorm": 24.440336227416992, "vf_loss": 47734552.0, "vf_explained_var": -9.417533874511719e-06, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0010260343551636, "var_IS": 0.00029787575476802886, "model": {}, "grad_gnorm": [99.8206558227539]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 84.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000000284}}, "num_env_steps_sampled": 42250, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42250, "num_agent_steps_trained": 42000, "num_training_step_calls_since_last_synch_worker_weights": 17, "last_target_update_ts": 42250, "num_weight_broadcasts": 839, "num_target_updates": 839, "num_samples_added_to_queue": 42000, "learner_queue": {"size_count": 84, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.23, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 914.806, "learner_dequeue_time_ms": 12982.286}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -752315.0, "episode_len_mean": 1892.4761904761904, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4204742778623353, "mean_inference_ms": 1.1234869090584734, "mean_action_processing_ms": 0.16350911459992248, "mean_env_wait_ms": 0.060784119731801256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020220166160946802, "StateBufferConnector_ms": 0.011608714149111793, "ViewRequirementAgentConnector_ms": 0.13958045414515904}}, "episode_reward_max": -20206.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -752315.0, "episode_len_mean": 1892.4761904761904, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4204742778623353, "mean_inference_ms": 1.1234869090584734, "mean_action_processing_ms": 0.16350911459992248, "mean_env_wait_ms": 0.060784119731801256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020220166160946802, "StateBufferConnector_ms": 0.011608714149111793, "ViewRequirementAgentConnector_ms": 0.13958045414515904}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42250, "num_agent_steps_trained": 42000, "num_env_steps_sampled": 42250, "num_env_steps_trained": 42000, "num_env_steps_sampled_this_iter": 5450, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 544.9696351519262, "num_env_steps_trained_throughput_per_sec": 549.9693565753385, "timesteps_total": 42250, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 42250, "timers": {"training_iteration_time_ms": 0.267, "sample_time_ms": 0.067, "synch_weights_time_ms": 0.1}, "counters": {"num_env_steps_sampled": 42250, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42250, "num_agent_steps_trained": 42000, "num_training_step_calls_since_last_synch_worker_weights": 17, "last_target_update_ts": 42250, "num_weight_broadcasts": 839, "num_target_updates": 839, "num_samples_added_to_queue": 42000}, "done": false, "episodes_total": 21, "training_iteration": 8, "trial_id": "304dd_00000", "date": "2023-12-11_01-48-43", "timestamp": 1702288123, "time_this_iter_s": 10.172062873840332, "time_total_s": 80.8902177810669, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 80.8902177810669, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.828571428571436, "ram_util_percent": 85.94285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 18569230.0, "policy_loss": 7394.60107421875, "entropy": 0.9252034425735474, "var_gnorm": 24.737831115722656, "vf_loss": 37123672.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.000311255455017, "var_IS": 0.0003232926537748426, "model": {}, "grad_gnorm": [80.00004577636719]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 94.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000000284}}, "num_env_steps_sampled": 47450, "num_env_steps_trained": 47000, "num_agent_steps_sampled": 47450, "num_agent_steps_trained": 47000, "num_training_step_calls_since_last_synch_worker_weights": 34, "last_target_update_ts": 47450, "num_weight_broadcasts": 942, "num_target_updates": 942, "num_samples_added_to_queue": 47000, "learner_queue": {"size_count": 94, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.714, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 971.578, "learner_dequeue_time_ms": 12982.286}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -792070.3913043478, "episode_len_mean": 2014.8695652173913, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4194175339131441, "mean_inference_ms": 1.1222651750701822, "mean_action_processing_ms": 0.1631609148241016, "mean_env_wait_ms": 0.06054357308367561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00184618908426036, "StateBufferConnector_ms": 0.010599260744841202, "ViewRequirementAgentConnector_ms": 0.1372534295786982}}, "episode_reward_max": -20206.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -792070.3913043478, "episode_len_mean": 2014.8695652173913, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4194175339131441, "mean_inference_ms": 1.1222651750701822, "mean_action_processing_ms": 0.1631609148241016, "mean_env_wait_ms": 0.06054357308367561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00184618908426036, "StateBufferConnector_ms": 0.010599260744841202, "ViewRequirementAgentConnector_ms": 0.1372534295786982}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47450, "num_agent_steps_trained": 47000, "num_env_steps_sampled": 47450, "num_env_steps_trained": 47000, "num_env_steps_sampled_this_iter": 5200, "num_env_steps_trained_this_iter": 5000, "num_env_steps_sampled_throughput_per_sec": 519.9844660631185, "num_env_steps_trained_throughput_per_sec": 499.9850635222293, "timesteps_total": 47450, "num_steps_trained_this_iter": 5000, "agent_timesteps_total": 47450, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.2}, "counters": {"num_env_steps_sampled": 47450, "num_env_steps_trained": 47000, "num_agent_steps_sampled": 47450, "num_agent_steps_trained": 47000, "num_training_step_calls_since_last_synch_worker_weights": 34, "last_target_update_ts": 47450, "num_weight_broadcasts": 942, "num_target_updates": 942, "num_samples_added_to_queue": 47000}, "done": false, "episodes_total": 23, "training_iteration": 9, "trial_id": "304dd_00000", "date": "2023-12-11_01-48-54", "timestamp": 1702288134, "time_this_iter_s": 10.15183973312378, "time_total_s": 91.04205751419067, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 91.04205751419067, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 34.635714285714286, "ram_util_percent": 86.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 26026396.0, "policy_loss": 8861.685546875, "entropy": 0.9705687761306763, "var_gnorm": 25.069231033325195, "vf_loss": 52035068.0, "vf_explained_var": -4.470348358154297e-05, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0009608268737793, "var_IS": 0.00028566212859004736, "model": {}, "grad_gnorm": [104.06013488769531]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 106.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000000284}}, "num_env_steps_sampled": 53100, "num_env_steps_trained": 53000, "num_agent_steps_sampled": 53100, "num_agent_steps_trained": 53000, "num_training_step_calls_since_last_synch_worker_weights": 181, "last_target_update_ts": 53100, "num_weight_broadcasts": 1054, "num_target_updates": 1054, "num_samples_added_to_queue": 53000, "learner_queue": {"size_count": 106, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.204, "learner_load_time_ms": 0.142, "learner_load_wait_time_ms": 887.787, "learner_dequeue_time_ms": 13329.589}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -782310.6538461539, "episode_len_mean": 1996.1153846153845, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41796130638524026, "mean_inference_ms": 1.119890216984433, "mean_action_processing_ms": 0.16261677275961825, "mean_env_wait_ms": 0.060166875590408335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030260819655198315, "StateBufferConnector_ms": 0.009376269120436449, "ViewRequirementAgentConnector_ms": 0.13895676686213568}}, "episode_reward_max": -20206.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -782310.6538461539, "episode_len_mean": 1996.1153846153845, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41796130638524026, "mean_inference_ms": 1.119890216984433, "mean_action_processing_ms": 0.16261677275961825, "mean_env_wait_ms": 0.060166875590408335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030260819655198315, "StateBufferConnector_ms": 0.009376269120436449, "ViewRequirementAgentConnector_ms": 0.13895676686213568}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53100, "num_agent_steps_trained": 53000, "num_env_steps_sampled": 53100, "num_env_steps_trained": 53000, "num_env_steps_sampled_this_iter": 5650, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 564.9925238883314, "num_env_steps_trained_throughput_per_sec": 599.9920607663697, "timesteps_total": 53100, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 53100, "timers": {"training_iteration_time_ms": 0.174, "sample_time_ms": 0.073, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 53100, "num_env_steps_trained": 53000, "num_agent_steps_sampled": 53100, "num_agent_steps_trained": 53000, "num_training_step_calls_since_last_synch_worker_weights": 181, "last_target_update_ts": 53100, "num_weight_broadcasts": 1054, "num_target_updates": 1054, "num_samples_added_to_queue": 53000}, "done": false, "episodes_total": 26, "training_iteration": 10, "trial_id": "304dd_00000", "date": "2023-12-11_01-49-04", "timestamp": 1702288144, "time_this_iter_s": 10.120861768722534, "time_total_s": 101.16291928291321, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 101.16291928291321, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 34.207142857142856, "ram_util_percent": 85.72142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 14258228.0, "policy_loss": 6466.47021484375, "entropy": 1.0225176811218262, "var_gnorm": 25.482280731201172, "vf_loss": 28503524.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0000817775726318, "var_IS": 2.1352961994125508e-05, "model": {}, "grad_gnorm": [80.00000762939453]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 117.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000000284}}, "num_env_steps_sampled": 58700, "num_env_steps_trained": 58500, "num_agent_steps_sampled": 58700, "num_agent_steps_trained": 58500, "num_training_step_calls_since_last_synch_worker_weights": 127, "last_target_update_ts": 58700, "num_weight_broadcasts": 1165, "num_target_updates": 1165, "num_samples_added_to_queue": 58500, "learner_queue": {"size_count": 117, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.577, "learner_load_time_ms": 0.125, "learner_load_wait_time_ms": 896.648, "learner_dequeue_time_ms": 13477.355}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -696499.125, "episode_len_mean": 1798.125, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41561857678881503, "mean_inference_ms": 1.115769969149662, "mean_action_processing_ms": 0.16155097554279108, "mean_env_wait_ms": 0.05955861933740243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00470280647277832, "StateBufferConnector_ms": 0.008846819400787354, "ViewRequirementAgentConnector_ms": 0.13235732913017273}}, "episode_reward_max": -20206.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -696499.125, "episode_len_mean": 1798.125, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41561857678881503, "mean_inference_ms": 1.115769969149662, "mean_action_processing_ms": 0.16155097554279108, "mean_env_wait_ms": 0.05955861933740243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00470280647277832, "StateBufferConnector_ms": 0.008846819400787354, "ViewRequirementAgentConnector_ms": 0.13235732913017273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58700, "num_agent_steps_trained": 58500, "num_env_steps_sampled": 58700, "num_env_steps_trained": 58500, "num_env_steps_sampled_this_iter": 5600, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 559.9596815529277, "num_env_steps_trained_throughput_per_sec": 549.9604015251969, "timesteps_total": 58700, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 58700, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.062}, "counters": {"num_env_steps_sampled": 58700, "num_env_steps_trained": 58500, "num_agent_steps_sampled": 58700, "num_agent_steps_trained": 58500, "num_training_step_calls_since_last_synch_worker_weights": 127, "last_target_update_ts": 58700, "num_weight_broadcasts": 1165, "num_target_updates": 1165, "num_samples_added_to_queue": 58500}, "done": false, "episodes_total": 32, "training_iteration": 11, "trial_id": "304dd_00000", "date": "2023-12-11_01-49-14", "timestamp": 1702288154, "time_this_iter_s": 10.136019468307495, "time_total_s": 111.2989387512207, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 111.2989387512207, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 36.233333333333334, "ram_util_percent": 86.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 40397424.0, "policy_loss": 10849.439453125, "entropy": 1.0700045824050903, "var_gnorm": 26.0894775390625, "vf_loss": 80773152.0, "vf_explained_var": -0.0001704692840576172, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0004048347473145, "var_IS": 0.00021064355678390712, "model": {}, "grad_gnorm": [105.8300552368164]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 128.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000000284}}, "num_env_steps_sampled": 64400, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64400, "num_agent_steps_trained": 64000, "num_training_step_calls_since_last_synch_worker_weights": 294, "last_target_update_ts": 64400, "num_weight_broadcasts": 1278, "num_target_updates": 1278, "num_samples_added_to_queue": 64000, "learner_queue": {"size_count": 128, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.923, "learner_load_time_ms": 0.125, "learner_load_wait_time_ms": 874.459, "learner_dequeue_time_ms": 13477.355}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -691308.2424242424, "episode_len_mean": 1787.6666666666667, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4152411115650299, "mean_inference_ms": 1.1150676285251477, "mean_action_processing_ms": 0.16137376329695974, "mean_env_wait_ms": 0.05947521821305185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004560297185724432, "StateBufferConnector_ms": 0.008578733964399858, "ViewRequirementAgentConnector_ms": 0.13141848824240945}}, "episode_reward_max": -20206.0, "episode_reward_min": -2393079.0, "episode_reward_mean": -691308.2424242424, "episode_len_mean": 1787.6666666666667, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4152411115650299, "mean_inference_ms": 1.1150676285251477, "mean_action_processing_ms": 0.16137376329695974, "mean_env_wait_ms": 0.05947521821305185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004560297185724432, "StateBufferConnector_ms": 0.008578733964399858, "ViewRequirementAgentConnector_ms": 0.13141848824240945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64400, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64400, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 5700, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 569.9782842326592, "num_env_steps_trained_throughput_per_sec": 549.979046189408, "timesteps_total": 64400, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 64400, "timers": {"training_iteration_time_ms": 0.179, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.1}, "counters": {"num_env_steps_sampled": 64400, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64400, "num_agent_steps_trained": 64000, "num_training_step_calls_since_last_synch_worker_weights": 294, "last_target_update_ts": 64400, "num_weight_broadcasts": 1278, "num_target_updates": 1278, "num_samples_added_to_queue": 64000}, "done": false, "episodes_total": 33, "training_iteration": 12, "trial_id": "304dd_00000", "date": "2023-12-11_01-49-24", "timestamp": 1702288164, "time_this_iter_s": 10.103739500045776, "time_total_s": 121.40267825126648, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 121.40267825126648, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 34.73571428571428, "ram_util_percent": 87.02857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 22803884.0, "policy_loss": 8362.6103515625, "entropy": 1.0447825193405151, "var_gnorm": 26.66516876220703, "vf_loss": 45591044.0, "vf_explained_var": 1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9998037219047546, "var_IS": 6.725482671754435e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 138.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 69100, "num_env_steps_trained": 69000, "num_agent_steps_sampled": 69100, "num_agent_steps_trained": 69000, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 69100, "num_weight_broadcasts": 1371, "num_target_updates": 1371, "num_samples_added_to_queue": 69000, "learner_queue": {"size_count": 138, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.63, "learner_load_time_ms": 0.111, "learner_load_wait_time_ms": 1059.185, "learner_dequeue_time_ms": 13568.787}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -746815.0, "episode_len_mean": 1891.2, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4149257610850387, "mean_inference_ms": 1.1143102078650426, "mean_action_processing_ms": 0.16122199576809715, "mean_env_wait_ms": 0.05938871692243852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004299708775111607, "StateBufferConnector_ms": 0.00808852059500558, "ViewRequirementAgentConnector_ms": 0.130441529410226}}, "episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -746815.0, "episode_len_mean": 1891.2, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4149257610850387, "mean_inference_ms": 1.1143102078650426, "mean_action_processing_ms": 0.16122199576809715, "mean_env_wait_ms": 0.05938871692243852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004299708775111607, "StateBufferConnector_ms": 0.00808852059500558, "ViewRequirementAgentConnector_ms": 0.130441529410226}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 1, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69100, "num_agent_steps_trained": 69000, "num_env_steps_sampled": 69100, "num_env_steps_trained": 69000, "num_env_steps_sampled_this_iter": 4700, "num_env_steps_trained_this_iter": 5000, "num_env_steps_sampled_throughput_per_sec": 469.89745685046785, "num_env_steps_trained_throughput_per_sec": 499.89091154305095, "timesteps_total": 69100, "num_steps_trained_this_iter": 5000, "agent_timesteps_total": 69100, "timers": {"training_iteration_time_ms": 1.198, "sample_time_ms": 0.108, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 69100, "num_env_steps_trained": 69000, "num_agent_steps_sampled": 69100, "num_agent_steps_trained": 69000, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 69100, "num_weight_broadcasts": 1371, "num_target_updates": 1371, "num_samples_added_to_queue": 69000}, "done": false, "episodes_total": 35, "training_iteration": 13, "trial_id": "304dd_00000", "date": "2023-12-11_01-49-34", "timestamp": 1702288174, "time_this_iter_s": 10.135751008987427, "time_total_s": 131.5384292602539, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 131.5384292602539, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 41.92857142857144, "ram_util_percent": 87.73571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 13709709.0, "policy_loss": 5803.630859375, "entropy": 1.0895695686340332, "var_gnorm": 26.991273880004883, "vf_loss": 27407810.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.000375509262085, "var_IS": 0.00014459475642070174, "model": {}, "grad_gnorm": [79.99998474121094]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 148.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 74150, "num_env_steps_trained": 74000, "num_agent_steps_sampled": 74150, "num_agent_steps_trained": 74000, "num_training_step_calls_since_last_synch_worker_weights": 433, "last_target_update_ts": 74150, "num_weight_broadcasts": 1472, "num_target_updates": 1472, "num_samples_added_to_queue": 74000, "learner_queue": {"size_count": 148, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.922, "learner_load_time_ms": 0.1, "learner_load_wait_time_ms": 986.535, "learner_dequeue_time_ms": 13908.029}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -778420.3513513514, "episode_len_mean": 1988.054054054054, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4148105029607011, "mean_inference_ms": 1.1137098657592908, "mean_action_processing_ms": 0.16111920942503283, "mean_env_wait_ms": 0.05935624620893896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004067292084565034, "StateBufferConnector_ms": 0.00765130326554582, "ViewRequirementAgentConnector_ms": 0.13431793934590108}}, "episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -778420.3513513514, "episode_len_mean": 1988.054054054054, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4148105029607011, "mean_inference_ms": 1.1137098657592908, "mean_action_processing_ms": 0.16111920942503283, "mean_env_wait_ms": 0.05935624620893896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004067292084565034, "StateBufferConnector_ms": 0.00765130326554582, "ViewRequirementAgentConnector_ms": 0.13431793934590108}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74150, "num_agent_steps_trained": 74000, "num_env_steps_sampled": 74150, "num_env_steps_trained": 74000, "num_env_steps_sampled_this_iter": 5050, "num_env_steps_trained_this_iter": 5000, "num_env_steps_sampled_throughput_per_sec": 504.9779554692158, "num_env_steps_trained_throughput_per_sec": 499.9781737318968, "timesteps_total": 74150, "num_steps_trained_this_iter": 5000, "agent_timesteps_total": 74150, "timers": {"training_iteration_time_ms": 0.325, "sample_time_ms": 0.075, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 74150, "num_env_steps_trained": 74000, "num_agent_steps_sampled": 74150, "num_agent_steps_trained": 74000, "num_training_step_calls_since_last_synch_worker_weights": 433, "last_target_update_ts": 74150, "num_weight_broadcasts": 1472, "num_target_updates": 1472, "num_samples_added_to_queue": 74000}, "done": false, "episodes_total": 37, "training_iteration": 14, "trial_id": "304dd_00000", "date": "2023-12-11_01-49-45", "timestamp": 1702288185, "time_this_iter_s": 10.09505844116211, "time_total_s": 141.63348770141602, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 141.63348770141602, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 38.82142857142857, "ram_util_percent": 87.71428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 11451867.0, "policy_loss": 5722.22607421875, "entropy": 1.0701565742492676, "var_gnorm": 27.363088607788086, "vf_loss": 22892290.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9999274611473083, "var_IS": 9.994539868785068e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 157.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 78900, "num_env_steps_trained": 78500, "num_agent_steps_sampled": 78900, "num_agent_steps_trained": 78500, "num_training_step_calls_since_last_synch_worker_weights": 156, "last_target_update_ts": 78900, "num_weight_broadcasts": 1566, "num_target_updates": 1566, "num_samples_added_to_queue": 78500, "learner_queue": {"size_count": 157, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 13.803, "learner_load_time_ms": 0.1, "learner_load_wait_time_ms": 1075.904, "learner_dequeue_time_ms": 13908.029}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -714863.8837209302, "episode_len_mean": 1831.5348837209303, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41510583198654233, "mean_inference_ms": 1.1131090138757986, "mean_action_processing_ms": 0.161169491286326, "mean_env_wait_ms": 0.05940715017468537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003499762956486192, "StateBufferConnector_ms": 0.011344843132551326, "ViewRequirementAgentConnector_ms": 0.1417986182279365}}, "episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -714863.8837209302, "episode_len_mean": 1831.5348837209303, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41510583198654233, "mean_inference_ms": 1.1131090138757986, "mean_action_processing_ms": 0.161169491286326, "mean_env_wait_ms": 0.05940715017468537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003499762956486192, "StateBufferConnector_ms": 0.011344843132551326, "ViewRequirementAgentConnector_ms": 0.1417986182279365}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78900, "num_agent_steps_trained": 78500, "num_env_steps_sampled": 78900, "num_env_steps_trained": 78500, "num_env_steps_sampled_this_iter": 4750, "num_env_steps_trained_this_iter": 4500, "num_env_steps_sampled_throughput_per_sec": 474.9877128203294, "num_env_steps_trained_throughput_per_sec": 449.9883595139963, "timesteps_total": 78900, "num_steps_trained_this_iter": 4500, "agent_timesteps_total": 78900, "timers": {"training_iteration_time_ms": 0.203, "sample_time_ms": 0.189, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 78900, "num_env_steps_trained": 78500, "num_agent_steps_sampled": 78900, "num_agent_steps_trained": 78500, "num_training_step_calls_since_last_synch_worker_weights": 156, "last_target_update_ts": 78900, "num_weight_broadcasts": 1566, "num_target_updates": 1566, "num_samples_added_to_queue": 78500}, "done": false, "episodes_total": 43, "training_iteration": 15, "trial_id": "304dd_00000", "date": "2023-12-11_01-49-55", "timestamp": 1702288195, "time_this_iter_s": 10.134913206100464, "time_total_s": 151.76840090751648, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 151.76840090751648, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 40.72857142857142, "ram_util_percent": 87.80714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 15752632.0, "policy_loss": 6291.62255859375, "entropy": 1.0771535634994507, "var_gnorm": 27.760292053222656, "vf_loss": 31492680.0, "vf_explained_var": -3.528594970703125e-05, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9998711943626404, "var_IS": 8.261411130661145e-05, "model": {}, "grad_gnorm": [105.8300552368164]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 166.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 83000, "num_env_steps_trained": 83000, "num_agent_steps_sampled": 83000, "num_agent_steps_trained": 83000, "num_training_step_calls_since_last_synch_worker_weights": 384, "last_target_update_ts": 83000, "num_weight_broadcasts": 1647, "num_target_updates": 1647, "num_samples_added_to_queue": 83000, "learner_queue": {"size_count": 166, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 15.623, "learner_load_time_ms": 0.1, "learner_load_wait_time_ms": 1174.732, "learner_dequeue_time_ms": 15578.074}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -684725.2340425532, "episode_len_mean": 1762.4468085106382, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4158313742994697, "mean_inference_ms": 1.114008458457355, "mean_action_processing_ms": 0.16144030636801826, "mean_env_wait_ms": 0.05956806589359353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032019107899767286, "StateBufferConnector_ms": 0.010379324568078873, "ViewRequirementAgentConnector_ms": 0.13708611752124542}}, "episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -684725.2340425532, "episode_len_mean": 1762.4468085106382, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4158313742994697, "mean_inference_ms": 1.114008458457355, "mean_action_processing_ms": 0.16144030636801826, "mean_env_wait_ms": 0.05956806589359353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032019107899767286, "StateBufferConnector_ms": 0.010379324568078873, "ViewRequirementAgentConnector_ms": 0.13708611752124542}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83000, "num_agent_steps_trained": 83000, "num_env_steps_sampled": 83000, "num_env_steps_trained": 83000, "num_env_steps_sampled_this_iter": 4100, "num_env_steps_trained_this_iter": 4500, "num_env_steps_sampled_throughput_per_sec": 409.9841062031582, "num_env_steps_trained_throughput_per_sec": 449.9825555888322, "timesteps_total": 83000, "num_steps_trained_this_iter": 4500, "agent_timesteps_total": 83000, "timers": {"training_iteration_time_ms": 0.199, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 83000, "num_env_steps_trained": 83000, "num_agent_steps_sampled": 83000, "num_agent_steps_trained": 83000, "num_training_step_calls_since_last_synch_worker_weights": 384, "last_target_update_ts": 83000, "num_weight_broadcasts": 1647, "num_target_updates": 1647, "num_samples_added_to_queue": 83000}, "done": false, "episodes_total": 47, "training_iteration": 16, "trial_id": "304dd_00000", "date": "2023-12-11_01-50-05", "timestamp": 1702288205, "time_this_iter_s": 10.106001615524292, "time_total_s": 161.87440252304077, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 161.87440252304077, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 50.87857142857143, "ram_util_percent": 89.22857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 85570680.0, "policy_loss": 16206.28515625, "entropy": 1.0409482717514038, "var_gnorm": 28.166015625, "vf_loss": 171108944.0, "vf_explained_var": -4.291534423828125e-06, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0012561082839966, "var_IS": 0.00015318006626330316, "model": {}, "grad_gnorm": [105.8300552368164]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 174.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 87250, "num_env_steps_trained": 87000, "num_agent_steps_sampled": 87250, "num_agent_steps_trained": 87000, "num_training_step_calls_since_last_synch_worker_weights": 256, "last_target_update_ts": 87250, "num_weight_broadcasts": 1731, "num_target_updates": 1731, "num_samples_added_to_queue": 87000, "learner_queue": {"size_count": 174, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 15.262, "learner_load_time_ms": 0.1, "learner_load_wait_time_ms": 1129.898, "learner_dequeue_time_ms": 15578.074}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -684725.2340425532, "episode_len_mean": 1762.4468085106382, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4158313742994697, "mean_inference_ms": 1.114008458457355, "mean_action_processing_ms": 0.16144030636801826, "mean_env_wait_ms": 0.05956806589359353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032019107899767286, "StateBufferConnector_ms": 0.010379324568078873, "ViewRequirementAgentConnector_ms": 0.13708611752124542}}, "episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -684725.2340425532, "episode_len_mean": 1762.4468085106382, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4158313742994697, "mean_inference_ms": 1.114008458457355, "mean_action_processing_ms": 0.16144030636801826, "mean_env_wait_ms": 0.05956806589359353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032019107899767286, "StateBufferConnector_ms": 0.010379324568078873, "ViewRequirementAgentConnector_ms": 0.13708611752124542}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87250, "num_agent_steps_trained": 87000, "num_env_steps_sampled": 87250, "num_env_steps_trained": 87000, "num_env_steps_sampled_this_iter": 4250, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 424.9992299093849, "num_env_steps_trained_throughput_per_sec": 399.99927520883284, "timesteps_total": 87250, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 87250, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.101}, "counters": {"num_env_steps_sampled": 87250, "num_env_steps_trained": 87000, "num_agent_steps_sampled": 87250, "num_agent_steps_trained": 87000, "num_training_step_calls_since_last_synch_worker_weights": 256, "last_target_update_ts": 87250, "num_weight_broadcasts": 1731, "num_target_updates": 1731, "num_samples_added_to_queue": 87000}, "done": false, "episodes_total": 47, "training_iteration": 17, "trial_id": "304dd_00000", "date": "2023-12-11_01-50-15", "timestamp": 1702288215, "time_this_iter_s": 10.151249885559082, "time_total_s": 172.02565240859985, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 172.02565240859985, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 45.96, "ram_util_percent": 90.05999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 22471186.0, "policy_loss": 8428.88671875, "entropy": 0.9437427520751953, "var_gnorm": 28.90631103515625, "vf_loss": 44925516.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9989352822303772, "var_IS": 0.00016152406169567257, "model": {}, "grad_gnorm": [79.99999237060547]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 184.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 92100, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92100, "num_agent_steps_trained": 92000, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 92100, "num_weight_broadcasts": 1827, "num_target_updates": 1827, "num_samples_added_to_queue": 92000, "learner_queue": {"size_count": 184, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.901, "learner_load_time_ms": 0.1, "learner_load_wait_time_ms": 1055.548, "learner_dequeue_time_ms": 15727.438}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -707602.3137254902, "episode_len_mean": 1772.3529411764705, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.417115037739591, "mean_inference_ms": 1.1158883372339827, "mean_action_processing_ms": 0.16193669071402741, "mean_env_wait_ms": 0.05981948262823293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002950780531939338, "StateBufferConnector_ms": 0.011525434606215534, "ViewRequirementAgentConnector_ms": 0.14383933123420267}}, "episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -707602.3137254902, "episode_len_mean": 1772.3529411764705, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.417115037739591, "mean_inference_ms": 1.1158883372339827, "mean_action_processing_ms": 0.16193669071402741, "mean_env_wait_ms": 0.05981948262823293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002950780531939338, "StateBufferConnector_ms": 0.011525434606215534, "ViewRequirementAgentConnector_ms": 0.14383933123420267}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 1, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92100, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92100, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4850, "num_env_steps_trained_this_iter": 5000, "num_env_steps_sampled_throughput_per_sec": 484.9168163181923, "num_env_steps_trained_throughput_per_sec": 499.91424362700235, "timesteps_total": 92100, "num_steps_trained_this_iter": 5000, "agent_timesteps_total": 92100, "timers": {"training_iteration_time_ms": 1.099, "sample_time_ms": 0.049, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 92100, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92100, "num_agent_steps_trained": 92000, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 92100, "num_weight_broadcasts": 1827, "num_target_updates": 1827, "num_samples_added_to_queue": 92000}, "done": false, "episodes_total": 51, "training_iteration": 18, "trial_id": "304dd_00000", "date": "2023-12-11_01-50-25", "timestamp": 1702288225, "time_this_iter_s": 10.089521169662476, "time_total_s": 182.11517357826233, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 182.11517357826233, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 38.99285714285714, "ram_util_percent": 90.45714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 16696742.0, "policy_loss": 7022.0029296875, "entropy": 0.9106002449989319, "var_gnorm": 29.31271743774414, "vf_loss": 33379440.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0005558729171753, "var_IS": 0.00012672707089222968, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 194.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 97350, "num_env_steps_trained": 97000, "num_agent_steps_sampled": 97350, "num_agent_steps_trained": 97000, "num_training_step_calls_since_last_synch_worker_weights": 118, "last_target_update_ts": 97350, "num_weight_broadcasts": 1932, "num_target_updates": 1932, "num_samples_added_to_queue": 97000, "learner_queue": {"size_count": 194, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 14.544, "learner_load_time_ms": 0.1, "learner_load_wait_time_ms": 956.917, "learner_dequeue_time_ms": 15828.54}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -727246.0576923077, "episode_len_mean": 1827.7307692307693, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41739066398567126, "mean_inference_ms": 1.1162802103341916, "mean_action_processing_ms": 0.1620381834033788, "mean_env_wait_ms": 0.059883424408706226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028940347524789665, "StateBufferConnector_ms": 0.01130379163301908, "ViewRequirementAgentConnector_ms": 0.14322079144991362}}, "episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -727246.0576923077, "episode_len_mean": 1827.7307692307693, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41739066398567126, "mean_inference_ms": 1.1162802103341916, "mean_action_processing_ms": 0.1620381834033788, "mean_env_wait_ms": 0.059883424408706226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028940347524789665, "StateBufferConnector_ms": 0.01130379163301908, "ViewRequirementAgentConnector_ms": 0.14322079144991362}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97350, "num_agent_steps_trained": 97000, "num_env_steps_sampled": 97350, "num_env_steps_trained": 97000, "num_env_steps_sampled_this_iter": 5250, "num_env_steps_trained_this_iter": 5000, "num_env_steps_sampled_throughput_per_sec": 524.9614130011491, "num_env_steps_trained_throughput_per_sec": 499.9632504772849, "timesteps_total": 97350, "num_steps_trained_this_iter": 5000, "agent_timesteps_total": 97350, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.1}, "counters": {"num_env_steps_sampled": 97350, "num_env_steps_trained": 97000, "num_agent_steps_sampled": 97350, "num_agent_steps_trained": 97000, "num_training_step_calls_since_last_synch_worker_weights": 118, "last_target_update_ts": 97350, "num_weight_broadcasts": 1932, "num_target_updates": 1932, "num_samples_added_to_queue": 97000}, "done": false, "episodes_total": 52, "training_iteration": 19, "trial_id": "304dd_00000", "date": "2023-12-11_01-50-35", "timestamp": 1702288235, "time_this_iter_s": 10.135439157485962, "time_total_s": 192.2506127357483, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 192.2506127357483, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 36.98571428571428, "ram_util_percent": 90.54999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 14984858.0, "policy_loss": 6526.93603515625, "entropy": 1.0450646877288818, "var_gnorm": 29.51110076904297, "vf_loss": 29956662.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0009149312973022, "var_IS": 0.0001169484166894108, "model": {}, "grad_gnorm": [79.99999237060547]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 205.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 102850, "num_env_steps_trained": 102500, "num_agent_steps_sampled": 102850, "num_agent_steps_trained": 102500, "num_training_step_calls_since_last_synch_worker_weights": 426, "last_target_update_ts": 102850, "num_weight_broadcasts": 2041, "num_target_updates": 2041, "num_samples_added_to_queue": 102500, "learner_queue": {"size_count": 205, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.59, "learner_load_time_ms": 0.1, "learner_load_wait_time_ms": 907.596, "learner_dequeue_time_ms": 15828.54}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -752594.0754716981, "episode_len_mean": 1905.2075471698113, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4176296613668873, "mean_inference_ms": 1.1165813485172227, "mean_action_processing_ms": 0.16211860269876638, "mean_env_wait_ms": 0.05993816298348381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028394303231869104, "StateBufferConnector_ms": 0.011090512545603627, "ViewRequirementAgentConnector_ms": 0.1424060677582363}}, "episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -752594.0754716981, "episode_len_mean": 1905.2075471698113, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4176296613668873, "mean_inference_ms": 1.1165813485172227, "mean_action_processing_ms": 0.16211860269876638, "mean_env_wait_ms": 0.05993816298348381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028394303231869104, "StateBufferConnector_ms": 0.011090512545603627, "ViewRequirementAgentConnector_ms": 0.1424060677582363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102850, "num_agent_steps_trained": 102500, "num_env_steps_sampled": 102850, "num_env_steps_trained": 102500, "num_env_steps_sampled_this_iter": 5500, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 549.9728180491492, "num_env_steps_trained_throughput_per_sec": 549.9728180491492, "timesteps_total": 102850, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 102850, "timers": {"training_iteration_time_ms": 0.394, "sample_time_ms": 0.13, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 102850, "num_env_steps_trained": 102500, "num_agent_steps_sampled": 102850, "num_agent_steps_trained": 102500, "num_training_step_calls_since_last_synch_worker_weights": 426, "last_target_update_ts": 102850, "num_weight_broadcasts": 2041, "num_target_updates": 2041, "num_samples_added_to_queue": 102500}, "done": false, "episodes_total": 53, "training_iteration": 20, "trial_id": "304dd_00000", "date": "2023-12-11_01-50-46", "timestamp": 1702288246, "time_this_iter_s": 10.088197231292725, "time_total_s": 202.33880996704102, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 202.33880996704102, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 33.778571428571425, "ram_util_percent": 90.61428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 24916526.0, "policy_loss": 7702.4873046875, "entropy": 1.0950865745544434, "var_gnorm": 30.147520065307617, "vf_loss": 49817648.0, "vf_explained_var": -1.9311904907226562e-05, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0002609491348267, "var_IS": 7.6969554356765e-05, "model": {}, "grad_gnorm": [105.8300552368164]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 217.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 108650, "num_env_steps_trained": 108500, "num_agent_steps_sampled": 108650, "num_agent_steps_trained": 108500, "num_training_step_calls_since_last_synch_worker_weights": 402, "last_target_update_ts": 108650, "num_weight_broadcasts": 2156, "num_target_updates": 2156, "num_samples_added_to_queue": 108500, "learner_queue": {"size_count": 217, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.694, "learner_load_time_ms": 0.1, "learner_load_wait_time_ms": 854.831, "learner_dequeue_time_ms": 15819.399}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -741673.5344827586, "episode_len_mean": 1869.8620689655172, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4184462443940829, "mean_inference_ms": 1.1174313703, "mean_action_processing_ms": 0.16232719747436042, "mean_env_wait_ms": 0.060117531059501024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681511714540679, "StateBufferConnector_ms": 0.010134433877879176, "ViewRequirementAgentConnector_ms": 0.14010297841039196}}, "episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -741673.5344827586, "episode_len_mean": 1869.8620689655172, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4184462443940829, "mean_inference_ms": 1.1174313703, "mean_action_processing_ms": 0.16232719747436042, "mean_env_wait_ms": 0.060117531059501024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681511714540679, "StateBufferConnector_ms": 0.010134433877879176, "ViewRequirementAgentConnector_ms": 0.14010297841039196}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108650, "num_agent_steps_trained": 108500, "num_env_steps_sampled": 108650, "num_env_steps_trained": 108500, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 579.9889237611786, "num_env_steps_trained_throughput_per_sec": 599.9885418219089, "timesteps_total": 108650, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 108650, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 108650, "num_env_steps_trained": 108500, "num_agent_steps_sampled": 108650, "num_agent_steps_trained": 108500, "num_training_step_calls_since_last_synch_worker_weights": 402, "last_target_update_ts": 108650, "num_weight_broadcasts": 2156, "num_target_updates": 2156, "num_samples_added_to_queue": 108500}, "done": false, "episodes_total": 58, "training_iteration": 21, "trial_id": "304dd_00000", "date": "2023-12-11_01-50-56", "timestamp": 1702288256, "time_this_iter_s": 10.086510181427002, "time_total_s": 212.42532014846802, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 212.42532014846802, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 32.40714285714286, "ram_util_percent": 90.70714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 20213410.0, "policy_loss": 7825.119140625, "entropy": 1.0419291257858276, "var_gnorm": 30.918214797973633, "vf_loss": 40411168.0, "vf_explained_var": -2.384185791015625e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9999321699142456, "var_IS": 2.2668004930892494e-06, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 229.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 114500, "num_env_steps_trained": 114500, "num_agent_steps_sampled": 114500, "num_agent_steps_trained": 114500, "num_training_step_calls_since_last_synch_worker_weights": 158, "last_target_update_ts": 114500, "num_weight_broadcasts": 2272, "num_target_updates": 2272, "num_samples_added_to_queue": 114500, "learner_queue": {"size_count": 229, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.013, "learner_load_time_ms": 0.1, "learner_load_wait_time_ms": 853.036, "learner_dequeue_time_ms": 15720.514}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -740292.9833333333, "episode_len_mean": 1867.3, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4186404089873989, "mean_inference_ms": 1.117554645450034, "mean_action_processing_ms": 0.16233164843044717, "mean_env_wait_ms": 0.06017111424629841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035587946573893228, "StateBufferConnector_ms": 0.009796619415283203, "ViewRequirementAgentConnector_ms": 0.13623833656311035}}, "episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -740292.9833333333, "episode_len_mean": 1867.3, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4186404089873989, "mean_inference_ms": 1.117554645450034, "mean_action_processing_ms": 0.16233164843044717, "mean_env_wait_ms": 0.06017111424629841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035587946573893228, "StateBufferConnector_ms": 0.009796619415283203, "ViewRequirementAgentConnector_ms": 0.13623833656311035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114500, "num_agent_steps_trained": 114500, "num_env_steps_sampled": 114500, "num_env_steps_trained": 114500, "num_env_steps_sampled_this_iter": 5850, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 584.9441874828742, "num_env_steps_trained_throughput_per_sec": 599.9427563926915, "timesteps_total": 114500, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 114500, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 114500, "num_env_steps_trained": 114500, "num_agent_steps_sampled": 114500, "num_agent_steps_trained": 114500, "num_training_step_calls_since_last_synch_worker_weights": 158, "last_target_update_ts": 114500, "num_weight_broadcasts": 2272, "num_target_updates": 2272, "num_samples_added_to_queue": 114500}, "done": false, "episodes_total": 60, "training_iteration": 22, "trial_id": "304dd_00000", "date": "2023-12-11_01-51-06", "timestamp": 1702288266, "time_this_iter_s": 10.123549461364746, "time_total_s": 222.54886960983276, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 222.54886960983276, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 32.88666666666667, "ram_util_percent": 90.78666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 69538328.0, "policy_loss": 13692.43359375, "entropy": 0.9701686501502991, "var_gnorm": 31.26129150390625, "vf_loss": 139049264.0, "vf_explained_var": 5.960464477539063e-08, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0018595457077026, "var_IS": 0.0002673297713045031, "model": {}, "grad_gnorm": [105.8300552368164]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 240.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 120250, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120250, "num_agent_steps_trained": 120000, "num_training_step_calls_since_last_synch_worker_weights": 134, "last_target_update_ts": 120250, "num_weight_broadcasts": 2386, "num_target_updates": 2386, "num_samples_added_to_queue": 120000, "learner_queue": {"size_count": 240, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.816, "learner_load_time_ms": 0.1, "learner_load_wait_time_ms": 871.955, "learner_dequeue_time_ms": 15720.514}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -747623.7096774194, "episode_len_mean": 1894.6774193548388, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4187523478924285, "mean_inference_ms": 1.117527778692273, "mean_action_processing_ms": 0.1622991170502191, "mean_env_wait_ms": 0.06021403917890678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003443994829731603, "StateBufferConnector_ms": 0.009480599434145035, "ViewRequirementAgentConnector_ms": 0.13364707269976217}}, "episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -747623.7096774194, "episode_len_mean": 1894.6774193548388, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4187523478924285, "mean_inference_ms": 1.117527778692273, "mean_action_processing_ms": 0.1622991170502191, "mean_env_wait_ms": 0.06021403917890678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003443994829731603, "StateBufferConnector_ms": 0.009480599434145035, "ViewRequirementAgentConnector_ms": 0.13364707269976217}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120250, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120250, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 5750, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 574.9494179880053, "num_env_steps_trained_throughput_per_sec": 549.9516172059181, "timesteps_total": 120250, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 120250, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.042, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 120250, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120250, "num_agent_steps_trained": 120000, "num_training_step_calls_since_last_synch_worker_weights": 134, "last_target_update_ts": 120250, "num_weight_broadcasts": 2386, "num_target_updates": 2386, "num_samples_added_to_queue": 120000}, "done": false, "episodes_total": 62, "training_iteration": 23, "trial_id": "304dd_00000", "date": "2023-12-11_01-51-16", "timestamp": 1702288276, "time_this_iter_s": 10.12360405921936, "time_total_s": 232.67247366905212, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 232.67247366905212, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 34.9, "ram_util_percent": 90.55000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 41952092.0, "policy_loss": 10429.6025390625, "entropy": 0.9468872547149658, "var_gnorm": 32.06023025512695, "vf_loss": 83883328.0, "vf_explained_var": -5.4836273193359375e-06, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0003348588943481, "var_IS": 0.00015176796296145767, "model": {}, "grad_gnorm": [102.80656433105469]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 251.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 125950, "num_env_steps_trained": 125500, "num_agent_steps_sampled": 125950, "num_agent_steps_trained": 125500, "num_training_step_calls_since_last_synch_worker_weights": 159, "last_target_update_ts": 125950, "num_weight_broadcasts": 2499, "num_target_updates": 2499, "num_samples_added_to_queue": 125500, "learner_queue": {"size_count": 251, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 14.162, "learner_load_time_ms": 0.1, "learner_load_wait_time_ms": 877.601, "learner_dequeue_time_ms": 15638.088}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -747623.7096774194, "episode_len_mean": 1894.6774193548388, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4187523478924285, "mean_inference_ms": 1.117527778692273, "mean_action_processing_ms": 0.1622991170502191, "mean_env_wait_ms": 0.06021403917890678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003443994829731603, "StateBufferConnector_ms": 0.009480599434145035, "ViewRequirementAgentConnector_ms": 0.13364707269976217}}, "episode_reward_max": -20206.0, "episode_reward_min": -2957230.0, "episode_reward_mean": -747623.7096774194, "episode_len_mean": 1894.6774193548388, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4187523478924285, "mean_inference_ms": 1.117527778692273, "mean_action_processing_ms": 0.1622991170502191, "mean_env_wait_ms": 0.06021403917890678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003443994829731603, "StateBufferConnector_ms": 0.009480599434145035, "ViewRequirementAgentConnector_ms": 0.13364707269976217}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125950, "num_agent_steps_trained": 125500, "num_env_steps_sampled": 125950, "num_env_steps_trained": 125500, "num_env_steps_sampled_this_iter": 5700, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 569.9679976788871, "num_env_steps_trained_throughput_per_sec": 549.9691205673471, "timesteps_total": 125950, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 125950, "timers": {"training_iteration_time_ms": 0.172, "sample_time_ms": 0.058, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 125950, "num_env_steps_trained": 125500, "num_agent_steps_sampled": 125950, "num_agent_steps_trained": 125500, "num_training_step_calls_since_last_synch_worker_weights": 159, "last_target_update_ts": 125950, "num_weight_broadcasts": 2499, "num_target_updates": 2499, "num_samples_added_to_queue": 125500}, "done": false, "episodes_total": 62, "training_iteration": 24, "trial_id": "304dd_00000", "date": "2023-12-11_01-51-26", "timestamp": 1702288286, "time_this_iter_s": 10.126575946807861, "time_total_s": 242.79904961585999, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 242.79904961585999, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 35.06428571428571, "ram_util_percent": 90.46428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 52685464.0, "policy_loss": 11465.5478515625, "entropy": 0.9565922617912292, "var_gnorm": 32.740028381347656, "vf_loss": 105348000.0, "vf_explained_var": -1.0848045349121094e-05, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9997270107269287, "var_IS": 9.587492240825668e-05, "model": {}, "grad_gnorm": [105.8300552368164]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 263.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 131750, "num_env_steps_trained": 131500, "num_agent_steps_sampled": 131750, "num_agent_steps_trained": 131500, "num_training_step_calls_since_last_synch_worker_weights": 316, "last_target_update_ts": 131750, "num_weight_broadcasts": 2614, "num_target_updates": 2614, "num_samples_added_to_queue": 131500, "learner_queue": {"size_count": 263, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.257, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 861.471, "learner_dequeue_time_ms": 15512.335}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -812301.0, "episode_len_mean": 1990.4242424242425, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4187287478421569, "mean_inference_ms": 1.117042105559677, "mean_action_processing_ms": 0.1621306048198878, "mean_env_wait_ms": 0.060228496436008104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00323526787035393, "StateBufferConnector_ms": 0.008906017650257458, "ViewRequirementAgentConnector_ms": 0.13041929765181107}}, "episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -812301.0, "episode_len_mean": 1990.4242424242425, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4187287478421569, "mean_inference_ms": 1.117042105559677, "mean_action_processing_ms": 0.1621306048198878, "mean_env_wait_ms": 0.060228496436008104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00323526787035393, "StateBufferConnector_ms": 0.008906017650257458, "ViewRequirementAgentConnector_ms": 0.13041929765181107}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131750, "num_agent_steps_trained": 131500, "num_env_steps_sampled": 131750, "num_env_steps_trained": 131500, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 579.9668969928885, "num_env_steps_trained_throughput_per_sec": 599.9657555098846, "timesteps_total": 131750, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 131750, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.169, "synch_weights_time_ms": 0.031}, "counters": {"num_env_steps_sampled": 131750, "num_env_steps_trained": 131500, "num_agent_steps_sampled": 131750, "num_agent_steps_trained": 131500, "num_training_step_calls_since_last_synch_worker_weights": 316, "last_target_update_ts": 131750, "num_weight_broadcasts": 2614, "num_target_updates": 2614, "num_samples_added_to_queue": 131500}, "done": false, "episodes_total": 66, "training_iteration": 25, "trial_id": "304dd_00000", "date": "2023-12-11_01-51-36", "timestamp": 1702288296, "time_this_iter_s": 10.099354982376099, "time_total_s": 252.89840459823608, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 252.89840459823608, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 32.65714285714286, "ram_util_percent": 90.69285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 19576100.0, "policy_loss": 7752.06494140625, "entropy": 1.0357613563537598, "var_gnorm": 33.281532287597656, "vf_loss": 39136696.0, "vf_explained_var": 1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0000139474868774, "var_IS": 0.00019491532293614, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 275.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 137500, "num_env_steps_trained": 137500, "num_agent_steps_sampled": 137500, "num_agent_steps_trained": 137500, "num_training_step_calls_since_last_synch_worker_weights": 225, "last_target_update_ts": 137500, "num_weight_broadcasts": 2728, "num_target_updates": 2728, "num_samples_added_to_queue": 137500, "learner_queue": {"size_count": 275, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.358, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 866.096, "learner_dequeue_time_ms": 15472.553}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -771244.7361111111, "episode_len_mean": 1901.111111111111, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41853586939810505, "mean_inference_ms": 1.1161700374348844, "mean_action_processing_ms": 0.16184108196469837, "mean_env_wait_ms": 0.060208897217956636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005486276414659288, "StateBufferConnector_ms": 0.008163849512736002, "ViewRequirementAgentConnector_ms": 0.1277940140830146}}, "episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -771244.7361111111, "episode_len_mean": 1901.111111111111, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41853586939810505, "mean_inference_ms": 1.1161700374348844, "mean_action_processing_ms": 0.16184108196469837, "mean_env_wait_ms": 0.060208897217956636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005486276414659288, "StateBufferConnector_ms": 0.008163849512736002, "ViewRequirementAgentConnector_ms": 0.1277940140830146}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137500, "num_agent_steps_trained": 137500, "num_env_steps_sampled": 137500, "num_env_steps_trained": 137500, "num_env_steps_sampled_this_iter": 5750, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 574.9804926576363, "num_env_steps_trained_throughput_per_sec": 599.9796445123162, "timesteps_total": 137500, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 137500, "timers": {"training_iteration_time_ms": 0.299, "sample_time_ms": 0.192, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 137500, "num_env_steps_trained": 137500, "num_agent_steps_sampled": 137500, "num_agent_steps_trained": 137500, "num_training_step_calls_since_last_synch_worker_weights": 225, "last_target_update_ts": 137500, "num_weight_broadcasts": 2728, "num_target_updates": 2728, "num_samples_added_to_queue": 137500}, "done": false, "episodes_total": 72, "training_iteration": 26, "trial_id": "304dd_00000", "date": "2023-12-11_01-51-47", "timestamp": 1702288307, "time_this_iter_s": 10.11229157447815, "time_total_s": 263.01069617271423, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 263.01069617271423, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 32.371428571428574, "ram_util_percent": 90.78571428571426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 16324779.0, "policy_loss": 6865.515625, "entropy": 1.081670880317688, "var_gnorm": 33.555992126464844, "vf_loss": 32635826.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.000868797302246, "var_IS": 0.00042252492858096957, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 286.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 143400, "num_env_steps_trained": 143000, "num_agent_steps_sampled": 143400, "num_agent_steps_trained": 143000, "num_training_step_calls_since_last_synch_worker_weights": 58, "last_target_update_ts": 143400, "num_weight_broadcasts": 2845, "num_target_updates": 2845, "num_samples_added_to_queue": 143000, "learner_queue": {"size_count": 286, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.305, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 849.362, "learner_dequeue_time_ms": 15472.553}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -767223.0810810811, "episode_len_mean": 1895.7027027027027, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41843110426811303, "mean_inference_ms": 1.1157954220401034, "mean_action_processing_ms": 0.16172706156511002, "mean_env_wait_ms": 0.06019223692574179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005337998673722551, "StateBufferConnector_ms": 0.007943204931310704, "ViewRequirementAgentConnector_ms": 0.1280252997939651}}, "episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -767223.0810810811, "episode_len_mean": 1895.7027027027027, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41843110426811303, "mean_inference_ms": 1.1157954220401034, "mean_action_processing_ms": 0.16172706156511002, "mean_env_wait_ms": 0.06019223692574179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005337998673722551, "StateBufferConnector_ms": 0.007943204931310704, "ViewRequirementAgentConnector_ms": 0.1280252997939651}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143400, "num_agent_steps_trained": 143000, "num_env_steps_sampled": 143400, "num_env_steps_trained": 143000, "num_env_steps_sampled_this_iter": 5900, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 589.9751733259935, "num_env_steps_trained_throughput_per_sec": 549.9768564903329, "timesteps_total": 143400, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 143400, "timers": {"training_iteration_time_ms": 0.237, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.137}, "counters": {"num_env_steps_sampled": 143400, "num_env_steps_trained": 143000, "num_agent_steps_sampled": 143400, "num_agent_steps_trained": 143000, "num_training_step_calls_since_last_synch_worker_weights": 58, "last_target_update_ts": 143400, "num_weight_broadcasts": 2845, "num_target_updates": 2845, "num_samples_added_to_queue": 143000}, "done": false, "episodes_total": 74, "training_iteration": 27, "trial_id": "304dd_00000", "date": "2023-12-11_01-51-57", "timestamp": 1702288317, "time_this_iter_s": 10.143054246902466, "time_total_s": 273.1537504196167, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 273.1537504196167, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 33.47857142857143, "ram_util_percent": 90.71428571428574}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 14978374.0, "policy_loss": 6590.4228515625, "entropy": 1.0006823539733887, "var_gnorm": 33.8978385925293, "vf_loss": 29943568.0, "vf_explained_var": 5.960464477539063e-08, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0001248121261597, "var_IS": 0.00015178641478996724, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 298.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 149100, "num_env_steps_trained": 149000, "num_agent_steps_sampled": 149100, "num_agent_steps_trained": 149000, "num_training_step_calls_since_last_synch_worker_weights": 66, "last_target_update_ts": 149100, "num_weight_broadcasts": 2958, "num_target_updates": 2958, "num_samples_added_to_queue": 149000, "learner_queue": {"size_count": 298, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.645, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 880.653, "learner_dequeue_time_ms": 15431.079}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -753948.911392405, "episode_len_mean": 1866.3164556962026, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41808254247912946, "mean_inference_ms": 1.1148269694531094, "mean_action_processing_ms": 0.16143745935509507, "mean_env_wait_ms": 0.06013183725107037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050001506563983385, "StateBufferConnector_ms": 0.007440470441987243, "ViewRequirementAgentConnector_ms": 0.12950655780261075}}, "episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -753948.911392405, "episode_len_mean": 1866.3164556962026, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41808254247912946, "mean_inference_ms": 1.1148269694531094, "mean_action_processing_ms": 0.16143745935509507, "mean_env_wait_ms": 0.06013183725107037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050001506563983385, "StateBufferConnector_ms": 0.007440470441987243, "ViewRequirementAgentConnector_ms": 0.12950655780261075}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149100, "num_agent_steps_trained": 149000, "num_env_steps_sampled": 149100, "num_env_steps_trained": 149000, "num_env_steps_sampled_this_iter": 5700, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 569.9846302839077, "num_env_steps_trained_throughput_per_sec": 599.9838213514818, "timesteps_total": 149100, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 149100, "timers": {"training_iteration_time_ms": 0.231, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.031}, "counters": {"num_env_steps_sampled": 149100, "num_env_steps_trained": 149000, "num_agent_steps_sampled": 149100, "num_agent_steps_trained": 149000, "num_training_step_calls_since_last_synch_worker_weights": 66, "last_target_update_ts": 149100, "num_weight_broadcasts": 2958, "num_target_updates": 2958, "num_samples_added_to_queue": 149000}, "done": false, "episodes_total": 79, "training_iteration": 28, "trial_id": "304dd_00000", "date": "2023-12-11_01-52-07", "timestamp": 1702288327, "time_this_iter_s": 10.139625072479248, "time_total_s": 283.29337549209595, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 283.29337549209595, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 33.96666666666667, "ram_util_percent": 90.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 21951842.0, "policy_loss": 8264.1904296875, "entropy": 0.8644772171974182, "var_gnorm": 34.21520233154297, "vf_loss": 43887156.0, "vf_explained_var": -2.384185791015625e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0001332759857178, "var_IS": 3.913047112291679e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 309.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 154900, "num_env_steps_trained": 154500, "num_agent_steps_sampled": 154900, "num_agent_steps_trained": 154500, "num_training_step_calls_since_last_synch_worker_weights": 188, "last_target_update_ts": 154900, "num_weight_broadcasts": 3073, "num_target_updates": 3073, "num_samples_added_to_queue": 154500, "learner_queue": {"size_count": 309, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.388, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 859.578, "learner_dequeue_time_ms": 15158.756}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -746883.6585365854, "episode_len_mean": 1854.8292682926829, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41783780234042517, "mean_inference_ms": 1.11420481433586, "mean_action_processing_ms": 0.1612478673148899, "mean_env_wait_ms": 0.06008767063125734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004817218315310594, "StateBufferConnector_ms": 0.007168258108743807, "ViewRequirementAgentConnector_ms": 0.13104182917897295}}, "episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -746883.6585365854, "episode_len_mean": 1854.8292682926829, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41783780234042517, "mean_inference_ms": 1.11420481433586, "mean_action_processing_ms": 0.1612478673148899, "mean_env_wait_ms": 0.06008767063125734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004817218315310594, "StateBufferConnector_ms": 0.007168258108743807, "ViewRequirementAgentConnector_ms": 0.13104182917897295}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 154900, "num_agent_steps_trained": 154500, "num_env_steps_sampled": 154900, "num_env_steps_trained": 154500, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 579.9748197997366, "num_env_steps_trained_throughput_per_sec": 549.9761222238882, "timesteps_total": 154900, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 154900, "timers": {"training_iteration_time_ms": 0.183, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 154900, "num_env_steps_trained": 154500, "num_agent_steps_sampled": 154900, "num_agent_steps_trained": 154500, "num_training_step_calls_since_last_synch_worker_weights": 188, "last_target_update_ts": 154900, "num_weight_broadcasts": 3073, "num_target_updates": 3073, "num_samples_added_to_queue": 154500}, "done": false, "episodes_total": 82, "training_iteration": 29, "trial_id": "304dd_00000", "date": "2023-12-11_01-52-17", "timestamp": 1702288337, "time_this_iter_s": 10.11714482307434, "time_total_s": 293.4105203151703, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 293.4105203151703, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 33.15714285714286, "ram_util_percent": 90.77142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 73022728.0, "policy_loss": 14528.162109375, "entropy": 0.8619861602783203, "var_gnorm": 34.42945098876953, "vf_loss": 146016400.0, "vf_explained_var": -1.7881393432617188e-06, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.000158429145813, "var_IS": 7.232285952341044e-06, "model": {}, "grad_gnorm": [103.7264633178711]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 320.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 160400, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160400, "num_agent_steps_trained": 160000, "num_training_step_calls_since_last_synch_worker_weights": 137, "last_target_update_ts": 160400, "num_weight_broadcasts": 3182, "num_target_updates": 3182, "num_samples_added_to_queue": 160000, "learner_queue": {"size_count": 320, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.32, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 894.46, "learner_dequeue_time_ms": 15158.756}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -759205.469879518, "episode_len_mean": 1890.7710843373493, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41775449732584446, "mean_inference_ms": 1.1140080504668315, "mean_action_processing_ms": 0.16118062942441277, "mean_env_wait_ms": 0.06007301685843728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047591795404273345, "StateBufferConnector_ms": 0.007081893553216773, "ViewRequirementAgentConnector_ms": 0.12946301195994916}}, "episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -759205.469879518, "episode_len_mean": 1890.7710843373493, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41775449732584446, "mean_inference_ms": 1.1140080504668315, "mean_action_processing_ms": 0.16118062942441277, "mean_env_wait_ms": 0.06007301685843728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047591795404273345, "StateBufferConnector_ms": 0.007081893553216773, "ViewRequirementAgentConnector_ms": 0.12946301195994916}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160400, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160400, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 5500, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 549.9829011511064, "num_env_steps_trained_throughput_per_sec": 549.9829011511064, "timesteps_total": 160400, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 160400, "timers": {"training_iteration_time_ms": 0.1, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 160400, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160400, "num_agent_steps_trained": 160000, "num_training_step_calls_since_last_synch_worker_weights": 137, "last_target_update_ts": 160400, "num_weight_broadcasts": 3182, "num_target_updates": 3182, "num_samples_added_to_queue": 160000}, "done": false, "episodes_total": 83, "training_iteration": 30, "trial_id": "304dd_00000", "date": "2023-12-11_01-52-27", "timestamp": 1702288347, "time_this_iter_s": 10.163326025009155, "time_total_s": 303.57384634017944, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 303.57384634017944, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 35.957142857142856, "ram_util_percent": 90.77142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 15372586.0, "policy_loss": 6737.64208984375, "entropy": 0.9047073721885681, "var_gnorm": 35.16677474975586, "vf_loss": 30731696.0, "vf_explained_var": 5.960464477539063e-08, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0003583431243896, "var_IS": 5.522652281797491e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 331.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 165950, "num_env_steps_trained": 165500, "num_agent_steps_sampled": 165950, "num_agent_steps_trained": 165500, "num_training_step_calls_since_last_synch_worker_weights": 212, "last_target_update_ts": 165950, "num_weight_broadcasts": 3292, "num_target_updates": 3292, "num_samples_added_to_queue": 165500, "learner_queue": {"size_count": 331, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.561, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 902.902, "learner_dequeue_time_ms": 14820.748}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -775565.4712643678, "episode_len_mean": 1902.9655172413793, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4174090433626885, "mean_inference_ms": 1.1132161258701105, "mean_action_processing_ms": 0.1609208199974873, "mean_env_wait_ms": 0.06001877074065675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004540366687993893, "StateBufferConnector_ms": 0.007224905079808728, "ViewRequirementAgentConnector_ms": 0.12838758271316003}}, "episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -775565.4712643678, "episode_len_mean": 1902.9655172413793, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4174090433626885, "mean_inference_ms": 1.1132161258701105, "mean_action_processing_ms": 0.1609208199974873, "mean_env_wait_ms": 0.06001877074065675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004540366687993893, "StateBufferConnector_ms": 0.007224905079808728, "ViewRequirementAgentConnector_ms": 0.12838758271316003}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165950, "num_agent_steps_trained": 165500, "num_env_steps_sampled": 165950, "num_env_steps_trained": 165500, "num_env_steps_sampled_this_iter": 5550, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 554.9935030505658, "num_env_steps_trained_throughput_per_sec": 549.9935615816418, "timesteps_total": 165950, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 165950, "timers": {"training_iteration_time_ms": 0.143, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 165950, "num_env_steps_trained": 165500, "num_agent_steps_sampled": 165950, "num_agent_steps_trained": 165500, "num_training_step_calls_since_last_synch_worker_weights": 212, "last_target_update_ts": 165950, "num_weight_broadcasts": 3292, "num_target_updates": 3292, "num_samples_added_to_queue": 165500}, "done": false, "episodes_total": 87, "training_iteration": 31, "trial_id": "304dd_00000", "date": "2023-12-11_01-52-38", "timestamp": 1702288358, "time_this_iter_s": 10.139491081237793, "time_total_s": 313.71333742141724, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 313.71333742141724, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 36.29285714285714, "ram_util_percent": 88.39285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 41029648.0, "policy_loss": 9379.8115234375, "entropy": 0.9882056713104248, "var_gnorm": 35.53850555419922, "vf_loss": 82040536.0, "vf_explained_var": -1.0728836059570312e-06, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9997559785842896, "var_IS": 0.0003454167162999511, "model": {}, "grad_gnorm": [90.35148620605469]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 343.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 171650, "num_env_steps_trained": 171500, "num_agent_steps_sampled": 171650, "num_agent_steps_trained": 171500, "num_training_step_calls_since_last_synch_worker_weights": 322, "last_target_update_ts": 171650, "num_weight_broadcasts": 3405, "num_target_updates": 3405, "num_samples_added_to_queue": 171500, "learner_queue": {"size_count": 343, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.869, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 873.362, "learner_dequeue_time_ms": 14430.518}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -754027.8913043478, "episode_len_mean": 1861.0326086956522, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41696263792261534, "mean_inference_ms": 1.1122129727073307, "mean_action_processing_ms": 0.1606114897580677, "mean_env_wait_ms": 0.059944729659030804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042936076288637905, "StateBufferConnector_ms": 0.006832247195036515, "ViewRequirementAgentConnector_ms": 0.12786777123160983}}, "episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -754027.8913043478, "episode_len_mean": 1861.0326086956522, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41696263792261534, "mean_inference_ms": 1.1122129727073307, "mean_action_processing_ms": 0.1606114897580677, "mean_env_wait_ms": 0.059944729659030804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042936076288637905, "StateBufferConnector_ms": 0.006832247195036515, "ViewRequirementAgentConnector_ms": 0.12786777123160983}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 171650, "num_agent_steps_trained": 171500, "num_env_steps_sampled": 171650, "num_env_steps_trained": 171500, "num_env_steps_sampled_this_iter": 5700, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 569.9783793544399, "num_env_steps_trained_throughput_per_sec": 599.9772414257262, "timesteps_total": 171650, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 171650, "timers": {"training_iteration_time_ms": 0.182, "sample_time_ms": 0.182, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 171650, "num_env_steps_trained": 171500, "num_agent_steps_sampled": 171650, "num_agent_steps_trained": 171500, "num_training_step_calls_since_last_synch_worker_weights": 322, "last_target_update_ts": 171650, "num_weight_broadcasts": 3405, "num_target_updates": 3405, "num_samples_added_to_queue": 171500}, "done": false, "episodes_total": 92, "training_iteration": 32, "trial_id": "304dd_00000", "date": "2023-12-11_01-52-48", "timestamp": 1702288368, "time_this_iter_s": 10.105889797210693, "time_total_s": 323.81922721862793, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 323.81922721862793, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 34.385714285714286, "ram_util_percent": 87.37857142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 13402575.0, "policy_loss": 6176.77978515625, "entropy": 1.0325220823287964, "var_gnorm": 36.04190444946289, "vf_loss": 26792796.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9995609521865845, "var_IS": 5.9997841162839904e-05, "model": {}, "grad_gnorm": [79.99999237060547]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 355.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 177500, "num_env_steps_trained": 177500, "num_agent_steps_sampled": 177500, "num_agent_steps_trained": 177500, "num_training_step_calls_since_last_synch_worker_weights": 109, "last_target_update_ts": 177500, "num_weight_broadcasts": 3521, "num_target_updates": 3521, "num_samples_added_to_queue": 177500, "learner_queue": {"size_count": 355, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.503, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 854.716, "learner_dequeue_time_ms": 14222.43}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -776261.2903225806, "episode_len_mean": 1904.6989247311828, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4168660764829388, "mean_inference_ms": 1.111997532732063, "mean_action_processing_ms": 0.1605461561922732, "mean_env_wait_ms": 0.05992747735673743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005324937963998446, "StateBufferConnector_ms": 0.006758782171433972, "ViewRequirementAgentConnector_ms": 0.12701275528118175}}, "episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -776261.2903225806, "episode_len_mean": 1904.6989247311828, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4168660764829388, "mean_inference_ms": 1.111997532732063, "mean_action_processing_ms": 0.1605461561922732, "mean_env_wait_ms": 0.05992747735673743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005324937963998446, "StateBufferConnector_ms": 0.006758782171433972, "ViewRequirementAgentConnector_ms": 0.12701275528118175}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177500, "num_agent_steps_trained": 177500, "num_env_steps_sampled": 177500, "num_env_steps_trained": 177500, "num_env_steps_sampled_this_iter": 5850, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 584.9660537868758, "num_env_steps_trained_throughput_per_sec": 599.9651833711547, "timesteps_total": 177500, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 177500, "timers": {"training_iteration_time_ms": 0.182, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 177500, "num_env_steps_trained": 177500, "num_agent_steps_sampled": 177500, "num_agent_steps_trained": 177500, "num_training_step_calls_since_last_synch_worker_weights": 109, "last_target_update_ts": 177500, "num_weight_broadcasts": 3521, "num_target_updates": 3521, "num_samples_added_to_queue": 177500}, "done": false, "episodes_total": 93, "training_iteration": 33, "trial_id": "304dd_00000", "date": "2023-12-11_01-52-58", "timestamp": 1702288378, "time_this_iter_s": 10.129464387893677, "time_total_s": 333.9486916065216, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 333.9486916065216, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 33.346666666666664, "ram_util_percent": 87.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 35408956.0, "policy_loss": 9650.9140625, "entropy": 1.061041235923767, "var_gnorm": 36.30958557128906, "vf_loss": 70798608.0, "vf_explained_var": -1.1920928955078125e-06, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.000037431716919, "var_IS": 1.091856393031776e-05, "model": {}, "grad_gnorm": [90.04972076416016]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 366.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 183350, "num_env_steps_trained": 183000, "num_agent_steps_sampled": 183350, "num_agent_steps_trained": 183000, "num_training_step_calls_since_last_synch_worker_weights": 10, "last_target_update_ts": 183350, "num_weight_broadcasts": 3637, "num_target_updates": 3637, "num_samples_added_to_queue": 183000, "learner_queue": {"size_count": 366, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.706, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 855.036, "learner_dequeue_time_ms": 14222.43}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -784916.5368421052, "episode_len_mean": 1928.8631578947368, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41666466739954877, "mean_inference_ms": 1.1115224968859085, "mean_action_processing_ms": 0.1604063203841687, "mean_env_wait_ms": 0.059888080393881035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005212834006861637, "StateBufferConnector_ms": 0.006616492020456414, "ViewRequirementAgentConnector_ms": 0.12819516031365646}}, "episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -784916.5368421052, "episode_len_mean": 1928.8631578947368, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41666466739954877, "mean_inference_ms": 1.1115224968859085, "mean_action_processing_ms": 0.1604063203841687, "mean_env_wait_ms": 0.059888080393881035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005212834006861637, "StateBufferConnector_ms": 0.006616492020456414, "ViewRequirementAgentConnector_ms": 0.12819516031365646}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 183350, "num_agent_steps_trained": 183000, "num_env_steps_sampled": 183350, "num_env_steps_trained": 183000, "num_env_steps_sampled_this_iter": 5850, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 584.9838074159525, "num_env_steps_trained_throughput_per_sec": 549.9847762030322, "timesteps_total": 183350, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 183350, "timers": {"training_iteration_time_ms": 0.246, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.1}, "counters": {"num_env_steps_sampled": 183350, "num_env_steps_trained": 183000, "num_agent_steps_sampled": 183350, "num_agent_steps_trained": 183000, "num_training_step_calls_since_last_synch_worker_weights": 10, "last_target_update_ts": 183350, "num_weight_broadcasts": 3637, "num_target_updates": 3637, "num_samples_added_to_queue": 183000}, "done": false, "episodes_total": 95, "training_iteration": 34, "trial_id": "304dd_00000", "date": "2023-12-11_01-53-08", "timestamp": 1702288388, "time_this_iter_s": 10.154216766357422, "time_total_s": 344.102908372879, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 344.102908372879, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 33.56428571428571, "ram_util_percent": 87.41428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 18592462.0, "policy_loss": 7397.9453125, "entropy": 0.9546717405319214, "var_gnorm": 36.562896728515625, "vf_loss": 37170128.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0002158880233765, "var_IS": 4.025665839435533e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 378.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 189150, "num_env_steps_trained": 189000, "num_agent_steps_sampled": 189150, "num_agent_steps_trained": 189000, "num_training_step_calls_since_last_synch_worker_weights": 262, "last_target_update_ts": 189150, "num_weight_broadcasts": 3752, "num_target_updates": 3752, "num_samples_added_to_queue": 189000, "learner_queue": {"size_count": 378, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.792, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 858.948, "learner_dequeue_time_ms": 14168.82}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -792116.6082474227, "episode_len_mean": 1946.3298969072166, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41645477941902553, "mean_inference_ms": 1.1110205496352454, "mean_action_processing_ms": 0.16026037970620835, "mean_env_wait_ms": 0.05984730995221186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00613571442279619, "StateBufferConnector_ms": 0.006480069504570715, "ViewRequirementAgentConnector_ms": 0.127310359600893}}, "episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -792116.6082474227, "episode_len_mean": 1946.3298969072166, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41645477941902553, "mean_inference_ms": 1.1110205496352454, "mean_action_processing_ms": 0.16026037970620835, "mean_env_wait_ms": 0.05984730995221186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00613571442279619, "StateBufferConnector_ms": 0.006480069504570715, "ViewRequirementAgentConnector_ms": 0.127310359600893}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 189150, "num_agent_steps_trained": 189000, "num_env_steps_sampled": 189150, "num_env_steps_trained": 189000, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 579.9547712312532, "num_env_steps_trained_throughput_per_sec": 599.9532116185378, "timesteps_total": 189150, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 189150, "timers": {"training_iteration_time_ms": 0.18, "sample_time_ms": 0.019, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 189150, "num_env_steps_trained": 189000, "num_agent_steps_sampled": 189150, "num_agent_steps_trained": 189000, "num_training_step_calls_since_last_synch_worker_weights": 262, "last_target_update_ts": 189150, "num_weight_broadcasts": 3752, "num_target_updates": 3752, "num_samples_added_to_queue": 189000}, "done": false, "episodes_total": 97, "training_iteration": 35, "trial_id": "304dd_00000", "date": "2023-12-11_01-53-18", "timestamp": 1702288398, "time_this_iter_s": 10.110448122024536, "time_total_s": 354.21335649490356, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 354.21335649490356, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 34.364285714285714, "ram_util_percent": 87.50714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 16019868.0, "policy_loss": 6851.3544921875, "entropy": 0.941251277923584, "var_gnorm": 36.64847183227539, "vf_loss": 32026034.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0017900466918945, "var_IS": 0.0004166903963778168, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 389.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 194850, "num_env_steps_trained": 194500, "num_agent_steps_sampled": 194850, "num_agent_steps_trained": 194500, "num_training_step_calls_since_last_synch_worker_weights": 69, "last_target_update_ts": 194850, "num_weight_broadcasts": 3865, "num_target_updates": 3865, "num_samples_added_to_queue": 194500, "learner_queue": {"size_count": 389, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.46, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 880.345, "learner_dequeue_time_ms": 14194.499}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -787178.87, "episode_len_mean": 1940.6, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4161423536271213, "mean_inference_ms": 1.110259596006048, "mean_action_processing_ms": 0.1600448564559957, "mean_env_wait_ms": 0.05978371271105279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007948875427246094, "StateBufferConnector_ms": 0.006800174713134766, "ViewRequirementAgentConnector_ms": 0.12494921684265137}}, "episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -787178.87, "episode_len_mean": 1940.6, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149168.0, -2393079.0, -1192129.0, -1158589.0, -809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0], "episode_lengths": [379, 6735, 3467, 3386, 2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4161423536271213, "mean_inference_ms": 1.110259596006048, "mean_action_processing_ms": 0.1600448564559957, "mean_env_wait_ms": 0.05978371271105279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007948875427246094, "StateBufferConnector_ms": 0.006800174713134766, "ViewRequirementAgentConnector_ms": 0.12494921684265137}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 194850, "num_agent_steps_trained": 194500, "num_env_steps_sampled": 194850, "num_env_steps_trained": 194500, "num_env_steps_sampled_this_iter": 5700, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 569.9961540958498, "num_env_steps_trained_throughput_per_sec": 549.996289039855, "timesteps_total": 194850, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 194850, "timers": {"training_iteration_time_ms": 0.269, "sample_time_ms": 0.034, "synch_weights_time_ms": 0.097}, "counters": {"num_env_steps_sampled": 194850, "num_env_steps_trained": 194500, "num_agent_steps_sampled": 194850, "num_agent_steps_trained": 194500, "num_training_step_calls_since_last_synch_worker_weights": 69, "last_target_update_ts": 194850, "num_weight_broadcasts": 3865, "num_target_updates": 3865, "num_samples_added_to_queue": 194500}, "done": false, "episodes_total": 100, "training_iteration": 36, "trial_id": "304dd_00000", "date": "2023-12-11_01-53-28", "timestamp": 1702288408, "time_this_iter_s": 10.142370462417603, "time_total_s": 364.35572695732117, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 364.35572695732117, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 32.68571428571429, "ram_util_percent": 87.32857142857141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 20089058.0, "policy_loss": 7832.40869140625, "entropy": 0.8950158953666687, "var_gnorm": 36.78814697265625, "vf_loss": 40162452.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0004966259002686, "var_IS": 0.00029312752303667367, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 401.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 200650, "num_env_steps_trained": 200500, "num_agent_steps_sampled": 200650, "num_agent_steps_trained": 200500, "num_training_step_calls_since_last_synch_worker_weights": 199, "last_target_update_ts": 200650, "num_weight_broadcasts": 3980, "num_target_updates": 3980, "num_samples_added_to_queue": 200500, "learner_queue": {"size_count": 401, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.812, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 864.106, "learner_dequeue_time_ms": 14182.8}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -762512.02, "episode_len_mean": 1850.35, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0], "episode_lengths": [2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4141295749648981, "mean_inference_ms": 1.106807959518929, "mean_action_processing_ms": 0.15895895222276007, "mean_env_wait_ms": 0.059359788952753505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007948875427246094, "StateBufferConnector_ms": 0.007116556167602539, "ViewRequirementAgentConnector_ms": 0.12136149406433105}}, "episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -762512.02, "episode_len_mean": 1850.35, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-809440.0, -1423929.0, -1313968.0, -809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0], "episode_lengths": [2039, 2780, 2455, 2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4141295749648981, "mean_inference_ms": 1.106807959518929, "mean_action_processing_ms": 0.15895895222276007, "mean_env_wait_ms": 0.059359788952753505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007948875427246094, "StateBufferConnector_ms": 0.007116556167602539, "ViewRequirementAgentConnector_ms": 0.12136149406433105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200650, "num_agent_steps_trained": 200500, "num_env_steps_sampled": 200650, "num_env_steps_trained": 200500, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 579.9870155380347, "num_env_steps_trained_throughput_per_sec": 599.9865677979669, "timesteps_total": 200650, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 200650, "timers": {"training_iteration_time_ms": 0.101, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 200650, "num_env_steps_trained": 200500, "num_agent_steps_sampled": 200650, "num_agent_steps_trained": 200500, "num_training_step_calls_since_last_synch_worker_weights": 199, "last_target_update_ts": 200650, "num_weight_broadcasts": 3980, "num_target_updates": 3980, "num_samples_added_to_queue": 200500}, "done": false, "episodes_total": 104, "training_iteration": 37, "trial_id": "304dd_00000", "date": "2023-12-11_01-53-39", "timestamp": 1702288419, "time_this_iter_s": 10.126795530319214, "time_total_s": 374.4825224876404, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 374.4825224876404, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 34.19285714285714, "ram_util_percent": 87.25714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 27194890.0, "policy_loss": 9258.41796875, "entropy": 0.8343638777732849, "var_gnorm": 36.85974884033203, "vf_loss": 54371264.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9997714757919312, "var_IS": 3.812308204942383e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 412.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 206500, "num_env_steps_trained": 206000, "num_agent_steps_sampled": 206500, "num_agent_steps_trained": 206000, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 206500, "num_weight_broadcasts": 4096, "num_target_updates": 4096, "num_samples_added_to_queue": 206500, "learner_queue": {"size_count": 413, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.02, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 856.001, "learner_dequeue_time_ms": 14182.8}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -751864.1, "episode_len_mean": 1842.51, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0], "episode_lengths": [2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4136782812092761, "mean_inference_ms": 1.105637173315589, "mean_action_processing_ms": 0.1586089310464177, "mean_env_wait_ms": 0.05927399511946672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007948875427246094, "StateBufferConnector_ms": 0.0074863433837890625, "ViewRequirementAgentConnector_ms": 0.12431621551513672}}, "episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -751864.1, "episode_len_mean": 1842.51, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-809484.0, -623340.0, -216799.0, -20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0], "episode_lengths": [2384, 1908, 682, 42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4136782812092761, "mean_inference_ms": 1.105637173315589, "mean_action_processing_ms": 0.1586089310464177, "mean_env_wait_ms": 0.05927399511946672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007948875427246094, "StateBufferConnector_ms": 0.0074863433837890625, "ViewRequirementAgentConnector_ms": 0.12431621551513672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 1, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206500, "num_agent_steps_trained": 206000, "num_env_steps_sampled": 206500, "num_env_steps_trained": 206000, "num_env_steps_sampled_this_iter": 5850, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 584.4538386296013, "num_env_steps_trained_throughput_per_sec": 549.4865149509072, "timesteps_total": 206500, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 206500, "timers": {"training_iteration_time_ms": 1.7, "sample_time_ms": 0.2, "synch_weights_time_ms": 1.182}, "counters": {"num_env_steps_sampled": 206500, "num_env_steps_trained": 206000, "num_agent_steps_sampled": 206500, "num_agent_steps_trained": 206000, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 206500, "num_weight_broadcasts": 4096, "num_target_updates": 4096, "num_samples_added_to_queue": 206500}, "done": false, "episodes_total": 107, "training_iteration": 38, "trial_id": "304dd_00000", "date": "2023-12-11_01-53-49", "timestamp": 1702288429, "time_this_iter_s": 10.088261842727661, "time_total_s": 384.57078433036804, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 384.57078433036804, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 32.60666666666667, "ram_util_percent": 86.44666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 49872780.0, "policy_loss": 11442.6708984375, "entropy": 0.9230903387069702, "var_gnorm": 36.89729309082031, "vf_loss": 99722672.0, "vf_explained_var": -2.384185791015625e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0000120401382446, "var_IS": 4.879680659541918e-07, "model": {}, "grad_gnorm": [89.57620239257812]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 424.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 212300, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212300, "num_agent_steps_trained": 212000, "num_training_step_calls_since_last_synch_worker_weights": 269, "last_target_update_ts": 212300, "num_weight_broadcasts": 4212, "num_target_updates": 4212, "num_samples_added_to_queue": 212000, "learner_queue": {"size_count": 424, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.267, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 853.078, "learner_dequeue_time_ms": 14165.48}}, "sampler_results": {"episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -757449.44, "episode_len_mean": 1846.85, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0], "episode_lengths": [42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41337429098763395, "mean_inference_ms": 1.1046459041471914, "mean_action_processing_ms": 0.15834272321411383, "mean_env_wait_ms": 0.05921118449157758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007948875427246094, "StateBufferConnector_ms": 0.006485462188720703, "ViewRequirementAgentConnector_ms": 0.12210679054260254}}, "episode_reward_max": -20206.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -757449.44, "episode_len_mean": 1846.85, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-20206.0, -45282.0, -164936.0, -108612.0, -1811735.0, -131964.0, -1364767.0, -230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0], "episode_lengths": [42, 100, 254, 193, 3562, 267, 3981, 679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41337429098763395, "mean_inference_ms": 1.1046459041471914, "mean_action_processing_ms": 0.15834272321411383, "mean_env_wait_ms": 0.05921118449157758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007948875427246094, "StateBufferConnector_ms": 0.006485462188720703, "ViewRequirementAgentConnector_ms": 0.12210679054260254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212300, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212300, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 579.9834065416372, "num_env_steps_trained_throughput_per_sec": 599.9828343534177, "timesteps_total": 212300, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 212300, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.2, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 212300, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212300, "num_agent_steps_trained": 212000, "num_training_step_calls_since_last_synch_worker_weights": 269, "last_target_update_ts": 212300, "num_weight_broadcasts": 4212, "num_target_updates": 4212, "num_samples_added_to_queue": 212000}, "done": false, "episodes_total": 110, "training_iteration": 39, "trial_id": "304dd_00000", "date": "2023-12-11_01-53-59", "timestamp": 1702288439, "time_this_iter_s": 10.114473104476929, "time_total_s": 394.68525743484497, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 394.68525743484497, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 32.42857142857143, "ram_util_percent": 86.42142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 36940912.0, "policy_loss": 9762.8623046875, "entropy": 0.9639871716499329, "var_gnorm": 36.9700813293457, "vf_loss": 73862296.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0000569820404053, "var_IS": 8.432170579908416e-05, "model": {}, "grad_gnorm": [80.6760025024414]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 436.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 218100, "num_env_steps_trained": 218000, "num_agent_steps_sampled": 218100, "num_agent_steps_trained": 218000, "num_training_step_calls_since_last_synch_worker_weights": 136, "last_target_update_ts": 218100, "num_weight_broadcasts": 4327, "num_target_updates": 4327, "num_samples_added_to_queue": 218000, "learner_queue": {"size_count": 436, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.22, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 860.365, "learner_dequeue_time_ms": 14147.185}}, "sampler_results": {"episode_reward_max": -27519.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -744774.78, "episode_len_mean": 1823.16, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0], "episode_lengths": [679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41279768495332303, "mean_inference_ms": 1.1023203229992653, "mean_action_processing_ms": 0.1577931036225245, "mean_env_wait_ms": 0.0591146921939718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007948875427246094, "StateBufferConnector_ms": 0.006485462188720703, "ViewRequirementAgentConnector_ms": 0.12409472465515137}}, "episode_reward_max": -27519.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -744774.78, "episode_len_mean": 1823.16, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-230416.0, -600396.0, -928011.0, -302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0], "episode_lengths": [679, 1628, 2084, 737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41279768495332303, "mean_inference_ms": 1.1023203229992653, "mean_action_processing_ms": 0.1577931036225245, "mean_env_wait_ms": 0.0591146921939718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007948875427246094, "StateBufferConnector_ms": 0.006485462188720703, "ViewRequirementAgentConnector_ms": 0.12409472465515137}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 218100, "num_agent_steps_trained": 218000, "num_env_steps_sampled": 218100, "num_env_steps_trained": 218000, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 579.9713077434643, "num_env_steps_trained_throughput_per_sec": 599.9703183553079, "timesteps_total": 218100, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 218100, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.2, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 218100, "num_env_steps_trained": 218000, "num_agent_steps_sampled": 218100, "num_agent_steps_trained": 218000, "num_training_step_calls_since_last_synch_worker_weights": 136, "last_target_update_ts": 218100, "num_weight_broadcasts": 4327, "num_target_updates": 4327, "num_samples_added_to_queue": 218000}, "done": false, "episodes_total": 117, "training_iteration": 40, "trial_id": "304dd_00000", "date": "2023-12-11_01-54-09", "timestamp": 1702288449, "time_this_iter_s": 10.131796836853027, "time_total_s": 404.817054271698, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 404.817054271698, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 34.06428571428572, "ram_util_percent": 86.37857142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 32940646.0, "policy_loss": 8786.693359375, "entropy": 0.9786890745162964, "var_gnorm": 37.026676177978516, "vf_loss": 65863720.0, "vf_explained_var": 5.960464477539063e-08, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.999957263469696, "var_IS": 3.695082705235109e-05, "model": {}, "grad_gnorm": [80.81661987304688]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 447.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 223900, "num_env_steps_trained": 223500, "num_agent_steps_sampled": 223900, "num_agent_steps_trained": 223500, "num_training_step_calls_since_last_synch_worker_weights": 1, "last_target_update_ts": 223900, "num_weight_broadcasts": 4442, "num_target_updates": 4442, "num_samples_added_to_queue": 223500, "learner_queue": {"size_count": 447, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.058, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 861.953, "learner_dequeue_time_ms": 14147.185}}, "sampler_results": {"episode_reward_max": -27519.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -750048.67, "episode_len_mean": 1841.38, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0], "episode_lengths": [737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41266343488341733, "mean_inference_ms": 1.1014184802853684, "mean_action_processing_ms": 0.15754125591165669, "mean_env_wait_ms": 0.059098533484629436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010947942733764648, "StateBufferConnector_ms": 0.005678415298461914, "ViewRequirementAgentConnector_ms": 0.12586379051208496}}, "episode_reward_max": -27519.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -750048.67, "episode_len_mean": 1841.38, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-302365.0, -1984260.0, -434744.0, -1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0], "episode_lengths": [737, 5372, 1228, 3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41266343488341733, "mean_inference_ms": 1.1014184802853684, "mean_action_processing_ms": 0.15754125591165669, "mean_env_wait_ms": 0.059098533484629436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010947942733764648, "StateBufferConnector_ms": 0.005678415298461914, "ViewRequirementAgentConnector_ms": 0.12586379051208496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223900, "num_agent_steps_trained": 223500, "num_env_steps_sampled": 223900, "num_env_steps_trained": 223500, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 579.9840564342244, "num_env_steps_trained_throughput_per_sec": 549.9848811014197, "timesteps_total": 223900, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 223900, "timers": {"training_iteration_time_ms": 1.398, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.8}, "counters": {"num_env_steps_sampled": 223900, "num_env_steps_trained": 223500, "num_agent_steps_sampled": 223900, "num_agent_steps_trained": 223500, "num_training_step_calls_since_last_synch_worker_weights": 1, "last_target_update_ts": 223900, "num_weight_broadcasts": 4442, "num_target_updates": 4442, "num_samples_added_to_queue": 223500}, "done": false, "episodes_total": 120, "training_iteration": 41, "trial_id": "304dd_00000", "date": "2023-12-11_01-54-19", "timestamp": 1702288459, "time_this_iter_s": 10.145632266998291, "time_total_s": 414.9626865386963, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 414.9626865386963, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 31.478571428571424, "ram_util_percent": 86.34285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 58123408.0, "policy_loss": 11941.7236328125, "entropy": 0.935518205165863, "var_gnorm": 37.095054626464844, "vf_loss": 116222936.0, "vf_explained_var": -3.5762786865234375e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.999435544013977, "var_IS": 0.00010019122419180349, "model": {}, "grad_gnorm": [89.71968078613281]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 459.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 229600, "num_env_steps_trained": 229500, "num_agent_steps_sampled": 229600, "num_agent_steps_trained": 229500, "num_training_step_calls_since_last_synch_worker_weights": 293, "last_target_update_ts": 229600, "num_weight_broadcasts": 4555, "num_target_updates": 4555, "num_samples_added_to_queue": 229500, "learner_queue": {"size_count": 459, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.948, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 878.688, "learner_dequeue_time_ms": 14177.359}}, "sampler_results": {"episode_reward_max": -25401.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -740662.8, "episode_len_mean": 1812.16, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0], "episode_lengths": [3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4125007270227183, "mean_inference_ms": 1.100453567944146, "mean_action_processing_ms": 0.15726724923396626, "mean_env_wait_ms": 0.05907625881651437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010523319244384766, "StateBufferConnector_ms": 0.005678415298461914, "ViewRequirementAgentConnector_ms": 0.12611055374145508}}, "episode_reward_max": -25401.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -740662.8, "episode_len_mean": 1812.16, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1035458.0, -976292.0, -110708.0, -646199.0, -737421.0, -97631.0, -66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0], "episode_lengths": [3048, 2220, 289, 1646, 2306, 263, 223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4125007270227183, "mean_inference_ms": 1.100453567944146, "mean_action_processing_ms": 0.15726724923396626, "mean_env_wait_ms": 0.05907625881651437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010523319244384766, "StateBufferConnector_ms": 0.005678415298461914, "ViewRequirementAgentConnector_ms": 0.12611055374145508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229600, "num_agent_steps_trained": 229500, "num_env_steps_sampled": 229600, "num_env_steps_trained": 229500, "num_env_steps_sampled_this_iter": 5700, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 569.9701310551629, "num_env_steps_trained_throughput_per_sec": 599.9685590054347, "timesteps_total": 229600, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 229600, "timers": {"training_iteration_time_ms": 0.189, "sample_time_ms": 0.142, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 229600, "num_env_steps_trained": 229500, "num_agent_steps_sampled": 229600, "num_agent_steps_trained": 229500, "num_training_step_calls_since_last_synch_worker_weights": 293, "last_target_update_ts": 229600, "num_weight_broadcasts": 4555, "num_target_updates": 4555, "num_samples_added_to_queue": 229500}, "done": false, "episodes_total": 123, "training_iteration": 42, "trial_id": "304dd_00000", "date": "2023-12-11_01-54-30", "timestamp": 1702288470, "time_this_iter_s": 10.108640909194946, "time_total_s": 425.07132744789124, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 425.07132744789124, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 34.65714285714286, "ram_util_percent": 86.32142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 27355532.0, "policy_loss": 8088.7939453125, "entropy": 0.8974695801734924, "var_gnorm": 37.23811721801758, "vf_loss": 54694888.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9991326928138733, "var_IS": 0.00016268578474409878, "model": {}, "grad_gnorm": [80.56421661376953]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 470.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 235450, "num_env_steps_trained": 235000, "num_agent_steps_sampled": 235450, "num_agent_steps_trained": 235000, "num_training_step_calls_since_last_synch_worker_weights": 55, "last_target_update_ts": 235450, "num_weight_broadcasts": 4671, "num_target_updates": 4671, "num_samples_added_to_queue": 235000, "learner_queue": {"size_count": 470, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.769, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 855.484, "learner_dequeue_time_ms": 14169.17}}, "sampler_results": {"episode_reward_max": -25401.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -739871.72, "episode_len_mean": 1792.73, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0], "episode_lengths": [223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4122209268428593, "mean_inference_ms": 1.0989490642069102, "mean_action_processing_ms": 0.15677638750507827, "mean_env_wait_ms": 0.05908059998298618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010161161422729492, "StateBufferConnector_ms": 0.005696535110473633, "ViewRequirementAgentConnector_ms": 0.12453699111938477}}, "episode_reward_max": -25401.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -739871.72, "episode_len_mean": 1792.73, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-66731.0, -221518.0, -178395.0, -525200.0, -2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0], "episode_lengths": [223, 679, 524, 1453, 6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4122209268428593, "mean_inference_ms": 1.0989490642069102, "mean_action_processing_ms": 0.15677638750507827, "mean_env_wait_ms": 0.05908059998298618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010161161422729492, "StateBufferConnector_ms": 0.005696535110473633, "ViewRequirementAgentConnector_ms": 0.12453699111938477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235450, "num_agent_steps_trained": 235000, "num_env_steps_sampled": 235450, "num_env_steps_trained": 235000, "num_env_steps_sampled_this_iter": 5850, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 584.9778243365122, "num_env_steps_trained_throughput_per_sec": 549.9791510856097, "timesteps_total": 235450, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 235450, "timers": {"training_iteration_time_ms": 0.201, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 235450, "num_env_steps_trained": 235000, "num_agent_steps_sampled": 235450, "num_agent_steps_trained": 235000, "num_training_step_calls_since_last_synch_worker_weights": 55, "last_target_update_ts": 235450, "num_weight_broadcasts": 4671, "num_target_updates": 4671, "num_samples_added_to_queue": 235000}, "done": false, "episodes_total": 129, "training_iteration": 43, "trial_id": "304dd_00000", "date": "2023-12-11_01-54-40", "timestamp": 1702288480, "time_this_iter_s": 10.146035432815552, "time_total_s": 435.2173628807068, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 435.2173628807068, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 33.919999999999995, "ram_util_percent": 86.3133333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 17312814.0, "policy_loss": 7189.1474609375, "entropy": 0.9007188081741333, "var_gnorm": 37.33744430541992, "vf_loss": 34611248.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9996816515922546, "var_IS": 1.8911712686531246e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 481.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 240750, "num_env_steps_trained": 240500, "num_agent_steps_sampled": 240750, "num_agent_steps_trained": 240500, "num_training_step_calls_since_last_synch_worker_weights": 131, "last_target_update_ts": 240750, "num_weight_broadcasts": 4776, "num_target_updates": 4776, "num_samples_added_to_queue": 240500, "learner_queue": {"size_count": 481, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.691, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 940.104, "learner_dequeue_time_ms": 14195.123}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -746520.72, "episode_len_mean": 1801.14, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0], "episode_lengths": [6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4121047352183501, "mean_inference_ms": 1.0981116930842871, "mean_action_processing_ms": 0.15649113077741958, "mean_env_wait_ms": 0.05909361480825176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010442972183227539, "StateBufferConnector_ms": 0.005696535110473633, "ViewRequirementAgentConnector_ms": 0.12659478187561035}}, "episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -746520.72, "episode_len_mean": 1801.14, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2957230.0, -368123.0, -1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0], "episode_lengths": [6201, 998, 4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4121047352183501, "mean_inference_ms": 1.0981116930842871, "mean_action_processing_ms": 0.15649113077741958, "mean_env_wait_ms": 0.05909361480825176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010442972183227539, "StateBufferConnector_ms": 0.005696535110473633, "ViewRequirementAgentConnector_ms": 0.12659478187561035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240750, "num_agent_steps_trained": 240500, "num_env_steps_sampled": 240750, "num_env_steps_trained": 240500, "num_env_steps_sampled_this_iter": 5300, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 529.9760302417429, "num_env_steps_trained_throughput_per_sec": 549.9751257225633, "timesteps_total": 240750, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 240750, "timers": {"training_iteration_time_ms": 0.1, "sample_time_ms": 0.092, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 240750, "num_env_steps_trained": 240500, "num_agent_steps_sampled": 240750, "num_agent_steps_trained": 240500, "num_training_step_calls_since_last_synch_worker_weights": 131, "last_target_update_ts": 240750, "num_weight_broadcasts": 4776, "num_target_updates": 4776, "num_samples_added_to_queue": 240500}, "done": false, "episodes_total": 133, "training_iteration": 44, "trial_id": "304dd_00000", "date": "2023-12-11_01-54-50", "timestamp": 1702288490, "time_this_iter_s": 10.13236689567566, "time_total_s": 445.34972977638245, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 445.34972977638245, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 37.357142857142854, "ram_util_percent": 87.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 14448116.0, "policy_loss": 6582.3271484375, "entropy": 0.8798428773880005, "var_gnorm": 37.3993034362793, "vf_loss": 28883068.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0004708766937256, "var_IS": 0.0005238610319793224, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 492.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 246300, "num_env_steps_trained": 246000, "num_agent_steps_sampled": 246300, "num_agent_steps_trained": 246000, "num_training_step_calls_since_last_synch_worker_weights": 75, "last_target_update_ts": 246300, "num_weight_broadcasts": 4886, "num_target_updates": 4886, "num_samples_added_to_queue": 246000, "learner_queue": {"size_count": 492, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.828, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 905.071, "learner_dequeue_time_ms": 14195.123}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -721028.41, "episode_len_mean": 1750.57, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0], "episode_lengths": [4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4119482083959081, "mean_inference_ms": 1.0975860850574073, "mean_action_processing_ms": 0.15630463565215938, "mean_env_wait_ms": 0.059077519154129794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010442972183227539, "StateBufferConnector_ms": 0.005696535110473633, "ViewRequirementAgentConnector_ms": 0.1270456314086914}}, "episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -721028.41, "episode_len_mean": 1750.57, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1562127.0, -1100901.0, -362549.0, -389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0], "episode_lengths": [4214, 3152, 1230, 802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4119482083959081, "mean_inference_ms": 1.0975860850574073, "mean_action_processing_ms": 0.15630463565215938, "mean_env_wait_ms": 0.059077519154129794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010442972183227539, "StateBufferConnector_ms": 0.005696535110473633, "ViewRequirementAgentConnector_ms": 0.1270456314086914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246300, "num_agent_steps_trained": 246000, "num_env_steps_sampled": 246300, "num_env_steps_trained": 246000, "num_env_steps_sampled_this_iter": 5550, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 554.9673844670602, "num_env_steps_trained_throughput_per_sec": 549.9676783006904, "timesteps_total": 246300, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 246300, "timers": {"training_iteration_time_ms": 0.203, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 246300, "num_env_steps_trained": 246000, "num_agent_steps_sampled": 246300, "num_agent_steps_trained": 246000, "num_training_step_calls_since_last_synch_worker_weights": 75, "last_target_update_ts": 246300, "num_weight_broadcasts": 4886, "num_target_updates": 4886, "num_samples_added_to_queue": 246000}, "done": false, "episodes_total": 135, "training_iteration": 45, "trial_id": "304dd_00000", "date": "2023-12-11_01-55-00", "timestamp": 1702288500, "time_this_iter_s": 10.145060300827026, "time_total_s": 455.4947900772095, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 455.4947900772095, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 34.9, "ram_util_percent": 87.55714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 16626095.0, "policy_loss": 7030.57421875, "entropy": 0.9567165374755859, "var_gnorm": 37.43087387084961, "vf_loss": 33238128.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0009175539016724, "var_IS": 0.0003606813552323729, "model": {}, "grad_gnorm": [80.00015258789062]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 503.0, "diff_num_grad_updates_vs_sampler_policy": 0.19999999999998863}}, "num_env_steps_sampled": 251800, "num_env_steps_trained": 251500, "num_agent_steps_sampled": 251800, "num_agent_steps_trained": 251500, "num_training_step_calls_since_last_synch_worker_weights": 207, "last_target_update_ts": 251800, "num_weight_broadcasts": 4995, "num_target_updates": 4995, "num_samples_added_to_queue": 251500, "learner_queue": {"size_count": 503, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.09, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 902.835, "learner_dequeue_time_ms": 14236.39}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -726596.04, "episode_len_mean": 1763.46, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0], "episode_lengths": [802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4115731577214505, "mean_inference_ms": 1.0967046992120686, "mean_action_processing_ms": 0.15597888573501037, "mean_env_wait_ms": 0.05902221815429952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010442972183227539, "StateBufferConnector_ms": 0.004651784896850586, "ViewRequirementAgentConnector_ms": 0.12251758575439453}}, "episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -726596.04, "episode_len_mean": 1763.46, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-389034.0, -354890.0, -27519.0, -141109.0, -662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0], "episode_lengths": [802, 681, 71, 342, 2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4115731577214505, "mean_inference_ms": 1.0967046992120686, "mean_action_processing_ms": 0.15597888573501037, "mean_env_wait_ms": 0.05902221815429952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010442972183227539, "StateBufferConnector_ms": 0.004651784896850586, "ViewRequirementAgentConnector_ms": 0.12251758575439453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251800, "num_agent_steps_trained": 251500, "num_env_steps_sampled": 251800, "num_env_steps_trained": 251500, "num_env_steps_sampled_this_iter": 5500, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 549.9903227601482, "num_env_steps_trained_throughput_per_sec": 549.9903227601482, "timesteps_total": 251800, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 251800, "timers": {"training_iteration_time_ms": 0.359, "sample_time_ms": 0.043, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 251800, "num_env_steps_trained": 251500, "num_agent_steps_sampled": 251800, "num_agent_steps_trained": 251500, "num_training_step_calls_since_last_synch_worker_weights": 207, "last_target_update_ts": 251800, "num_weight_broadcasts": 4995, "num_target_updates": 4995, "num_samples_added_to_queue": 251500}, "done": false, "episodes_total": 138, "training_iteration": 46, "trial_id": "304dd_00000", "date": "2023-12-11_01-55-10", "timestamp": 1702288510, "time_this_iter_s": 10.142954111099243, "time_total_s": 465.6377441883087, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 465.6377441883087, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 35.35000000000001, "ram_util_percent": 85.94285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 17910186.0, "policy_loss": 6389.59619140625, "entropy": 0.982968270778656, "var_gnorm": 37.4743537902832, "vf_loss": 35807592.0, "vf_explained_var": -2.384185791015625e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0004191398620605, "var_IS": 0.00017427488637622446, "model": {}, "grad_gnorm": [80.74858856201172]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 514.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 257450, "num_env_steps_trained": 257000, "num_agent_steps_sampled": 257450, "num_agent_steps_trained": 257000, "num_training_step_calls_since_last_synch_worker_weights": 53, "last_target_update_ts": 257450, "num_weight_broadcasts": 5107, "num_target_updates": 5107, "num_samples_added_to_queue": 257000, "learner_queue": {"size_count": 514, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.245, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 890.258, "learner_dequeue_time_ms": 14277.822}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -746611.61, "episode_len_mean": 1807.24, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0], "episode_lengths": [2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41096128621636197, "mean_inference_ms": 1.0953336835865015, "mean_action_processing_ms": 0.15548021021076658, "mean_env_wait_ms": 0.05892182550174478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01145029067993164, "StateBufferConnector_ms": 0.0036492347717285156, "ViewRequirementAgentConnector_ms": 0.12026619911193848}}, "episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -746611.61, "episode_len_mean": 1807.24, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-662493.0, -724548.0, -472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0], "episode_lengths": [2072, 2054, 1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41096128621636197, "mean_inference_ms": 1.0953336835865015, "mean_action_processing_ms": 0.15548021021076658, "mean_env_wait_ms": 0.05892182550174478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01145029067993164, "StateBufferConnector_ms": 0.0036492347717285156, "ViewRequirementAgentConnector_ms": 0.12026619911193848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 257450, "num_agent_steps_trained": 257000, "num_env_steps_sampled": 257450, "num_env_steps_trained": 257000, "num_env_steps_sampled_this_iter": 5650, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 564.9520081518878, "num_env_steps_trained_throughput_per_sec": 549.9532822717491, "timesteps_total": 257450, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 257450, "timers": {"training_iteration_time_ms": 0.205, "sample_time_ms": 0.2, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 257450, "num_env_steps_trained": 257000, "num_agent_steps_sampled": 257450, "num_agent_steps_trained": 257000, "num_training_step_calls_since_last_synch_worker_weights": 53, "last_target_update_ts": 257450, "num_weight_broadcasts": 5107, "num_target_updates": 5107, "num_samples_added_to_queue": 257000}, "done": false, "episodes_total": 142, "training_iteration": 47, "trial_id": "304dd_00000", "date": "2023-12-11_01-55-21", "timestamp": 1702288521, "time_this_iter_s": 10.148687839508057, "time_total_s": 475.7864320278168, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 475.7864320278168, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 35.20666666666667, "ram_util_percent": 85.62666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 22433096.0, "policy_loss": 8231.24609375, "entropy": 1.0254578590393066, "var_gnorm": 37.54369354248047, "vf_loss": 44849728.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.000411033630371, "var_IS": 0.0001442028587916866, "model": {}, "grad_gnorm": [80.00508880615234]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 526.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 263200, "num_env_steps_trained": 263000, "num_agent_steps_sampled": 263200, "num_agent_steps_trained": 263000, "num_training_step_calls_since_last_synch_worker_weights": 71, "last_target_update_ts": 263200, "num_weight_broadcasts": 5221, "num_target_updates": 5221, "num_samples_added_to_queue": 263000, "learner_queue": {"size_count": 526, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.235, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 873.719, "learner_dequeue_time_ms": 14277.822}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -745711.36, "episode_len_mean": 1801.83, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0], "episode_lengths": [1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4105752674953434, "mean_inference_ms": 1.0944905115001773, "mean_action_processing_ms": 0.15519846875894902, "mean_env_wait_ms": 0.058854001022013366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01145029067993164, "StateBufferConnector_ms": 0.0036492347717285156, "ViewRequirementAgentConnector_ms": 0.1213078498840332}}, "episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -745711.36, "episode_len_mean": 1801.83, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-472488.0, -203158.0, -42745.0, -2666776.0, -314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0], "episode_lengths": [1290, 622, 113, 4587, 659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4105752674953434, "mean_inference_ms": 1.0944905115001773, "mean_action_processing_ms": 0.15519846875894902, "mean_env_wait_ms": 0.058854001022013366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01145029067993164, "StateBufferConnector_ms": 0.0036492347717285156, "ViewRequirementAgentConnector_ms": 0.1213078498840332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263200, "num_agent_steps_trained": 263000, "num_env_steps_sampled": 263200, "num_env_steps_trained": 263000, "num_env_steps_sampled_this_iter": 5750, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 574.9915416292862, "num_env_steps_trained_throughput_per_sec": 599.9911738740377, "timesteps_total": 263200, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 263200, "timers": {"training_iteration_time_ms": 0.179, "sample_time_ms": 0.073, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 263200, "num_env_steps_trained": 263000, "num_agent_steps_sampled": 263200, "num_agent_steps_trained": 263000, "num_training_step_calls_since_last_synch_worker_weights": 71, "last_target_update_ts": 263200, "num_weight_broadcasts": 5221, "num_target_updates": 5221, "num_samples_added_to_queue": 263000}, "done": false, "episodes_total": 144, "training_iteration": 48, "trial_id": "304dd_00000", "date": "2023-12-11_01-55-31", "timestamp": 1702288531, "time_this_iter_s": 10.136742353439331, "time_total_s": 485.9231743812561, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 485.9231743812561, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 34.042857142857144, "ram_util_percent": 85.74285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 32470540.0, "policy_loss": 8730.40234375, "entropy": 1.0397288799285889, "var_gnorm": 37.58036804199219, "vf_loss": 64923620.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9998319745063782, "var_IS": 5.267978485790081e-05, "model": {}, "grad_gnorm": [80.15034484863281]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 538.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 269000, "num_env_steps_trained": 269000, "num_agent_steps_sampled": 269000, "num_agent_steps_trained": 269000, "num_training_step_calls_since_last_synch_worker_weights": 108, "last_target_update_ts": 269000, "num_weight_broadcasts": 5336, "num_target_updates": 5336, "num_samples_added_to_queue": 269000, "learner_queue": {"size_count": 538, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.309, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 860.595, "learner_dequeue_time_ms": 14296.338}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -732104.65, "episode_len_mean": 1793.57, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0], "episode_lengths": [659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40956705549955336, "mean_inference_ms": 1.092322477862133, "mean_action_processing_ms": 0.15453306899502842, "mean_env_wait_ms": 0.05867213552020574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01145029067993164, "StateBufferConnector_ms": 0.002649545669555664, "ViewRequirementAgentConnector_ms": 0.12299871444702148}}, "episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -732104.65, "episode_len_mean": 1793.57, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-314297.0, -645574.0, -278985.0, -1729077.0, -2070691.0, -1858592.0, -737459.0, -141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0], "episode_lengths": [659, 1509, 800, 4652, 5934, 4270, 1584, 491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40956705549955336, "mean_inference_ms": 1.092322477862133, "mean_action_processing_ms": 0.15453306899502842, "mean_env_wait_ms": 0.05867213552020574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01145029067993164, "StateBufferConnector_ms": 0.002649545669555664, "ViewRequirementAgentConnector_ms": 0.12299871444702148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 269000, "num_agent_steps_trained": 269000, "num_env_steps_sampled": 269000, "num_env_steps_trained": 269000, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 579.9801156185565, "num_env_steps_trained_throughput_per_sec": 599.9794299502308, "timesteps_total": 269000, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 269000, "timers": {"training_iteration_time_ms": 0.121, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 269000, "num_env_steps_trained": 269000, "num_agent_steps_sampled": 269000, "num_agent_steps_trained": 269000, "num_training_step_calls_since_last_synch_worker_weights": 108, "last_target_update_ts": 269000, "num_weight_broadcasts": 5336, "num_target_updates": 5336, "num_samples_added_to_queue": 269000}, "done": false, "episodes_total": 148, "training_iteration": 49, "trial_id": "304dd_00000", "date": "2023-12-11_01-55-41", "timestamp": 1702288541, "time_this_iter_s": 10.133906602859497, "time_total_s": 496.0570809841156, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 496.0570809841156, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 33.04285714285715, "ram_util_percent": 85.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 12220130.0, "policy_loss": 6119.0458984375, "entropy": 1.0007628202438354, "var_gnorm": 37.616573333740234, "vf_loss": 24428022.0, "vf_explained_var": 1.7881393432617188e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0008349418640137, "var_IS": 0.00023862945090513676, "model": {}, "grad_gnorm": [79.99999237060547]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 549.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 274700, "num_env_steps_trained": 274500, "num_agent_steps_sampled": 274700, "num_agent_steps_trained": 274500, "num_training_step_calls_since_last_synch_worker_weights": 15, "last_target_update_ts": 274700, "num_weight_broadcasts": 5449, "num_target_updates": 5449, "num_samples_added_to_queue": 274500, "learner_queue": {"size_count": 549, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.025, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 882.295, "learner_dequeue_time_ms": 14297.509}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -684874.6, "episode_len_mean": 1676.86, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0], "episode_lengths": [491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40745788682577055, "mean_inference_ms": 1.0880270592594703, "mean_action_processing_ms": 0.15327046339205538, "mean_env_wait_ms": 0.058289118654919994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01145029067993164, "StateBufferConnector_ms": 0.002649545669555664, "ViewRequirementAgentConnector_ms": 0.12030291557312012}}, "episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -684874.6, "episode_len_mean": 1676.86, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-141368.0, -328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0], "episode_lengths": [491, 923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40745788682577055, "mean_inference_ms": 1.0880270592594703, "mean_action_processing_ms": 0.15327046339205538, "mean_env_wait_ms": 0.058289118654919994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01145029067993164, "StateBufferConnector_ms": 0.002649545669555664, "ViewRequirementAgentConnector_ms": 0.12030291557312012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 274700, "num_agent_steps_trained": 274500, "num_env_steps_sampled": 274700, "num_env_steps_trained": 274500, "num_env_steps_sampled_this_iter": 5700, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 569.9977033230815, "num_env_steps_trained_throughput_per_sec": 549.9977839082364, "timesteps_total": 274700, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 274700, "timers": {"training_iteration_time_ms": 0.202, "sample_time_ms": 0.172, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 274700, "num_env_steps_trained": 274500, "num_agent_steps_sampled": 274700, "num_agent_steps_trained": 274500, "num_training_step_calls_since_last_synch_worker_weights": 15, "last_target_update_ts": 274700, "num_weight_broadcasts": 5449, "num_target_updates": 5449, "num_samples_added_to_queue": 274500}, "done": false, "episodes_total": 155, "training_iteration": 50, "trial_id": "304dd_00000", "date": "2023-12-11_01-55-51", "timestamp": 1702288551, "time_this_iter_s": 10.148043155670166, "time_total_s": 506.20512413978577, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 506.20512413978577, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 34.01428571428572, "ram_util_percent": 86.72857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 16035200.0, "policy_loss": 6842.6787109375, "entropy": 1.0715562105178833, "var_gnorm": 37.657958984375, "vf_loss": 32056714.0, "vf_explained_var": 1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0004689693450928, "var_IS": 0.0004062451480422169, "model": {}, "grad_gnorm": [80.00186920166016]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 561.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 280550, "num_env_steps_trained": 280500, "num_agent_steps_sampled": 280550, "num_agent_steps_trained": 280500, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 280550, "num_weight_broadcasts": 5565, "num_target_updates": 5565, "num_samples_added_to_queue": 280500, "learner_queue": {"size_count": 561, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.09, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 857.579, "learner_dequeue_time_ms": 14291.952}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -704228.67, "episode_len_mean": 1717.65, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0], "episode_lengths": [923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40718394910175354, "mean_inference_ms": 1.0874756017398783, "mean_action_processing_ms": 0.15310667088149826, "mean_env_wait_ms": 0.05823857692358599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01145029067993164, "StateBufferConnector_ms": 0.002649545669555664, "ViewRequirementAgentConnector_ms": 0.12049269676208496}}, "episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -704228.67, "episode_len_mean": 1717.65, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-328873.0, -63287.0, -1095977.0, -304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0], "episode_lengths": [923, 208, 2695, 891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40718394910175354, "mean_inference_ms": 1.0874756017398783, "mean_action_processing_ms": 0.15310667088149826, "mean_env_wait_ms": 0.05823857692358599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01145029067993164, "StateBufferConnector_ms": 0.002649545669555664, "ViewRequirementAgentConnector_ms": 0.12049269676208496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 1, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280550, "num_agent_steps_trained": 280500, "num_env_steps_sampled": 280550, "num_env_steps_trained": 280500, "num_env_steps_sampled_this_iter": 5850, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 584.7765490114449, "num_env_steps_trained_throughput_per_sec": 599.7708194989178, "timesteps_total": 280550, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 280550, "timers": {"training_iteration_time_ms": 1.099, "sample_time_ms": 0.108, "synch_weights_time_ms": 0.644}, "counters": {"num_env_steps_sampled": 280550, "num_env_steps_trained": 280500, "num_agent_steps_sampled": 280550, "num_agent_steps_trained": 280500, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 280550, "num_weight_broadcasts": 5565, "num_target_updates": 5565, "num_samples_added_to_queue": 280500}, "done": false, "episodes_total": 156, "training_iteration": 51, "trial_id": "304dd_00000", "date": "2023-12-11_01-56-01", "timestamp": 1702288561, "time_this_iter_s": 10.084410190582275, "time_total_s": 516.289534330368, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 516.289534330368, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 32.18571428571429, "ram_util_percent": 87.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 19963990.0, "policy_loss": 7591.87109375, "entropy": 1.0316489934921265, "var_gnorm": 37.68967056274414, "vf_loss": 39912796.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0002481937408447, "var_IS": 3.618890332290903e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 572.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 286300, "num_env_steps_trained": 286000, "num_agent_steps_sampled": 286300, "num_agent_steps_trained": 286000, "num_training_step_calls_since_last_synch_worker_weights": 136, "last_target_update_ts": 286300, "num_weight_broadcasts": 5680, "num_target_updates": 5680, "num_samples_added_to_queue": 286000, "learner_queue": {"size_count": 572, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 14.746, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 858.718, "learner_dequeue_time_ms": 14291.952}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -713963.32, "episode_len_mean": 1750.28, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0], "episode_lengths": [891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40637765076126053, "mean_inference_ms": 1.0858465358408176, "mean_action_processing_ms": 0.15262770524694363, "mean_env_wait_ms": 0.058088642462471085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01081991195678711, "StateBufferConnector_ms": 0.002649545669555664, "ViewRequirementAgentConnector_ms": 0.120635986328125}}, "episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -713963.32, "episode_len_mean": 1750.28, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-304537.0, -1519562.0, -415529.0, -5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0], "episode_lengths": [891, 4193, 1239, 8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40637765076126053, "mean_inference_ms": 1.0858465358408176, "mean_action_processing_ms": 0.15262770524694363, "mean_env_wait_ms": 0.058088642462471085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01081991195678711, "StateBufferConnector_ms": 0.002649545669555664, "ViewRequirementAgentConnector_ms": 0.120635986328125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 286300, "num_agent_steps_trained": 286000, "num_env_steps_sampled": 286300, "num_env_steps_trained": 286000, "num_env_steps_sampled_this_iter": 5750, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 574.9784090281911, "num_env_steps_trained_throughput_per_sec": 549.9793477660959, "timesteps_total": 286300, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 286300, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 286300, "num_env_steps_trained": 286000, "num_agent_steps_sampled": 286300, "num_agent_steps_trained": 286000, "num_training_step_calls_since_last_synch_worker_weights": 136, "last_target_update_ts": 286300, "num_weight_broadcasts": 5680, "num_target_updates": 5680, "num_samples_added_to_queue": 286000}, "done": false, "episodes_total": 159, "training_iteration": 52, "trial_id": "304dd_00000", "date": "2023-12-11_01-56-12", "timestamp": 1702288572, "time_this_iter_s": 10.13195538520813, "time_total_s": 526.4214897155762, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 526.4214897155762, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 33.28666666666667, "ram_util_percent": 86.78666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 14110874.0, "policy_loss": 6519.4013671875, "entropy": 1.0852735042572021, "var_gnorm": 37.71421432495117, "vf_loss": 28208710.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.000923991203308, "var_IS": 0.00016318117559421808, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 584.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 292100, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292100, "num_agent_steps_trained": 292000, "num_training_step_calls_since_last_synch_worker_weights": 183, "last_target_update_ts": 292100, "num_weight_broadcasts": 5795, "num_target_updates": 5795, "num_samples_added_to_queue": 292000, "learner_queue": {"size_count": 584, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.081, "learner_load_time_ms": 0.07, "learner_load_wait_time_ms": 863.157, "learner_dequeue_time_ms": 14300.733}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -709716.07, "episode_len_mean": 1738.6, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0], "episode_lengths": [8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40565765537237053, "mean_inference_ms": 1.0843843813557676, "mean_action_processing_ms": 0.1522092663399609, "mean_env_wait_ms": 0.05794508973928748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01081991195678711, "StateBufferConnector_ms": 0.002649545669555664, "ViewRequirementAgentConnector_ms": 0.12311553955078125}}, "episode_reward_max": -14385.0, "episode_reward_min": -5211978.0, "episode_reward_mean": -709716.07, "episode_len_mean": 1738.6, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5211978.0, -457191.0, -1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0], "episode_lengths": [8881, 1339, 2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40565765537237053, "mean_inference_ms": 1.0843843813557676, "mean_action_processing_ms": 0.1522092663399609, "mean_env_wait_ms": 0.05794508973928748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01081991195678711, "StateBufferConnector_ms": 0.002649545669555664, "ViewRequirementAgentConnector_ms": 0.12311553955078125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292100, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292100, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 579.9762716464485, "num_env_steps_trained_throughput_per_sec": 599.9754534273605, "timesteps_total": 292100, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 292100, "timers": {"training_iteration_time_ms": 0.199, "sample_time_ms": 0.032, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 292100, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292100, "num_agent_steps_trained": 292000, "num_training_step_calls_since_last_synch_worker_weights": 183, "last_target_update_ts": 292100, "num_weight_broadcasts": 5795, "num_target_updates": 5795, "num_samples_added_to_queue": 292000}, "done": false, "episodes_total": 162, "training_iteration": 53, "trial_id": "304dd_00000", "date": "2023-12-11_01-56-22", "timestamp": 1702288582, "time_this_iter_s": 10.1250319480896, "time_total_s": 536.5465216636658, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 536.5465216636658, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 32.4, "ram_util_percent": 85.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 11706270.0, "policy_loss": 5703.66357421875, "entropy": 1.0909838676452637, "var_gnorm": 37.752685546875, "vf_loss": 23401132.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0000827312469482, "var_IS": 0.0002209595259046182, "model": {}, "grad_gnorm": [79.99999237060547]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 595.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 297800, "num_env_steps_trained": 297500, "num_agent_steps_sampled": 297800, "num_agent_steps_trained": 297500, "num_training_step_calls_since_last_synch_worker_weights": 107, "last_target_update_ts": 297800, "num_weight_broadcasts": 5908, "num_target_updates": 5908, "num_samples_added_to_queue": 297500, "learner_queue": {"size_count": 595, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.569, "learner_load_time_ms": 0.07, "learner_load_wait_time_ms": 879.899, "learner_dequeue_time_ms": 14330.341}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -3478274.0, "episode_reward_mean": -672516.11, "episode_len_mean": 1678.76, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0], "episode_lengths": [2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4052632127808958, "mean_inference_ms": 1.0835732539781853, "mean_action_processing_ms": 0.15197039032109233, "mean_env_wait_ms": 0.05787014258245569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01081991195678711, "StateBufferConnector_ms": 0.002896547317504883, "ViewRequirementAgentConnector_ms": 0.12467169761657715}}, "episode_reward_max": -14385.0, "episode_reward_min": -3478274.0, "episode_reward_mean": -672516.11, "episode_len_mean": 1678.76, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1070337.0, -519690.0, -230056.0, -602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0], "episode_lengths": [2742, 936, 740, 1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4052632127808958, "mean_inference_ms": 1.0835732539781853, "mean_action_processing_ms": 0.15197039032109233, "mean_env_wait_ms": 0.05787014258245569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01081991195678711, "StateBufferConnector_ms": 0.002896547317504883, "ViewRequirementAgentConnector_ms": 0.12467169761657715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 297800, "num_agent_steps_trained": 297500, "num_env_steps_sampled": 297800, "num_env_steps_trained": 297500, "num_env_steps_sampled_this_iter": 5700, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 569.9598447956712, "num_env_steps_trained_throughput_per_sec": 549.961253750209, "timesteps_total": 297800, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 297800, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.101, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 297800, "num_env_steps_trained": 297500, "num_agent_steps_sampled": 297800, "num_agent_steps_trained": 297500, "num_training_step_calls_since_last_synch_worker_weights": 107, "last_target_update_ts": 297800, "num_weight_broadcasts": 5908, "num_target_updates": 5908, "num_samples_added_to_queue": 297500}, "done": false, "episodes_total": 164, "training_iteration": 54, "trial_id": "304dd_00000", "date": "2023-12-11_01-56-32", "timestamp": 1702288592, "time_this_iter_s": 10.13328218460083, "time_total_s": 546.6798038482666, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 546.6798038482666, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 34.47142857142857, "ram_util_percent": 85.54285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 20866508.0, "policy_loss": 7419.2607421875, "entropy": 1.0737441778182983, "var_gnorm": 37.78317642211914, "vf_loss": 41718176.0, "vf_explained_var": 5.960464477539063e-08, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9996443390846252, "var_IS": 3.059418304474093e-05, "model": {}, "grad_gnorm": [80.0017318725586]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 606.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 303350, "num_env_steps_trained": 303000, "num_agent_steps_sampled": 303350, "num_agent_steps_trained": 303000, "num_training_step_calls_since_last_synch_worker_weights": 312, "last_target_update_ts": 303350, "num_weight_broadcasts": 6018, "num_target_updates": 6018, "num_samples_added_to_queue": 303000, "learner_queue": {"size_count": 606, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.074, "learner_load_time_ms": 0.07, "learner_load_wait_time_ms": 903.339, "learner_dequeue_time_ms": 14330.341}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -3478274.0, "episode_reward_mean": -676312.99, "episode_len_mean": 1702.4, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0], "episode_lengths": [1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4046849300623158, "mean_inference_ms": 1.08239553303161, "mean_action_processing_ms": 0.15161497273748337, "mean_env_wait_ms": 0.057759193176936806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01081991195678711, "StateBufferConnector_ms": 0.002896547317504883, "ViewRequirementAgentConnector_ms": 0.12579727172851562}}, "episode_reward_max": -14385.0, "episode_reward_min": -3478274.0, "episode_reward_mean": -676312.99, "episode_len_mean": 1702.4, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-602768.0, -323433.0, -101489.0, -442995.0, -217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0], "episode_lengths": [1613, 933, 352, 1217, 657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4046849300623158, "mean_inference_ms": 1.08239553303161, "mean_action_processing_ms": 0.15161497273748337, "mean_env_wait_ms": 0.057759193176936806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01081991195678711, "StateBufferConnector_ms": 0.002896547317504883, "ViewRequirementAgentConnector_ms": 0.12579727172851562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 303350, "num_agent_steps_trained": 303000, "num_env_steps_sampled": 303350, "num_env_steps_trained": 303000, "num_env_steps_sampled_this_iter": 5550, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 554.9923518757967, "num_env_steps_trained_throughput_per_sec": 549.9924207778165, "timesteps_total": 303350, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 303350, "timers": {"training_iteration_time_ms": 0.252, "sample_time_ms": 0.152, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 303350, "num_env_steps_trained": 303000, "num_agent_steps_sampled": 303350, "num_agent_steps_trained": 303000, "num_training_step_calls_since_last_synch_worker_weights": 312, "last_target_update_ts": 303350, "num_weight_broadcasts": 6018, "num_target_updates": 6018, "num_samples_added_to_queue": 303000}, "done": false, "episodes_total": 167, "training_iteration": 55, "trial_id": "304dd_00000", "date": "2023-12-11_01-56-42", "timestamp": 1702288602, "time_this_iter_s": 10.098876714706421, "time_total_s": 556.778680562973, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 556.778680562973, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 36.05714285714286, "ram_util_percent": 86.64285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 20935570.0, "policy_loss": 7921.998046875, "entropy": 1.0728932619094849, "var_gnorm": 37.80905532836914, "vf_loss": 41855296.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.998883843421936, "var_IS": 0.00031989492708817124, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 618.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 309150, "num_env_steps_trained": 309000, "num_agent_steps_sampled": 309150, "num_agent_steps_trained": 309000, "num_training_step_calls_since_last_synch_worker_weights": 298, "last_target_update_ts": 309150, "num_weight_broadcasts": 6133, "num_target_updates": 6133, "num_samples_added_to_queue": 309000, "learner_queue": {"size_count": 618, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.74, "learner_load_time_ms": 0.07, "learner_load_wait_time_ms": 861.537, "learner_dequeue_time_ms": 14363.282}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -3478274.0, "episode_reward_mean": -680731.54, "episode_len_mean": 1718.76, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0], "episode_lengths": [657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.403950859692345, "mean_inference_ms": 1.0808657687806507, "mean_action_processing_ms": 0.1511542891455509, "mean_env_wait_ms": 0.057619793814549604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009005069732666016, "StateBufferConnector_ms": 0.0038957595825195312, "ViewRequirementAgentConnector_ms": 0.12292337417602539}}, "episode_reward_max": -14385.0, "episode_reward_min": -3478274.0, "episode_reward_mean": -680731.54, "episode_len_mean": 1718.76, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-217014.0, -678741.0, -566146.0, -1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0], "episode_lengths": [657, 1815, 1587, 3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.403950859692345, "mean_inference_ms": 1.0808657687806507, "mean_action_processing_ms": 0.1511542891455509, "mean_env_wait_ms": 0.057619793814549604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009005069732666016, "StateBufferConnector_ms": 0.0038957595825195312, "ViewRequirementAgentConnector_ms": 0.12292337417602539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 309150, "num_agent_steps_trained": 309000, "num_env_steps_sampled": 309150, "num_env_steps_trained": 309000, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 579.9914127667587, "num_env_steps_trained_throughput_per_sec": 599.9911166552677, "timesteps_total": 309150, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 309150, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.1}, "counters": {"num_env_steps_sampled": 309150, "num_env_steps_trained": 309000, "num_agent_steps_sampled": 309150, "num_agent_steps_trained": 309000, "num_training_step_calls_since_last_synch_worker_weights": 298, "last_target_update_ts": 309150, "num_weight_broadcasts": 6133, "num_target_updates": 6133, "num_samples_added_to_queue": 309000}, "done": false, "episodes_total": 171, "training_iteration": 56, "trial_id": "304dd_00000", "date": "2023-12-11_01-56-52", "timestamp": 1702288612, "time_this_iter_s": 10.10374641418457, "time_total_s": 566.8824269771576, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 566.8824269771576, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 32.035714285714285, "ram_util_percent": 88.2642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 17790280.0, "policy_loss": 6647.46044921875, "entropy": 1.0827919244766235, "var_gnorm": 37.827735900878906, "vf_loss": 35567264.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.000222086906433, "var_IS": 0.00017198611749336123, "model": {}, "grad_gnorm": [80.00096130371094]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 629.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 314950, "num_env_steps_trained": 314500, "num_agent_steps_sampled": 314950, "num_agent_steps_trained": 314500, "num_training_step_calls_since_last_synch_worker_weights": 321, "last_target_update_ts": 314950, "num_weight_broadcasts": 6248, "num_target_updates": 6248, "num_samples_added_to_queue": 314500, "learner_queue": {"size_count": 629, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.393, "learner_load_time_ms": 0.07, "learner_load_wait_time_ms": 860.055, "learner_dequeue_time_ms": 14340.019}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -3478274.0, "episode_reward_mean": -688875.35, "episode_len_mean": 1742.3, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0], "episode_lengths": [3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40342613498811936, "mean_inference_ms": 1.0797722426710015, "mean_action_processing_ms": 0.15082791097923026, "mean_env_wait_ms": 0.05751846074691296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009005069732666016, "StateBufferConnector_ms": 0.0038957595825195312, "ViewRequirementAgentConnector_ms": 0.1254715919494629}}, "episode_reward_max": -14385.0, "episode_reward_min": -3478274.0, "episode_reward_mean": -688875.35, "episode_len_mean": 1742.3, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1303304.0, -335204.0, -783319.0, -168966.0, -196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0], "episode_lengths": [3444, 1202, 1610, 346, 555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40342613498811936, "mean_inference_ms": 1.0797722426710015, "mean_action_processing_ms": 0.15082791097923026, "mean_env_wait_ms": 0.05751846074691296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009005069732666016, "StateBufferConnector_ms": 0.0038957595825195312, "ViewRequirementAgentConnector_ms": 0.1254715919494629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 314950, "num_agent_steps_trained": 314500, "num_env_steps_sampled": 314950, "num_env_steps_trained": 314500, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 579.9378070770208, "num_env_steps_trained_throughput_per_sec": 549.9410239523473, "timesteps_total": 314950, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 314950, "timers": {"training_iteration_time_ms": 0.115, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 314950, "num_env_steps_trained": 314500, "num_agent_steps_sampled": 314950, "num_agent_steps_trained": 314500, "num_training_step_calls_since_last_synch_worker_weights": 321, "last_target_update_ts": 314950, "num_weight_broadcasts": 6248, "num_target_updates": 6248, "num_samples_added_to_queue": 314500}, "done": false, "episodes_total": 174, "training_iteration": 57, "trial_id": "304dd_00000", "date": "2023-12-11_01-57-02", "timestamp": 1702288622, "time_this_iter_s": 10.105143070220947, "time_total_s": 576.9875700473785, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 576.9875700473785, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 32.47142857142857, "ram_util_percent": 88.29285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 10614170.0, "policy_loss": 5545.73291015625, "entropy": 1.0477924346923828, "var_gnorm": 37.85306930541992, "vf_loss": 21217248.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9998444318771362, "var_IS": 4.121123856748454e-05, "model": {}, "grad_gnorm": [79.99999237060547]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 641.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 320750, "num_env_steps_trained": 320500, "num_agent_steps_sampled": 320750, "num_agent_steps_trained": 320500, "num_training_step_calls_since_last_synch_worker_weights": 211, "last_target_update_ts": 320750, "num_weight_broadcasts": 6363, "num_target_updates": 6363, "num_samples_added_to_queue": 320500, "learner_queue": {"size_count": 641, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.7, "learner_load_time_ms": 0.07, "learner_load_wait_time_ms": 859.5, "learner_dequeue_time_ms": 14257.057}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -3478274.0, "episode_reward_mean": -679498.44, "episode_len_mean": 1723.26, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0], "episode_lengths": [555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40280200974531694, "mean_inference_ms": 1.0784092375906067, "mean_action_processing_ms": 0.15042117927379967, "mean_env_wait_ms": 0.05740097720127201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009005069732666016, "StateBufferConnector_ms": 0.004922389984130859, "ViewRequirementAgentConnector_ms": 0.12406373023986816}}, "episode_reward_max": -14385.0, "episode_reward_min": -3478274.0, "episode_reward_mean": -679498.44, "episode_len_mean": 1723.26, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-196663.0, -806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0], "episode_lengths": [555, 2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40280200974531694, "mean_inference_ms": 1.0784092375906067, "mean_action_processing_ms": 0.15042117927379967, "mean_env_wait_ms": 0.05740097720127201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009005069732666016, "StateBufferConnector_ms": 0.004922389984130859, "ViewRequirementAgentConnector_ms": 0.12406373023986816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320750, "num_agent_steps_trained": 320500, "num_env_steps_sampled": 320750, "num_env_steps_trained": 320500, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 579.9896289772574, "num_env_steps_trained_throughput_per_sec": 599.9892713557836, "timesteps_total": 320750, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 320750, "timers": {"training_iteration_time_ms": 0.199, "sample_time_ms": 0.068, "synch_weights_time_ms": 0.032}, "counters": {"num_env_steps_sampled": 320750, "num_env_steps_trained": 320500, "num_agent_steps_sampled": 320750, "num_agent_steps_trained": 320500, "num_training_step_calls_since_last_synch_worker_weights": 211, "last_target_update_ts": 320750, "num_weight_broadcasts": 6363, "num_target_updates": 6363, "num_samples_added_to_queue": 320500}, "done": false, "episodes_total": 178, "training_iteration": 58, "trial_id": "304dd_00000", "date": "2023-12-11_01-57-13", "timestamp": 1702288633, "time_this_iter_s": 10.118321895599365, "time_total_s": 587.1058919429779, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 587.1058919429779, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 34.27333333333333, "ram_util_percent": 88.14000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 11661262.0, "policy_loss": 5661.486328125, "entropy": 1.053024411201477, "var_gnorm": 37.879085540771484, "vf_loss": 23311202.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0006160736083984, "var_IS": 0.00011900581739610061, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 653.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 326600, "num_env_steps_trained": 326500, "num_agent_steps_sampled": 326600, "num_agent_steps_trained": 326500, "num_training_step_calls_since_last_synch_worker_weights": 53, "last_target_update_ts": 326600, "num_weight_broadcasts": 6479, "num_target_updates": 6479, "num_samples_added_to_queue": 326500, "learner_queue": {"size_count": 653, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.238, "learner_load_time_ms": 0.07, "learner_load_wait_time_ms": 848.623, "learner_dequeue_time_ms": 14257.057}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -3478274.0, "episode_reward_mean": -703373.86, "episode_len_mean": 1792.36, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0], "episode_lengths": [2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4026420526248372, "mean_inference_ms": 1.0780591243312414, "mean_action_processing_ms": 0.15031761083278658, "mean_env_wait_ms": 0.05737134208159623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009005069732666016, "StateBufferConnector_ms": 0.004922389984130859, "ViewRequirementAgentConnector_ms": 0.12424015998840332}}, "episode_reward_max": -14385.0, "episode_reward_min": -3478274.0, "episode_reward_mean": -703373.86, "episode_len_mean": 1792.36, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-806784.0, -28185.0, -847527.0, -1769594.0, -3478274.0, -311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0], "episode_lengths": [2163, 60, 2434, 4838, 5634, 1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4026420526248372, "mean_inference_ms": 1.0780591243312414, "mean_action_processing_ms": 0.15031761083278658, "mean_env_wait_ms": 0.05737134208159623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009005069732666016, "StateBufferConnector_ms": 0.004922389984130859, "ViewRequirementAgentConnector_ms": 0.12424015998840332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 326600, "num_agent_steps_trained": 326500, "num_env_steps_sampled": 326600, "num_env_steps_trained": 326500, "num_env_steps_sampled_this_iter": 5850, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 584.9742401260969, "num_env_steps_trained_throughput_per_sec": 599.9735796165096, "timesteps_total": 326600, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 326600, "timers": {"training_iteration_time_ms": 0.196, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 326600, "num_env_steps_trained": 326500, "num_agent_steps_sampled": 326600, "num_agent_steps_trained": 326500, "num_training_step_calls_since_last_synch_worker_weights": 53, "last_target_update_ts": 326600, "num_weight_broadcasts": 6479, "num_target_updates": 6479, "num_samples_added_to_queue": 326500}, "done": false, "episodes_total": 179, "training_iteration": 59, "trial_id": "304dd_00000", "date": "2023-12-11_01-57-23", "timestamp": 1702288643, "time_this_iter_s": 10.153597593307495, "time_total_s": 597.2594895362854, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 597.2594895362854, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 32.68571428571429, "ram_util_percent": 87.88571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 15012302.0, "policy_loss": 6564.70654296875, "entropy": 1.0885549783706665, "var_gnorm": 37.89900207519531, "vf_loss": 30011474.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9998878240585327, "var_IS": 4.101685408386402e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 664.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 332050, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332050, "num_agent_steps_trained": 332000, "num_training_step_calls_since_last_synch_worker_weights": 107, "last_target_update_ts": 332050, "num_weight_broadcasts": 6587, "num_target_updates": 6587, "num_samples_added_to_queue": 332000, "learner_queue": {"size_count": 664, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.066, "learner_load_time_ms": 0.07, "learner_load_wait_time_ms": 921.623, "learner_dequeue_time_ms": 14180.031}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -2821734.0, "episode_reward_mean": -649559.93, "episode_len_mean": 1687.76, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0], "episode_lengths": [1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4019401292268158, "mean_inference_ms": 1.0764694283326073, "mean_action_processing_ms": 0.14986586365945773, "mean_env_wait_ms": 0.057237894384631324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010009765625, "StateBufferConnector_ms": 0.0045146942138671875, "ViewRequirementAgentConnector_ms": 0.12159299850463867}}, "episode_reward_max": -14385.0, "episode_reward_min": -2821734.0, "episode_reward_mean": -649559.93, "episode_len_mean": 1687.76, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-311945.0, -304206.0, -365717.0, -291390.0, -293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0], "episode_lengths": [1034, 867, 1089, 729, 827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4019401292268158, "mean_inference_ms": 1.0764694283326073, "mean_action_processing_ms": 0.14986586365945773, "mean_env_wait_ms": 0.057237894384631324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010009765625, "StateBufferConnector_ms": 0.0045146942138671875, "ViewRequirementAgentConnector_ms": 0.12159299850463867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332050, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332050, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 5450, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 544.9545384423731, "num_env_steps_trained_throughput_per_sec": 549.9541213638627, "timesteps_total": 332050, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 332050, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 332050, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332050, "num_agent_steps_trained": 332000, "num_training_step_calls_since_last_synch_worker_weights": 107, "last_target_update_ts": 332050, "num_weight_broadcasts": 6587, "num_target_updates": 6587, "num_samples_added_to_queue": 332000}, "done": false, "episodes_total": 184, "training_iteration": 60, "trial_id": "304dd_00000", "date": "2023-12-11_01-57-33", "timestamp": 1702288653, "time_this_iter_s": 10.13812518119812, "time_total_s": 607.3976147174835, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 607.3976147174835, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 37.32142857142856, "ram_util_percent": 87.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 32341658.0, "policy_loss": 8712.068359375, "entropy": 1.0586720705032349, "var_gnorm": 37.92033386230469, "vf_loss": 64665892.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0003854036331177, "var_IS": 0.00012888014316558838, "model": {}, "grad_gnorm": [80.12688446044922]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 675.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 337850, "num_env_steps_trained": 337500, "num_agent_steps_sampled": 337850, "num_agent_steps_trained": 337500, "num_training_step_calls_since_last_synch_worker_weights": 192, "last_target_update_ts": 337850, "num_weight_broadcasts": 6702, "num_target_updates": 6702, "num_samples_added_to_queue": 337500, "learner_queue": {"size_count": 675, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.728, "learner_load_time_ms": 0.07, "learner_load_wait_time_ms": 862.207, "learner_dequeue_time_ms": 14185.774}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -2821734.0, "episode_reward_mean": -661965.47, "episode_len_mean": 1716.09, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0], "episode_lengths": [827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4014088512049341, "mean_inference_ms": 1.075220854602905, "mean_action_processing_ms": 0.1495206957299616, "mean_env_wait_ms": 0.057128473074361884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01036691665649414, "StateBufferConnector_ms": 0.0045146942138671875, "ViewRequirementAgentConnector_ms": 0.12035560607910156}}, "episode_reward_max": -14385.0, "episode_reward_min": -2821734.0, "episode_reward_mean": -661965.47, "episode_len_mean": 1716.09, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-293179.0, -242201.0, -730447.0, -339153.0, -2821734.0, -858646.0, -1516125.0, -2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0], "episode_lengths": [827, 688, 2366, 1047, 5922, 2647, 3458, 5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4014088512049341, "mean_inference_ms": 1.075220854602905, "mean_action_processing_ms": 0.1495206957299616, "mean_env_wait_ms": 0.057128473074361884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01036691665649414, "StateBufferConnector_ms": 0.0045146942138671875, "ViewRequirementAgentConnector_ms": 0.12035560607910156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 337850, "num_agent_steps_trained": 337500, "num_env_steps_sampled": 337850, "num_env_steps_trained": 337500, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 579.9764513994043, "num_env_steps_trained_throughput_per_sec": 549.9776694304695, "timesteps_total": 337850, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 337850, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 337850, "num_env_steps_trained": 337500, "num_agent_steps_sampled": 337850, "num_agent_steps_trained": 337500, "num_training_step_calls_since_last_synch_worker_weights": 192, "last_target_update_ts": 337850, "num_weight_broadcasts": 6702, "num_target_updates": 6702, "num_samples_added_to_queue": 337500}, "done": false, "episodes_total": 188, "training_iteration": 61, "trial_id": "304dd_00000", "date": "2023-12-11_01-57-43", "timestamp": 1702288663, "time_this_iter_s": 10.124446630477905, "time_total_s": 617.5220613479614, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 617.5220613479614, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 31.921428571428574, "ram_util_percent": 86.79285714285712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 17967498.0, "policy_loss": 6595.6337890625, "entropy": 1.0039979219436646, "var_gnorm": 37.94565963745117, "vf_loss": 35921804.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.000135898590088, "var_IS": 0.00012983905617147684, "model": {}, "grad_gnorm": [80.00996398925781]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 687.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 343550, "num_env_steps_trained": 343500, "num_agent_steps_sampled": 343550, "num_agent_steps_trained": 343500, "num_training_step_calls_since_last_synch_worker_weights": 432, "last_target_update_ts": 343550, "num_weight_broadcasts": 6815, "num_target_updates": 6815, "num_samples_added_to_queue": 343500, "learner_queue": {"size_count": 687, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.268, "learner_load_time_ms": 0.07, "learner_load_wait_time_ms": 870.218, "learner_dequeue_time_ms": 14185.774}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -612400.65, "episode_len_mean": 1600.02, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0], "episode_lengths": [5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.400583670991918, "mean_inference_ms": 1.0732363282334187, "mean_action_processing_ms": 0.14895464818610177, "mean_env_wait_ms": 0.05695520571771439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009763002395629883, "StateBufferConnector_ms": 0.004793882369995117, "ViewRequirementAgentConnector_ms": 0.12532496452331543}}, "episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -612400.65, "episode_len_mean": 1600.02, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2078714.0, -189526.0, -611970.0, -1111210.0, -159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0], "episode_lengths": [5063, 489, 1753, 2999, 514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.400583670991918, "mean_inference_ms": 1.0732363282334187, "mean_action_processing_ms": 0.14895464818610177, "mean_env_wait_ms": 0.05695520571771439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009763002395629883, "StateBufferConnector_ms": 0.004793882369995117, "ViewRequirementAgentConnector_ms": 0.12532496452331543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 343550, "num_agent_steps_trained": 343500, "num_env_steps_sampled": 343550, "num_env_steps_trained": 343500, "num_env_steps_sampled_this_iter": 5700, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 569.9795615849346, "num_env_steps_trained_throughput_per_sec": 599.9784858788786, "timesteps_total": 343550, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 343550, "timers": {"training_iteration_time_ms": 0.197, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 343550, "num_env_steps_trained": 343500, "num_agent_steps_sampled": 343550, "num_agent_steps_trained": 343500, "num_training_step_calls_since_last_synch_worker_weights": 432, "last_target_update_ts": 343550, "num_weight_broadcasts": 6815, "num_target_updates": 6815, "num_samples_added_to_queue": 343500}, "done": false, "episodes_total": 195, "training_iteration": 62, "trial_id": "304dd_00000", "date": "2023-12-11_01-57-53", "timestamp": 1702288673, "time_this_iter_s": 10.084927320480347, "time_total_s": 627.6069886684418, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 627.6069886684418, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 32.95, "ram_util_percent": 86.1642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 32142398.0, "policy_loss": 8706.41015625, "entropy": 0.9085949659347534, "var_gnorm": 37.973472595214844, "vf_loss": 64267384.0, "vf_explained_var": -2.384185791015625e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0011742115020752, "var_IS": 0.0003463024622760713, "model": {}, "grad_gnorm": [80.0999526977539]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 697.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 348550, "num_env_steps_trained": 348500, "num_agent_steps_sampled": 348550, "num_agent_steps_trained": 348500, "num_training_step_calls_since_last_synch_worker_weights": 329, "last_target_update_ts": 348550, "num_weight_broadcasts": 6914, "num_target_updates": 6914, "num_samples_added_to_queue": 348500, "learner_queue": {"size_count": 697, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.685, "learner_load_time_ms": 0.07, "learner_load_wait_time_ms": 1002.39, "learner_dequeue_time_ms": 14184.266}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -591538.6, "episode_len_mean": 1542.25, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0], "episode_lengths": [514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4002408025268717, "mean_inference_ms": 1.0724174533998947, "mean_action_processing_ms": 0.14870568159679753, "mean_env_wait_ms": 0.056884184137182894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006766319274902344, "StateBufferConnector_ms": 0.004279375076293945, "ViewRequirementAgentConnector_ms": 0.13247394561767578}}, "episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -591538.6, "episode_len_mean": 1542.25, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-159396.0, -489403.0, -533791.0, -1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0], "episode_lengths": [514, 1104, 902, 2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4002408025268717, "mean_inference_ms": 1.0724174533998947, "mean_action_processing_ms": 0.14870568159679753, "mean_env_wait_ms": 0.056884184137182894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006766319274902344, "StateBufferConnector_ms": 0.004279375076293945, "ViewRequirementAgentConnector_ms": 0.13247394561767578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348550, "num_agent_steps_trained": 348500, "num_env_steps_sampled": 348550, "num_env_steps_trained": 348500, "num_env_steps_sampled_this_iter": 5000, "num_env_steps_trained_this_iter": 5000, "num_env_steps_sampled_throughput_per_sec": 499.9771367037726, "num_env_steps_trained_throughput_per_sec": 499.9771367037726, "timesteps_total": 348550, "num_steps_trained_this_iter": 5000, "agent_timesteps_total": 348550, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.2, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 348550, "num_env_steps_trained": 348500, "num_agent_steps_sampled": 348550, "num_agent_steps_trained": 348500, "num_training_step_calls_since_last_synch_worker_weights": 329, "last_target_update_ts": 348550, "num_weight_broadcasts": 6914, "num_target_updates": 6914, "num_samples_added_to_queue": 348500}, "done": false, "episodes_total": 199, "training_iteration": 63, "trial_id": "304dd_00000", "date": "2023-12-11_01-58-03", "timestamp": 1702288683, "time_this_iter_s": 10.139980792999268, "time_total_s": 637.746969461441, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 637.746969461441, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 42.07333333333334, "ram_util_percent": 87.72666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 43083620.0, "policy_loss": 10517.89453125, "entropy": 0.7538076043128967, "var_gnorm": 38.00808334350586, "vf_loss": 86146208.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0000311136245728, "var_IS": 4.2127239794353954e-06, "model": {}, "grad_gnorm": [80.17183685302734]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 707.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 353600, "num_env_steps_trained": 353500, "num_agent_steps_sampled": 353600, "num_agent_steps_trained": 353500, "num_training_step_calls_since_last_synch_worker_weights": 409, "last_target_update_ts": 353600, "num_weight_broadcasts": 7014, "num_target_updates": 7014, "num_samples_added_to_queue": 353500, "learner_queue": {"size_count": 707, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.899, "learner_load_time_ms": 0.07, "learner_load_wait_time_ms": 991.729, "learner_dequeue_time_ms": 14410.635}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -600551.4, "episode_len_mean": 1569.09, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0], "episode_lengths": [2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4000302488005778, "mean_inference_ms": 1.0718976805695368, "mean_action_processing_ms": 0.1485424276969605, "mean_env_wait_ms": 0.05683959968191517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006766319274902344, "StateBufferConnector_ms": 0.004279375076293945, "ViewRequirementAgentConnector_ms": 0.13607096672058105}}, "episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -600551.4, "episode_len_mean": 1569.09, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1135002.0, -268084.0, -2014750.0, -30474.0, -437321.0, -1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0], "episode_lengths": [2196, 740, 5359, 64, 1067, 4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4000302488005778, "mean_inference_ms": 1.0718976805695368, "mean_action_processing_ms": 0.1485424276969605, "mean_env_wait_ms": 0.05683959968191517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006766319274902344, "StateBufferConnector_ms": 0.004279375076293945, "ViewRequirementAgentConnector_ms": 0.13607096672058105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 353600, "num_agent_steps_trained": 353500, "num_env_steps_sampled": 353600, "num_env_steps_trained": 353500, "num_env_steps_sampled_this_iter": 5050, "num_env_steps_trained_this_iter": 5000, "num_env_steps_sampled_throughput_per_sec": 504.99611106529534, "num_env_steps_trained_throughput_per_sec": 499.99614956959937, "timesteps_total": 353600, "num_steps_trained_this_iter": 5000, "agent_timesteps_total": 353600, "timers": {"training_iteration_time_ms": 0.383, "sample_time_ms": 0.147, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 353600, "num_env_steps_trained": 353500, "num_agent_steps_sampled": 353600, "num_agent_steps_trained": 353500, "num_training_step_calls_since_last_synch_worker_weights": 409, "last_target_update_ts": 353600, "num_weight_broadcasts": 7014, "num_target_updates": 7014, "num_samples_added_to_queue": 353500}, "done": false, "episodes_total": 202, "training_iteration": 64, "trial_id": "304dd_00000", "date": "2023-12-11_01-58-14", "timestamp": 1702288694, "time_this_iter_s": 10.115233421325684, "time_total_s": 647.8622028827667, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 647.8622028827667, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 38.00714285714286, "ram_util_percent": 88.76428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 47141176.0, "policy_loss": 11028.7431640625, "entropy": 0.5475032329559326, "var_gnorm": 38.04020690917969, "vf_loss": 94260296.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9995182156562805, "var_IS": 0.0003199187049176544, "model": {}, "grad_gnorm": [80.06448364257812]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 717.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 358900, "num_env_steps_trained": 358500, "num_agent_steps_sampled": 358900, "num_agent_steps_trained": 358500, "num_training_step_calls_since_last_synch_worker_weights": 83, "last_target_update_ts": 358900, "num_weight_broadcasts": 7119, "num_target_updates": 7119, "num_samples_added_to_queue": 358500, "learner_queue": {"size_count": 717, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.756, "learner_load_time_ms": 0.07, "learner_load_wait_time_ms": 960.474, "learner_dequeue_time_ms": 14410.635}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -582388.22, "episode_len_mean": 1526.66, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0], "episode_lengths": [4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3997344647564678, "mean_inference_ms": 1.0711418290175447, "mean_action_processing_ms": 0.14831539985066963, "mean_env_wait_ms": 0.056768468335898915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006766319274902344, "StateBufferConnector_ms": 0.0029633045196533203, "ViewRequirementAgentConnector_ms": 0.13541841506958008}}, "episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -582388.22, "episode_len_mean": 1526.66, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1798327.0, -264332.0, -145498.0, -823450.0, -113818.0, -94017.0, -65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0], "episode_lengths": [4613, 544, 251, 1559, 299, 213, 130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3997344647564678, "mean_inference_ms": 1.0711418290175447, "mean_action_processing_ms": 0.14831539985066963, "mean_env_wait_ms": 0.056768468335898915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006766319274902344, "StateBufferConnector_ms": 0.0029633045196533203, "ViewRequirementAgentConnector_ms": 0.13541841506958008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 358900, "num_agent_steps_trained": 358500, "num_env_steps_sampled": 358900, "num_env_steps_trained": 358500, "num_env_steps_sampled_this_iter": 5300, "num_env_steps_trained_this_iter": 5000, "num_env_steps_sampled_throughput_per_sec": 529.9814001888972, "num_env_steps_trained_throughput_per_sec": 499.9824530083936, "timesteps_total": 358900, "num_steps_trained_this_iter": 5000, "agent_timesteps_total": 358900, "timers": {"training_iteration_time_ms": 0.251, "sample_time_ms": 0.248, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 358900, "num_env_steps_trained": 358500, "num_agent_steps_sampled": 358900, "num_agent_steps_trained": 358500, "num_training_step_calls_since_last_synch_worker_weights": 83, "last_target_update_ts": 358900, "num_weight_broadcasts": 7119, "num_target_updates": 7119, "num_samples_added_to_queue": 358500}, "done": false, "episodes_total": 207, "training_iteration": 65, "trial_id": "304dd_00000", "date": "2023-12-11_01-58-24", "timestamp": 1702288704, "time_this_iter_s": 10.162232160568237, "time_total_s": 658.024435043335, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 658.024435043335, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 35.535714285714285, "ram_util_percent": 88.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 15326456.0, "policy_loss": 6506.666015625, "entropy": 0.4298095405101776, "var_gnorm": 38.07322692871094, "vf_loss": 30639898.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9994744062423706, "var_IS": 3.755915167857893e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 728.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 364100, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364100, "num_agent_steps_trained": 364000, "num_training_step_calls_since_last_synch_worker_weights": 341, "last_target_update_ts": 364100, "num_weight_broadcasts": 7222, "num_target_updates": 7222, "num_samples_added_to_queue": 364000, "learner_queue": {"size_count": 728, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.912, "learner_load_time_ms": 0.07, "learner_load_wait_time_ms": 960.814, "learner_dequeue_time_ms": 14589.392}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -568007.81, "episode_len_mean": 1496.17, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0], "episode_lengths": [130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39948535046759764, "mean_inference_ms": 1.07047322918635, "mean_action_processing_ms": 0.14813458640660268, "mean_env_wait_ms": 0.056702142794351984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007130622863769531, "StateBufferConnector_ms": 0.0029633045196533203, "ViewRequirementAgentConnector_ms": 0.13182640075683594}}, "episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -568007.81, "episode_len_mean": 1496.17, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-65926.0, -154831.0, -967614.0, -160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0], "episode_lengths": [130, 476, 2956, 397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39948535046759764, "mean_inference_ms": 1.07047322918635, "mean_action_processing_ms": 0.14813458640660268, "mean_env_wait_ms": 0.056702142794351984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007130622863769531, "StateBufferConnector_ms": 0.0029633045196533203, "ViewRequirementAgentConnector_ms": 0.13182640075683594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364100, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364100, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 5200, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 519.9861644611468, "num_env_steps_trained_throughput_per_sec": 549.9853662569823, "timesteps_total": 364100, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 364100, "timers": {"training_iteration_time_ms": 0.235, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.199}, "counters": {"num_env_steps_sampled": 364100, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364100, "num_agent_steps_trained": 364000, "num_training_step_calls_since_last_synch_worker_weights": 341, "last_target_update_ts": 364100, "num_weight_broadcasts": 7222, "num_target_updates": 7222, "num_samples_added_to_queue": 364000}, "done": false, "episodes_total": 213, "training_iteration": 66, "trial_id": "304dd_00000", "date": "2023-12-11_01-58-34", "timestamp": 1702288714, "time_this_iter_s": 10.103893995285034, "time_total_s": 668.12832903862, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 668.12832903862, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 36.464285714285715, "ram_util_percent": 88.89285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 20388190.0, "policy_loss": 7627.84423828125, "entropy": 0.4357224106788635, "var_gnorm": 38.1030387878418, "vf_loss": 40761124.0, "vf_explained_var": 1.7881393432617188e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0004290342330933, "var_IS": 5.5058972066035494e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 738.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 369350, "num_env_steps_trained": 369000, "num_agent_steps_sampled": 369350, "num_agent_steps_trained": 369000, "num_training_step_calls_since_last_synch_worker_weights": 174, "last_target_update_ts": 369350, "num_weight_broadcasts": 7326, "num_target_updates": 7326, "num_samples_added_to_queue": 369000, "learner_queue": {"size_count": 738, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 13.156, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 957.804, "learner_dequeue_time_ms": 14716.935}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -581268.74, "episode_len_mean": 1524.38, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0], "episode_lengths": [397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39938091007297777, "mean_inference_ms": 1.0701822477867693, "mean_action_processing_ms": 0.14805941448958612, "mean_env_wait_ms": 0.056672544567937286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007130622863769531, "StateBufferConnector_ms": 0.0034449100494384766, "ViewRequirementAgentConnector_ms": 0.12851428985595703}}, "episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -581268.74, "episode_len_mean": 1524.38, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160380.0, -1697564.0, -234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0], "episode_lengths": [397, 4504, 692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39938091007297777, "mean_inference_ms": 1.0701822477867693, "mean_action_processing_ms": 0.14805941448958612, "mean_env_wait_ms": 0.056672544567937286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007130622863769531, "StateBufferConnector_ms": 0.0034449100494384766, "ViewRequirementAgentConnector_ms": 0.12851428985595703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 369350, "num_agent_steps_trained": 369000, "num_env_steps_sampled": 369350, "num_env_steps_trained": 369000, "num_env_steps_sampled_this_iter": 5250, "num_env_steps_trained_this_iter": 5000, "num_env_steps_sampled_throughput_per_sec": 524.9516388623103, "num_env_steps_trained_throughput_per_sec": 499.95394177362886, "timesteps_total": 369350, "num_steps_trained_this_iter": 5000, "agent_timesteps_total": 369350, "timers": {"training_iteration_time_ms": 0.201, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 369350, "num_env_steps_trained": 369000, "num_agent_steps_sampled": 369350, "num_agent_steps_trained": 369000, "num_training_step_calls_since_last_synch_worker_weights": 174, "last_target_update_ts": 369350, "num_weight_broadcasts": 7326, "num_target_updates": 7326, "num_samples_added_to_queue": 369000}, "done": false, "episodes_total": 216, "training_iteration": 67, "trial_id": "304dd_00000", "date": "2023-12-11_01-58-44", "timestamp": 1702288724, "time_this_iter_s": 10.139274835586548, "time_total_s": 678.2676038742065, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 678.2676038742065, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 35.46428571428571, "ram_util_percent": 88.89285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 32990018.0, "policy_loss": 9385.26171875, "entropy": 0.6040993928909302, "var_gnorm": 38.12703323364258, "vf_loss": 65961264.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9999591708183289, "var_IS": 2.0944178686477244e-05, "model": {}, "grad_gnorm": [80.0103530883789]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 749.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 374650, "num_env_steps_trained": 374500, "num_agent_steps_sampled": 374650, "num_agent_steps_trained": 374500, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 374650, "num_weight_broadcasts": 7431, "num_target_updates": 7431, "num_samples_added_to_queue": 374500, "learner_queue": {"size_count": 749, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.465, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 948.678, "learner_dequeue_time_ms": 14716.935}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -572955.27, "episode_len_mean": 1502.83, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0], "episode_lengths": [692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39932340966683344, "mean_inference_ms": 1.0700118552310243, "mean_action_processing_ms": 0.1480200763176958, "mean_env_wait_ms": 0.05665448332417656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006131172180175781, "StateBufferConnector_ms": 0.0034449100494384766, "ViewRequirementAgentConnector_ms": 0.125563383102417}}, "episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -572955.27, "episode_len_mean": 1502.83, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-234377.0, -354271.0, -1033387.0, -25401.0, -723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0], "episode_lengths": [692, 1017, 2941, 97, 1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39932340966683344, "mean_inference_ms": 1.0700118552310243, "mean_action_processing_ms": 0.1480200763176958, "mean_env_wait_ms": 0.05665448332417656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006131172180175781, "StateBufferConnector_ms": 0.0034449100494384766, "ViewRequirementAgentConnector_ms": 0.125563383102417}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 1, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 374650, "num_agent_steps_trained": 374500, "num_env_steps_sampled": 374650, "num_env_steps_trained": 374500, "num_env_steps_sampled_this_iter": 5300, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 529.6982429071421, "num_env_steps_trained_throughput_per_sec": 549.6868558470343, "timesteps_total": 374650, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 374650, "timers": {"training_iteration_time_ms": 1.2, "sample_time_ms": 0.175, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 374650, "num_env_steps_trained": 374500, "num_agent_steps_sampled": 374650, "num_agent_steps_trained": 374500, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 374650, "num_weight_broadcasts": 7431, "num_target_updates": 7431, "num_samples_added_to_queue": 374500}, "done": false, "episodes_total": 218, "training_iteration": 68, "trial_id": "304dd_00000", "date": "2023-12-11_01-58-54", "timestamp": 1702288734, "time_this_iter_s": 10.093724727630615, "time_total_s": 688.3613286018372, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 688.3613286018372, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 35.473333333333336, "ram_util_percent": 88.96000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 60887724.0, "policy_loss": 12320.61328125, "entropy": 0.8025599122047424, "var_gnorm": 38.14600372314453, "vf_loss": 121750808.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.000117301940918, "var_IS": 1.716220322123263e-05, "model": {}, "grad_gnorm": [80.3162612915039]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 759.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 379900, "num_env_steps_trained": 379500, "num_agent_steps_sampled": 379900, "num_agent_steps_trained": 379500, "num_training_step_calls_since_last_synch_worker_weights": 200, "last_target_update_ts": 379900, "num_weight_broadcasts": 7536, "num_target_updates": 7536, "num_samples_added_to_queue": 379500, "learner_queue": {"size_count": 759, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.539, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 951.059, "learner_dequeue_time_ms": 14845.669}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -581582.99, "episode_len_mean": 1527.37, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0], "episode_lengths": [1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39923881530930794, "mean_inference_ms": 1.0697324398462527, "mean_action_processing_ms": 0.14797143340828714, "mean_env_wait_ms": 0.05662465226072042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041315555572509766, "StateBufferConnector_ms": 0.0034449100494384766, "ViewRequirementAgentConnector_ms": 0.12743330001831055}}, "episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -581582.99, "episode_len_mean": 1527.37, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-723994.0, -1455028.0, -386075.0, -770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0], "episode_lengths": [1377, 2707, 835, 1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39923881530930794, "mean_inference_ms": 1.0697324398462527, "mean_action_processing_ms": 0.14797143340828714, "mean_env_wait_ms": 0.05662465226072042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041315555572509766, "StateBufferConnector_ms": 0.0034449100494384766, "ViewRequirementAgentConnector_ms": 0.12743330001831055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 379900, "num_agent_steps_trained": 379500, "num_env_steps_sampled": 379900, "num_env_steps_trained": 379500, "num_env_steps_sampled_this_iter": 5250, "num_env_steps_trained_this_iter": 5000, "num_env_steps_sampled_throughput_per_sec": 524.9469208743232, "num_env_steps_trained_throughput_per_sec": 499.9494484517364, "timesteps_total": 379900, "num_steps_trained_this_iter": 5000, "agent_timesteps_total": 379900, "timers": {"training_iteration_time_ms": 0.203, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.1}, "counters": {"num_env_steps_sampled": 379900, "num_env_steps_trained": 379500, "num_agent_steps_sampled": 379900, "num_agent_steps_trained": 379500, "num_training_step_calls_since_last_synch_worker_weights": 200, "last_target_update_ts": 379900, "num_weight_broadcasts": 7536, "num_target_updates": 7536, "num_samples_added_to_queue": 379500}, "done": false, "episodes_total": 222, "training_iteration": 69, "trial_id": "304dd_00000", "date": "2023-12-11_01-59-05", "timestamp": 1702288745, "time_this_iter_s": 10.131117582321167, "time_total_s": 698.4924461841583, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 698.4924461841583, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 36.31428571428571, "ram_util_percent": 88.90714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 14571168.0, "policy_loss": 6508.77587890625, "entropy": 0.9369063377380371, "var_gnorm": 38.1752815246582, "vf_loss": 29129318.0, "vf_explained_var": -2.384185791015625e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.00058913230896, "var_IS": 0.00022732169600203633, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 770.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 385100, "num_env_steps_trained": 385000, "num_agent_steps_sampled": 385100, "num_agent_steps_trained": 385000, "num_training_step_calls_since_last_synch_worker_weights": 362, "last_target_update_ts": 385100, "num_weight_broadcasts": 7639, "num_target_updates": 7639, "num_samples_added_to_queue": 385000, "learner_queue": {"size_count": 770, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.611, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 960.551, "learner_dequeue_time_ms": 14945.11}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -578331.51, "episode_len_mean": 1530.88, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0], "episode_lengths": [1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3992077065823791, "mean_inference_ms": 1.0695850347007558, "mean_action_processing_ms": 0.14795614394473838, "mean_env_wait_ms": 0.05660800721188959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041315555572509766, "StateBufferConnector_ms": 0.0030336380004882812, "ViewRequirementAgentConnector_ms": 0.12585926055908203}}, "episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -578331.51, "episode_len_mean": 1530.88, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-770604.0, -50369.0, -146813.0, -715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0], "episode_lengths": [1983, 176, 336, 1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3992077065823791, "mean_inference_ms": 1.0695850347007558, "mean_action_processing_ms": 0.14795614394473838, "mean_env_wait_ms": 0.05660800721188959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041315555572509766, "StateBufferConnector_ms": 0.0030336380004882812, "ViewRequirementAgentConnector_ms": 0.12585926055908203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 385100, "num_agent_steps_trained": 385000, "num_env_steps_sampled": 385100, "num_env_steps_trained": 385000, "num_env_steps_sampled_this_iter": 5200, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 519.958185697547, "num_env_steps_trained_throughput_per_sec": 549.955773333944, "timesteps_total": 385100, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 385100, "timers": {"training_iteration_time_ms": 0.251, "sample_time_ms": 0.05, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 385100, "num_env_steps_trained": 385000, "num_agent_steps_sampled": 385100, "num_agent_steps_trained": 385000, "num_training_step_calls_since_last_synch_worker_weights": 362, "last_target_update_ts": 385100, "num_weight_broadcasts": 7639, "num_target_updates": 7639, "num_samples_added_to_queue": 385000}, "done": false, "episodes_total": 225, "training_iteration": 70, "trial_id": "304dd_00000", "date": "2023-12-11_01-59-15", "timestamp": 1702288755, "time_this_iter_s": 10.114156723022461, "time_total_s": 708.6066029071808, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 708.6066029071808, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 37.17142857142857, "ram_util_percent": 88.86428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 73066776.0, "policy_loss": 14438.3798828125, "entropy": 1.0231962203979492, "var_gnorm": 38.20177459716797, "vf_loss": 146104672.0, "vf_explained_var": 1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9999380707740784, "var_IS": 1.9174905901309103e-05, "model": {}, "grad_gnorm": [80.3875503540039]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 781.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 390700, "num_env_steps_trained": 390500, "num_agent_steps_sampled": 390700, "num_agent_steps_trained": 390500, "num_training_step_calls_since_last_synch_worker_weights": 202, "last_target_update_ts": 390700, "num_weight_broadcasts": 7750, "num_target_updates": 7750, "num_samples_added_to_queue": 390500, "learner_queue": {"size_count": 781, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.082, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 891.422, "learner_dequeue_time_ms": 14945.11}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -591008.19, "episode_len_mean": 1564.54, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0], "episode_lengths": [1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3991835077957073, "mean_inference_ms": 1.0694401108069551, "mean_action_processing_ms": 0.14794496626027256, "mean_env_wait_ms": 0.05659244330906826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041315555572509766, "StateBufferConnector_ms": 0.0030336380004882812, "ViewRequirementAgentConnector_ms": 0.12583470344543457}}, "episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -591008.19, "episode_len_mean": 1564.54, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-715712.0, -106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0], "episode_lengths": [1792, 208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3991835077957073, "mean_inference_ms": 1.0694401108069551, "mean_action_processing_ms": 0.14794496626027256, "mean_env_wait_ms": 0.05659244330906826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041315555572509766, "StateBufferConnector_ms": 0.0030336380004882812, "ViewRequirementAgentConnector_ms": 0.12583470344543457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 390700, "num_agent_steps_trained": 390500, "num_env_steps_sampled": 390700, "num_env_steps_trained": 390500, "num_env_steps_sampled_this_iter": 5600, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 559.9593211161747, "num_env_steps_trained_throughput_per_sec": 549.9600475248144, "timesteps_total": 390700, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 390700, "timers": {"training_iteration_time_ms": 0.202, "sample_time_ms": 0.089, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 390700, "num_env_steps_trained": 390500, "num_agent_steps_sampled": 390700, "num_agent_steps_trained": 390500, "num_training_step_calls_since_last_synch_worker_weights": 202, "last_target_update_ts": 390700, "num_weight_broadcasts": 7750, "num_target_updates": 7750, "num_samples_added_to_queue": 390500}, "done": false, "episodes_total": 228, "training_iteration": 71, "trial_id": "304dd_00000", "date": "2023-12-11_01-59-25", "timestamp": 1702288765, "time_this_iter_s": 10.118645191192627, "time_total_s": 718.7252480983734, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 718.7252480983734, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 35.207142857142856, "ram_util_percent": 88.6857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 22694136.0, "policy_loss": 8287.94921875, "entropy": 1.000433087348938, "var_gnorm": 38.242122650146484, "vf_loss": 45371696.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0003461837768555, "var_IS": 0.0002834558254107833, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 792.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 396350, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396350, "num_agent_steps_trained": 396000, "num_training_step_calls_since_last_synch_worker_weights": 170, "last_target_update_ts": 396350, "num_weight_broadcasts": 7862, "num_target_updates": 7862, "num_samples_added_to_queue": 396000, "learner_queue": {"size_count": 792, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.449, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 887.298, "learner_dequeue_time_ms": 15033.899}}, "sampler_results": {"episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -604543.54, "episode_len_mean": 1591.25, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0], "episode_lengths": [208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39917200606746156, "mean_inference_ms": 1.0693898728880629, "mean_action_processing_ms": 0.14794013725849425, "mean_env_wait_ms": 0.056586982609672966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005145072937011719, "StateBufferConnector_ms": 0.0030336380004882812, "ViewRequirementAgentConnector_ms": 0.12683582305908203}}, "episode_reward_max": -14385.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -604543.54, "episode_len_mean": 1591.25, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106614.0, -862225.0, -673520.0, -14385.0, -711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0], "episode_lengths": [208, 1932, 1549, 31, 1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39917200606746156, "mean_inference_ms": 1.0693898728880629, "mean_action_processing_ms": 0.14794013725849425, "mean_env_wait_ms": 0.056586982609672966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005145072937011719, "StateBufferConnector_ms": 0.0030336380004882812, "ViewRequirementAgentConnector_ms": 0.12683582305908203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396350, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396350, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 5650, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 564.9934937511091, "num_env_steps_trained_throughput_per_sec": 549.9936664833805, "timesteps_total": 396350, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 396350, "timers": {"training_iteration_time_ms": 0.167, "sample_time_ms": 0.158, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 396350, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396350, "num_agent_steps_trained": 396000, "num_training_step_calls_since_last_synch_worker_weights": 170, "last_target_update_ts": 396350, "num_weight_broadcasts": 7862, "num_target_updates": 7862, "num_samples_added_to_queue": 396000}, "done": false, "episodes_total": 229, "training_iteration": 72, "trial_id": "304dd_00000", "date": "2023-12-11_01-59-35", "timestamp": 1702288775, "time_this_iter_s": 10.121369123458862, "time_total_s": 728.8466172218323, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 728.8466172218323, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 35.35, "ram_util_percent": 89.07142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 35418476.0, "policy_loss": 8903.5400390625, "entropy": 0.8084203004837036, "var_gnorm": 38.27435302734375, "vf_loss": 70819144.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0003812313079834, "var_IS": 0.0002816568303387612, "model": {}, "grad_gnorm": [80.01734161376953]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 804.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 402100, "num_env_steps_trained": 402000, "num_agent_steps_sampled": 402100, "num_agent_steps_trained": 402000, "num_training_step_calls_since_last_synch_worker_weights": 68, "last_target_update_ts": 402100, "num_weight_broadcasts": 7976, "num_target_updates": 7976, "num_samples_added_to_queue": 402000, "learner_queue": {"size_count": 804, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.079, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 873.369, "learner_dequeue_time_ms": 15028.332}}, "sampler_results": {"episode_reward_max": -40644.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -611611.29, "episode_len_mean": 1611.31, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0], "episode_lengths": [1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39909655178035736, "mean_inference_ms": 1.069125997213728, "mean_action_processing_ms": 0.14791804728185168, "mean_env_wait_ms": 0.05656094148834093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004145145416259766, "StateBufferConnector_ms": 0.0030336380004882812, "ViewRequirementAgentConnector_ms": 0.1239621639251709}}, "episode_reward_max": -40644.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -611611.29, "episode_len_mean": 1611.31, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-711232.0, -64890.0, -2139868.0, -1266240.0, -176232.0, -306880.0, -183495.0, -820695.0, -1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0], "episode_lengths": [1989, 153, 6007, 3385, 493, 875, 537, 1777, 3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39909655178035736, "mean_inference_ms": 1.069125997213728, "mean_action_processing_ms": 0.14791804728185168, "mean_env_wait_ms": 0.05656094148834093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004145145416259766, "StateBufferConnector_ms": 0.0030336380004882812, "ViewRequirementAgentConnector_ms": 0.1239621639251709}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 402100, "num_agent_steps_trained": 402000, "num_env_steps_sampled": 402100, "num_env_steps_trained": 402000, "num_env_steps_sampled_this_iter": 5750, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 574.9779703712848, "num_env_steps_trained_throughput_per_sec": 599.9770125613406, "timesteps_total": 402100, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 402100, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.056, "synch_weights_time_ms": 0.044}, "counters": {"num_env_steps_sampled": 402100, "num_env_steps_trained": 402000, "num_agent_steps_sampled": 402100, "num_agent_steps_trained": 402000, "num_training_step_calls_since_last_synch_worker_weights": 68, "last_target_update_ts": 402100, "num_weight_broadcasts": 7976, "num_target_updates": 7976, "num_samples_added_to_queue": 402000}, "done": false, "episodes_total": 233, "training_iteration": 73, "trial_id": "304dd_00000", "date": "2023-12-11_01-59-45", "timestamp": 1702288785, "time_this_iter_s": 10.142203569412231, "time_total_s": 738.9888207912445, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 738.9888207912445, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 33.666666666666664, "ram_util_percent": 89.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 16456731.0, "policy_loss": 6285.6689453125, "entropy": 0.6029759049415588, "var_gnorm": 38.308048248291016, "vf_loss": 32900890.0, "vf_explained_var": 5.960464477539063e-08, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0000624656677246, "var_IS": 9.676152694737539e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 815.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 407950, "num_env_steps_trained": 407500, "num_agent_steps_sampled": 407950, "num_agent_steps_trained": 407500, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 407950, "num_weight_broadcasts": 8092, "num_target_updates": 8092, "num_samples_added_to_queue": 407500, "learner_queue": {"size_count": 815, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.583, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 854.75, "learner_dequeue_time_ms": 15028.332}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -580977.42, "episode_len_mean": 1526.9, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0], "episode_lengths": [3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39894104650520207, "mean_inference_ms": 1.068547160153441, "mean_action_processing_ms": 0.14788962439892564, "mean_env_wait_ms": 0.056498038673233754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036699771881103516, "StateBufferConnector_ms": 0.0034637451171875, "ViewRequirementAgentConnector_ms": 0.12459325790405273}}, "episode_reward_max": -34093.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -580977.42, "episode_len_mean": 1526.9, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0], "episode_lengths": [3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39894104650520207, "mean_inference_ms": 1.068547160153441, "mean_action_processing_ms": 0.14788962439892564, "mean_env_wait_ms": 0.056498038673233754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036699771881103516, "StateBufferConnector_ms": 0.0034637451171875, "ViewRequirementAgentConnector_ms": 0.12459325790405273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 1, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 407950, "num_agent_steps_trained": 407500, "num_env_steps_sampled": 407950, "num_env_steps_trained": 407500, "num_env_steps_sampled_this_iter": 5850, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 584.6654099503746, "num_env_steps_trained_throughput_per_sec": 549.6854281584718, "timesteps_total": 407950, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 407950, "timers": {"training_iteration_time_ms": 1.104, "sample_time_ms": 0.064, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 407950, "num_env_steps_trained": 407500, "num_agent_steps_sampled": 407950, "num_agent_steps_trained": 407500, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 407950, "num_weight_broadcasts": 8092, "num_target_updates": 8092, "num_samples_added_to_queue": 407500}, "done": false, "episodes_total": 241, "training_iteration": 74, "trial_id": "304dd_00000", "date": "2023-12-11_01-59-55", "timestamp": 1702288795, "time_this_iter_s": 10.086174488067627, "time_total_s": 749.0749952793121, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 749.0749952793121, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 34.17857142857143, "ram_util_percent": 89.36428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 21430610.0, "policy_loss": 7998.84619140625, "entropy": 0.47316479682922363, "var_gnorm": 38.33351516723633, "vf_loss": 42845224.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0000680685043335, "var_IS": 5.012331166653894e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 827.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 413750, "num_env_steps_trained": 413500, "num_agent_steps_sampled": 413750, "num_agent_steps_trained": 413500, "num_training_step_calls_since_last_synch_worker_weights": 10, "last_target_update_ts": 413750, "num_weight_broadcasts": 8208, "num_target_updates": 8208, "num_samples_added_to_queue": 413500, "learner_queue": {"size_count": 827, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.378, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 857.279, "learner_dequeue_time_ms": 15029.543}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -580977.42, "episode_len_mean": 1526.9, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0], "episode_lengths": [3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39894104650520207, "mean_inference_ms": 1.068547160153441, "mean_action_processing_ms": 0.14788962439892564, "mean_env_wait_ms": 0.056498038673233754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036699771881103516, "StateBufferConnector_ms": 0.0034637451171875, "ViewRequirementAgentConnector_ms": 0.12459325790405273}}, "episode_reward_max": -34093.0, "episode_reward_min": -2584205.0, "episode_reward_mean": -580977.42, "episode_len_mean": 1526.9, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1603039.0, -173083.0, -1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0], "episode_lengths": [3085, 318, 3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39894104650520207, "mean_inference_ms": 1.068547160153441, "mean_action_processing_ms": 0.14788962439892564, "mean_env_wait_ms": 0.056498038673233754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036699771881103516, "StateBufferConnector_ms": 0.0034637451171875, "ViewRequirementAgentConnector_ms": 0.12459325790405273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 413750, "num_agent_steps_trained": 413500, "num_env_steps_sampled": 413750, "num_env_steps_trained": 413500, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 579.9822588625402, "num_env_steps_trained_throughput_per_sec": 599.9816470991796, "timesteps_total": 413750, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 413750, "timers": {"training_iteration_time_ms": 0.258, "sample_time_ms": 0.098, "synch_weights_time_ms": 0.099}, "counters": {"num_env_steps_sampled": 413750, "num_env_steps_trained": 413500, "num_agent_steps_sampled": 413750, "num_agent_steps_trained": 413500, "num_training_step_calls_since_last_synch_worker_weights": 10, "last_target_update_ts": 413750, "num_weight_broadcasts": 8208, "num_target_updates": 8208, "num_samples_added_to_queue": 413500}, "done": false, "episodes_total": 241, "training_iteration": 75, "trial_id": "304dd_00000", "date": "2023-12-11_02-00-06", "timestamp": 1702288806, "time_this_iter_s": 10.147230386734009, "time_total_s": 759.2222256660461, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 759.2222256660461, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 33.800000000000004, "ram_util_percent": 89.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 15887659.0, "policy_loss": 6789.623046875, "entropy": 0.4674012362957001, "var_gnorm": 38.35129928588867, "vf_loss": 31761738.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0000174045562744, "var_IS": 7.887360698077828e-05, "model": {}, "grad_gnorm": [80.00000762939453]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 838.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 419450, "num_env_steps_trained": 419000, "num_agent_steps_sampled": 419450, "num_agent_steps_trained": 419000, "num_training_step_calls_since_last_synch_worker_weights": 200, "last_target_update_ts": 419450, "num_weight_broadcasts": 8321, "num_target_updates": 8321, "num_samples_added_to_queue": 419000, "learner_queue": {"size_count": 838, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.062, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 880.834, "learner_dequeue_time_ms": 14989.622}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -2728736.0, "episode_reward_mean": -604202.07, "episode_len_mean": 1606.73, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0], "episode_lengths": [3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988994639706048, "mean_inference_ms": 1.0683970928984758, "mean_action_processing_ms": 0.1478820929737552, "mean_env_wait_ms": 0.05647904916676362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036699771881103516, "StateBufferConnector_ms": 0.0034637451171875, "ViewRequirementAgentConnector_ms": 0.12252998352050781}}, "episode_reward_max": -34093.0, "episode_reward_min": -2728736.0, "episode_reward_mean": -604202.07, "episode_len_mean": 1606.73, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0], "episode_lengths": [3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988994639706048, "mean_inference_ms": 1.0683970928984758, "mean_action_processing_ms": 0.1478820929737552, "mean_env_wait_ms": 0.05647904916676362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036699771881103516, "StateBufferConnector_ms": 0.0034637451171875, "ViewRequirementAgentConnector_ms": 0.12252998352050781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 419450, "num_agent_steps_trained": 419000, "num_env_steps_sampled": 419450, "num_env_steps_trained": 419000, "num_env_steps_sampled_this_iter": 5700, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 569.9807709982166, "num_env_steps_trained_throughput_per_sec": 549.9814457000335, "timesteps_total": 419450, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 419450, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 419450, "num_env_steps_trained": 419000, "num_agent_steps_sampled": 419450, "num_agent_steps_trained": 419000, "num_training_step_calls_since_last_synch_worker_weights": 200, "last_target_update_ts": 419450, "num_weight_broadcasts": 8321, "num_target_updates": 8321, "num_samples_added_to_queue": 419000}, "done": false, "episodes_total": 243, "training_iteration": 76, "trial_id": "304dd_00000", "date": "2023-12-11_02-00-16", "timestamp": 1702288816, "time_this_iter_s": 10.126132488250732, "time_total_s": 769.3483581542969, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 769.3483581542969, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 32.98571428571428, "ram_util_percent": 89.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 95777464.0, "policy_loss": 16553.3046875, "entropy": 0.31827542185783386, "var_gnorm": 38.401939392089844, "vf_loss": 191521824.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9996865391731262, "var_IS": 4.760718729812652e-05, "model": {}, "grad_gnorm": [82.13468933105469]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 850.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 425150, "num_env_steps_trained": 425000, "num_agent_steps_sampled": 425150, "num_agent_steps_trained": 425000, "num_training_step_calls_since_last_synch_worker_weights": 210, "last_target_update_ts": 425150, "num_weight_broadcasts": 8434, "num_target_updates": 8434, "num_samples_added_to_queue": 425000, "learner_queue": {"size_count": 850, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.659, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 880.389, "learner_dequeue_time_ms": 14990.016}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -2728736.0, "episode_reward_mean": -604202.07, "episode_len_mean": 1606.73, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0], "episode_lengths": [3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988994639706048, "mean_inference_ms": 1.0683970928984758, "mean_action_processing_ms": 0.1478820929737552, "mean_env_wait_ms": 0.05647904916676362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036699771881103516, "StateBufferConnector_ms": 0.0034637451171875, "ViewRequirementAgentConnector_ms": 0.12252998352050781}}, "episode_reward_max": -34093.0, "episode_reward_min": -2728736.0, "episode_reward_mean": -604202.07, "episode_len_mean": 1606.73, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0], "episode_lengths": [3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988994639706048, "mean_inference_ms": 1.0683970928984758, "mean_action_processing_ms": 0.1478820929737552, "mean_env_wait_ms": 0.05647904916676362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036699771881103516, "StateBufferConnector_ms": 0.0034637451171875, "ViewRequirementAgentConnector_ms": 0.12252998352050781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 425150, "num_agent_steps_trained": 425000, "num_env_steps_sampled": 425150, "num_env_steps_trained": 425000, "num_env_steps_sampled_this_iter": 5700, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 569.993517710973, "num_env_steps_trained_throughput_per_sec": 599.9931765378664, "timesteps_total": 425150, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 425150, "timers": {"training_iteration_time_ms": 0.174, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 425150, "num_env_steps_trained": 425000, "num_agent_steps_sampled": 425150, "num_agent_steps_trained": 425000, "num_training_step_calls_since_last_synch_worker_weights": 210, "last_target_update_ts": 425150, "num_weight_broadcasts": 8434, "num_target_updates": 8434, "num_samples_added_to_queue": 425000}, "done": false, "episodes_total": 243, "training_iteration": 77, "trial_id": "304dd_00000", "date": "2023-12-11_02-00-26", "timestamp": 1702288826, "time_this_iter_s": 10.122271299362183, "time_total_s": 779.4706294536591, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 779.4706294536591, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 32.84285714285714, "ram_util_percent": 89.21428571428574}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 109866360.0, "policy_loss": 18506.080078125, "entropy": 0.21518059074878693, "var_gnorm": 38.500057220458984, "vf_loss": 219695712.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9997665286064148, "var_IS": 5.0105354603147134e-05, "model": {}, "grad_gnorm": [80.27745056152344]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 860.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 430000, "num_env_steps_trained": 430000, "num_agent_steps_sampled": 430000, "num_agent_steps_trained": 430000, "num_training_step_calls_since_last_synch_worker_weights": 217, "last_target_update_ts": 430000, "num_weight_broadcasts": 8530, "num_target_updates": 8530, "num_samples_added_to_queue": 430000, "learner_queue": {"size_count": 860, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.56, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 1030.649, "learner_dequeue_time_ms": 14990.016}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -2728736.0, "episode_reward_mean": -604202.07, "episode_len_mean": 1606.73, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0], "episode_lengths": [3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988994639706048, "mean_inference_ms": 1.0683970928984758, "mean_action_processing_ms": 0.1478820929737552, "mean_env_wait_ms": 0.05647904916676362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036699771881103516, "StateBufferConnector_ms": 0.0034637451171875, "ViewRequirementAgentConnector_ms": 0.12252998352050781}}, "episode_reward_max": -34093.0, "episode_reward_min": -2728736.0, "episode_reward_mean": -604202.07, "episode_len_mean": 1606.73, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1123933.0, -1012985.0, -118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0], "episode_lengths": [3267, 2934, 358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988994639706048, "mean_inference_ms": 1.0683970928984758, "mean_action_processing_ms": 0.1478820929737552, "mean_env_wait_ms": 0.05647904916676362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036699771881103516, "StateBufferConnector_ms": 0.0034637451171875, "ViewRequirementAgentConnector_ms": 0.12252998352050781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 430000, "num_agent_steps_trained": 430000, "num_env_steps_sampled": 430000, "num_env_steps_trained": 430000, "num_env_steps_sampled_this_iter": 4850, "num_env_steps_trained_this_iter": 5000, "num_env_steps_sampled_throughput_per_sec": 484.9712090895025, "num_env_steps_trained_throughput_per_sec": 499.97031864897167, "timesteps_total": 430000, "num_steps_trained_this_iter": 5000, "agent_timesteps_total": 430000, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.1}, "counters": {"num_env_steps_sampled": 430000, "num_env_steps_trained": 430000, "num_agent_steps_sampled": 430000, "num_agent_steps_trained": 430000, "num_training_step_calls_since_last_synch_worker_weights": 217, "last_target_update_ts": 430000, "num_weight_broadcasts": 8530, "num_target_updates": 8530, "num_samples_added_to_queue": 430000}, "done": false, "episodes_total": 243, "training_iteration": 78, "trial_id": "304dd_00000", "date": "2023-12-11_02-00-36", "timestamp": 1702288836, "time_this_iter_s": 10.150053977966309, "time_total_s": 789.6206834316254, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 789.6206834316254, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 39.519999999999996, "ram_util_percent": 89.68666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 52055772.0, "policy_loss": 11895.8486328125, "entropy": 0.21741153299808502, "var_gnorm": 38.572654724121094, "vf_loss": 104087752.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.000012993812561, "var_IS": 1.5728616062915535e-06, "model": {}, "grad_gnorm": [80.00035095214844]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 869.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 434850, "num_env_steps_trained": 434500, "num_agent_steps_sampled": 434850, "num_agent_steps_trained": 434500, "num_training_step_calls_since_last_synch_worker_weights": 302, "last_target_update_ts": 434850, "num_weight_broadcasts": 8626, "num_target_updates": 8626, "num_samples_added_to_queue": 434500, "learner_queue": {"size_count": 869, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.828, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 1052.097, "learner_dequeue_time_ms": 15007.373}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -687437.43, "episode_len_mean": 1697.35, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0], "episode_lengths": [358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988966246662965, "mean_inference_ms": 1.0683176296955985, "mean_action_processing_ms": 0.1478920122921597, "mean_env_wait_ms": 0.056466682189259244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036699771881103516, "StateBufferConnector_ms": 0.0034637451171875, "ViewRequirementAgentConnector_ms": 0.12132573127746582}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -687437.43, "episode_len_mean": 1697.35, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-118548.0, -374582.0, -518381.0, -1124173.0, -105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0], "episode_lengths": [358, 1058, 1436, 2493, 232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988966246662965, "mean_inference_ms": 1.0683176296955985, "mean_action_processing_ms": 0.1478920122921597, "mean_env_wait_ms": 0.056466682189259244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036699771881103516, "StateBufferConnector_ms": 0.0034637451171875, "ViewRequirementAgentConnector_ms": 0.12132573127746582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 434850, "num_agent_steps_trained": 434500, "num_env_steps_sampled": 434850, "num_env_steps_trained": 434500, "num_env_steps_sampled_this_iter": 4850, "num_env_steps_trained_this_iter": 4500, "num_env_steps_sampled_throughput_per_sec": 484.9612775965054, "num_env_steps_trained_throughput_per_sec": 449.9640719967576, "timesteps_total": 434850, "num_steps_trained_this_iter": 4500, "agent_timesteps_total": 434850, "timers": {"training_iteration_time_ms": 0.202, "sample_time_ms": 0.135, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 434850, "num_env_steps_trained": 434500, "num_agent_steps_sampled": 434850, "num_agent_steps_trained": 434500, "num_training_step_calls_since_last_synch_worker_weights": 302, "last_target_update_ts": 434850, "num_weight_broadcasts": 8626, "num_target_updates": 8626, "num_samples_added_to_queue": 434500}, "done": false, "episodes_total": 245, "training_iteration": 79, "trial_id": "304dd_00000", "date": "2023-12-11_02-00-46", "timestamp": 1702288846, "time_this_iter_s": 10.10045313835144, "time_total_s": 799.7211365699768, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 799.7211365699768, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 41.64999999999999, "ram_util_percent": 90.28571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 54911876.0, "policy_loss": 12611.26171875, "entropy": 0.4290829300880432, "var_gnorm": 38.6360969543457, "vf_loss": 109798528.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0001829862594604, "var_IS": 5.957894609309733e-05, "model": {}, "grad_gnorm": [80.00127410888672]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 881.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 440750, "num_env_steps_trained": 440500, "num_agent_steps_sampled": 440750, "num_agent_steps_trained": 440500, "num_training_step_calls_since_last_synch_worker_weights": 323, "last_target_update_ts": 440750, "num_weight_broadcasts": 8743, "num_target_updates": 8743, "num_samples_added_to_queue": 440500, "learner_queue": {"size_count": 881, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.792, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 845.126, "learner_dequeue_time_ms": 14897.24}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -705767.35, "episode_len_mean": 1712.28, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0], "episode_lengths": [232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988919542565805, "mean_inference_ms": 1.068151829508072, "mean_action_processing_ms": 0.14790732229405615, "mean_env_wait_ms": 0.05644114736166239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004362344741821289, "StateBufferConnector_ms": 0.00446319580078125, "ViewRequirementAgentConnector_ms": 0.12315988540649414}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -705767.35, "episode_len_mean": 1712.28, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105554.0, -71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0], "episode_lengths": [232, 172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988919542565805, "mean_inference_ms": 1.068151829508072, "mean_action_processing_ms": 0.14790732229405615, "mean_env_wait_ms": 0.05644114736166239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004362344741821289, "StateBufferConnector_ms": 0.00446319580078125, "ViewRequirementAgentConnector_ms": 0.12315988540649414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440750, "num_agent_steps_trained": 440500, "num_env_steps_sampled": 440750, "num_env_steps_trained": 440500, "num_env_steps_sampled_this_iter": 5900, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 589.9804057429981, "num_env_steps_trained_throughput_per_sec": 599.9800736369473, "timesteps_total": 440750, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 440750, "timers": {"training_iteration_time_ms": 0.176, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 440750, "num_env_steps_trained": 440500, "num_agent_steps_sampled": 440750, "num_agent_steps_trained": 440500, "num_training_step_calls_since_last_synch_worker_weights": 323, "last_target_update_ts": 440750, "num_weight_broadcasts": 8743, "num_target_updates": 8743, "num_samples_added_to_queue": 440500}, "done": false, "episodes_total": 249, "training_iteration": 80, "trial_id": "304dd_00000", "date": "2023-12-11_02-00-57", "timestamp": 1702288857, "time_this_iter_s": 10.097787380218506, "time_total_s": 809.8189239501953, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 809.8189239501953, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 33.66428571428572, "ram_util_percent": 90.45000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 27732394.0, "policy_loss": 9254.6298828125, "entropy": 0.4432566463947296, "var_gnorm": 38.677452087402344, "vf_loss": 55446280.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0001499652862549, "var_IS": 4.0020302549237385e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 893.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 446600, "num_env_steps_trained": 446500, "num_agent_steps_sampled": 446600, "num_agent_steps_trained": 446500, "num_training_step_calls_since_last_synch_worker_weights": 292, "last_target_update_ts": 446600, "num_weight_broadcasts": 8859, "num_target_updates": 8859, "num_samples_added_to_queue": 446500, "learner_queue": {"size_count": 893, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.157, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 851.452, "learner_dequeue_time_ms": 14897.24}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -710500.03, "episode_len_mean": 1722.85, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0], "episode_lengths": [172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988884903056936, "mean_inference_ms": 1.0681102505861473, "mean_action_processing_ms": 0.14790936520846876, "mean_env_wait_ms": 0.05643413579094716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004362344741821289, "StateBufferConnector_ms": 0.00446319580078125, "ViewRequirementAgentConnector_ms": 0.12122035026550293}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -710500.03, "episode_len_mean": 1722.85, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-71269.0, -888895.0, -472491.0, -131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0], "episode_lengths": [172, 2486, 1537, 407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988884903056936, "mean_inference_ms": 1.0681102505861473, "mean_action_processing_ms": 0.14790936520846876, "mean_env_wait_ms": 0.05643413579094716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004362344741821289, "StateBufferConnector_ms": 0.00446319580078125, "ViewRequirementAgentConnector_ms": 0.12122035026550293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 446600, "num_agent_steps_trained": 446500, "num_env_steps_sampled": 446600, "num_env_steps_trained": 446500, "num_env_steps_sampled_this_iter": 5850, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 584.9919663578838, "num_env_steps_trained_throughput_per_sec": 599.9917603670604, "timesteps_total": 446600, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 446600, "timers": {"training_iteration_time_ms": 0.184, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 446600, "num_env_steps_trained": 446500, "num_agent_steps_sampled": 446600, "num_agent_steps_trained": 446500, "num_training_step_calls_since_last_synch_worker_weights": 292, "last_target_update_ts": 446600, "num_weight_broadcasts": 8859, "num_target_updates": 8859, "num_samples_added_to_queue": 446500}, "done": false, "episodes_total": 250, "training_iteration": 81, "trial_id": "304dd_00000", "date": "2023-12-11_02-01-07", "timestamp": 1702288867, "time_this_iter_s": 10.104368448257446, "time_total_s": 819.9232923984528, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 819.9232923984528, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 33.91428571428571, "ram_util_percent": 90.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 23544988.0, "policy_loss": 7586.427734375, "entropy": 0.3360137939453125, "var_gnorm": 38.70071029663086, "vf_loss": 47074804.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9998552203178406, "var_IS": 3.536788426572457e-05, "model": {}, "grad_gnorm": [80.00163269042969]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 904.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 452400, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452400, "num_agent_steps_trained": 452000, "num_training_step_calls_since_last_synch_worker_weights": 206, "last_target_update_ts": 452400, "num_weight_broadcasts": 8974, "num_target_updates": 8974, "num_samples_added_to_queue": 452000, "learner_queue": {"size_count": 904, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 10.976, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 862.539, "learner_dequeue_time_ms": 14759.256}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -730033.29, "episode_len_mean": 1770.92, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0], "episode_lengths": [407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988678222784868, "mean_inference_ms": 1.0679701951322214, "mean_action_processing_ms": 0.14791041868622895, "mean_env_wait_ms": 0.05641221585296385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004755496978759766, "StateBufferConnector_ms": 0.00446319580078125, "ViewRequirementAgentConnector_ms": 0.12393355369567871}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -730033.29, "episode_len_mean": 1770.92, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-131931.0, -117357.0, -2076775.0, -822675.0, -224902.0, -1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0], "episode_lengths": [407, 410, 4570, 2470, 679, 3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988678222784868, "mean_inference_ms": 1.0679701951322214, "mean_action_processing_ms": 0.14791041868622895, "mean_env_wait_ms": 0.05641221585296385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004755496978759766, "StateBufferConnector_ms": 0.00446319580078125, "ViewRequirementAgentConnector_ms": 0.12393355369567871}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 452400, "num_agent_steps_trained": 452000, "num_env_steps_sampled": 452400, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 579.9892556273551, "num_env_steps_trained_throughput_per_sec": 549.9898113707677, "timesteps_total": 452400, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 452400, "timers": {"training_iteration_time_ms": 0.199, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.099}, "counters": {"num_env_steps_sampled": 452400, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452400, "num_agent_steps_trained": 452000, "num_training_step_calls_since_last_synch_worker_weights": 206, "last_target_update_ts": 452400, "num_weight_broadcasts": 8974, "num_target_updates": 8974, "num_samples_added_to_queue": 452000}, "done": false, "episodes_total": 253, "training_iteration": 82, "trial_id": "304dd_00000", "date": "2023-12-11_02-01-17", "timestamp": 1702288877, "time_this_iter_s": 10.12151837348938, "time_total_s": 830.0448107719421, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 830.0448107719421, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 33.18571428571428, "ram_util_percent": 90.05714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 26622414.0, "policy_loss": 8617.9482421875, "entropy": 0.3532133996486664, "var_gnorm": 38.727962493896484, "vf_loss": 53227592.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0000582933425903, "var_IS": 5.060203420725884e-06, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 916.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 458300, "num_env_steps_trained": 458000, "num_agent_steps_sampled": 458300, "num_agent_steps_trained": 458000, "num_training_step_calls_since_last_synch_worker_weights": 173, "last_target_update_ts": 458300, "num_weight_broadcasts": 9091, "num_target_updates": 9091, "num_samples_added_to_queue": 458000, "learner_queue": {"size_count": 916, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.517, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 844.494, "learner_dequeue_time_ms": 14598.979}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -728425.58, "episode_len_mean": 1760.64, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0], "episode_lengths": [3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39883902217254713, "mean_inference_ms": 1.067741889631665, "mean_action_processing_ms": 0.14791759445261435, "mean_env_wait_ms": 0.056379481053886044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004755496978759766, "StateBufferConnector_ms": 0.005062580108642578, "ViewRequirementAgentConnector_ms": 0.12219023704528809}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -728425.58, "episode_len_mean": 1760.64, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1414025.0, -495228.0, -998128.0, -321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0], "episode_lengths": [3940, 1580, 2610, 965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39883902217254713, "mean_inference_ms": 1.067741889631665, "mean_action_processing_ms": 0.14791759445261435, "mean_env_wait_ms": 0.056379481053886044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004755496978759766, "StateBufferConnector_ms": 0.005062580108642578, "ViewRequirementAgentConnector_ms": 0.12219023704528809}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 458300, "num_agent_steps_trained": 458000, "num_env_steps_sampled": 458300, "num_env_steps_trained": 458000, "num_env_steps_sampled_this_iter": 5900, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 589.9522052384997, "num_env_steps_trained_throughput_per_sec": 599.9513951577962, "timesteps_total": 458300, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 458300, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.021, "synch_weights_time_ms": 0.018}, "counters": {"num_env_steps_sampled": 458300, "num_env_steps_trained": 458000, "num_agent_steps_sampled": 458300, "num_agent_steps_trained": 458000, "num_training_step_calls_since_last_synch_worker_weights": 173, "last_target_update_ts": 458300, "num_weight_broadcasts": 9091, "num_target_updates": 9091, "num_samples_added_to_queue": 458000}, "done": false, "episodes_total": 258, "training_iteration": 83, "trial_id": "304dd_00000", "date": "2023-12-11_02-01-27", "timestamp": 1702288887, "time_this_iter_s": 10.126672506332397, "time_total_s": 840.1714832782745, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 840.1714832782745, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 31.95, "ram_util_percent": 90.07142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 96093384.0, "policy_loss": 17395.888671875, "entropy": 0.3971024751663208, "var_gnorm": 38.751583099365234, "vf_loss": 192151984.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0000258684158325, "var_IS": 4.422691563377157e-05, "model": {}, "grad_gnorm": [80.0422592163086]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 928.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 464100, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464100, "num_agent_steps_trained": 464000, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 464100, "num_weight_broadcasts": 9206, "num_target_updates": 9206, "num_samples_added_to_queue": 464000, "learner_queue": {"size_count": 928, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.294, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 863.593, "learner_dequeue_time_ms": 14598.979}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -716867.28, "episode_len_mean": 1731.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0], "episode_lengths": [965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39883309119245497, "mean_inference_ms": 1.0676383672221015, "mean_action_processing_ms": 0.14793075128273173, "mean_env_wait_ms": 0.05636399272204267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004755496978759766, "StateBufferConnector_ms": 0.005062580108642578, "ViewRequirementAgentConnector_ms": 0.12173128128051758}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -716867.28, "episode_len_mean": 1731.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-321547.0, -1693223.0, -255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0], "episode_lengths": [965, 3794, 442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39883309119245497, "mean_inference_ms": 1.0676383672221015, "mean_action_processing_ms": 0.14793075128273173, "mean_env_wait_ms": 0.05636399272204267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004755496978759766, "StateBufferConnector_ms": 0.005062580108642578, "ViewRequirementAgentConnector_ms": 0.12173128128051758}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 1, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464100, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 464100, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 579.8873352552654, "num_env_steps_trained_throughput_per_sec": 599.8834502640676, "timesteps_total": 464100, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 464100, "timers": {"training_iteration_time_ms": 1.103, "sample_time_ms": 0.046, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 464100, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464100, "num_agent_steps_trained": 464000, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 464100, "num_weight_broadcasts": 9206, "num_target_updates": 9206, "num_samples_added_to_queue": 464000}, "done": false, "episodes_total": 261, "training_iteration": 84, "trial_id": "304dd_00000", "date": "2023-12-11_02-01-37", "timestamp": 1702288897, "time_this_iter_s": 10.08328104019165, "time_total_s": 850.2547643184662, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 850.2547643184662, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 33.22666666666667, "ram_util_percent": 89.92000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 27808960.0, "policy_loss": 7535.97998046875, "entropy": 0.43133947253227234, "var_gnorm": 38.77415466308594, "vf_loss": 55602848.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0000510215759277, "var_IS": 5.1683477067854255e-05, "model": {}, "grad_gnorm": [80.00679016113281]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 939.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 469900, "num_env_steps_trained": 469500, "num_agent_steps_sampled": 469900, "num_agent_steps_trained": 469500, "num_training_step_calls_since_last_synch_worker_weights": 313, "last_target_update_ts": 469900, "num_weight_broadcasts": 9322, "num_target_updates": 9322, "num_samples_added_to_queue": 469500, "learner_queue": {"size_count": 939, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.765, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 850.521, "learner_dequeue_time_ms": 14453.713}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -721037.23, "episode_len_mean": 1736.96, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0], "episode_lengths": [442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39882756306773387, "mean_inference_ms": 1.0675676389565316, "mean_action_processing_ms": 0.14793799612894198, "mean_env_wait_ms": 0.056354228196957214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004755496978759766, "StateBufferConnector_ms": 0.005062580108642578, "ViewRequirementAgentConnector_ms": 0.12134885787963867}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -721037.23, "episode_len_mean": 1736.96, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-255950.0, -891319.0, -1013522.0, -294930.0, -420616.0, -348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0], "episode_lengths": [442, 2851, 3175, 756, 1268, 976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39882756306773387, "mean_inference_ms": 1.0675676389565316, "mean_action_processing_ms": 0.14793799612894198, "mean_env_wait_ms": 0.056354228196957214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004755496978759766, "StateBufferConnector_ms": 0.005062580108642578, "ViewRequirementAgentConnector_ms": 0.12134885787963867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 469900, "num_agent_steps_trained": 469500, "num_env_steps_sampled": 469900, "num_env_steps_trained": 469500, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 579.9450101541189, "num_env_steps_trained_throughput_per_sec": 549.9478544564921, "timesteps_total": 469900, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 469900, "timers": {"training_iteration_time_ms": 0.157, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 469900, "num_env_steps_trained": 469500, "num_agent_steps_sampled": 469900, "num_agent_steps_trained": 469500, "num_training_step_calls_since_last_synch_worker_weights": 313, "last_target_update_ts": 469900, "num_weight_broadcasts": 9322, "num_target_updates": 9322, "num_samples_added_to_queue": 469500}, "done": false, "episodes_total": 263, "training_iteration": 85, "trial_id": "304dd_00000", "date": "2023-12-11_02-01-47", "timestamp": 1702288907, "time_this_iter_s": 10.093010187149048, "time_total_s": 860.3477745056152, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 860.3477745056152, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 33.82142857142857, "ram_util_percent": 89.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 26453434.0, "policy_loss": 7624.59619140625, "entropy": 0.6633265018463135, "var_gnorm": 38.7966194152832, "vf_loss": 52891620.0, "vf_explained_var": 5.960464477539063e-08, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.000011920928955, "var_IS": 7.09879823261872e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 951.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 475800, "num_env_steps_trained": 475500, "num_agent_steps_sampled": 475800, "num_agent_steps_trained": 475500, "num_training_step_calls_since_last_synch_worker_weights": 9, "last_target_update_ts": 475800, "num_weight_broadcasts": 9439, "num_target_updates": 9439, "num_samples_added_to_queue": 475500, "learner_queue": {"size_count": 951, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.696, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 844.67, "learner_dequeue_time_ms": 14359.718}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -712903.13, "episode_len_mean": 1716.05, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0], "episode_lengths": [976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988157708621502, "mean_inference_ms": 1.0673659365777999, "mean_action_processing_ms": 0.14796049954666912, "mean_env_wait_ms": 0.056332732989918755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004755496978759766, "StateBufferConnector_ms": 0.0055844783782958984, "ViewRequirementAgentConnector_ms": 0.11989974975585938}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -712903.13, "episode_len_mean": 1716.05, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-348609.0, -249238.0, -894077.0, -475478.0, -718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0], "episode_lengths": [976, 676, 2831, 1352, 1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988157708621502, "mean_inference_ms": 1.0673659365777999, "mean_action_processing_ms": 0.14796049954666912, "mean_env_wait_ms": 0.056332732989918755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004755496978759766, "StateBufferConnector_ms": 0.0055844783782958984, "ViewRequirementAgentConnector_ms": 0.11989974975585938}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 475800, "num_agent_steps_trained": 475500, "num_env_steps_sampled": 475800, "num_env_steps_trained": 475500, "num_env_steps_sampled_this_iter": 5900, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 589.958998430242, "num_env_steps_trained_throughput_per_sec": 599.9583034883816, "timesteps_total": 475800, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 475800, "timers": {"training_iteration_time_ms": 1.132, "sample_time_ms": 0.218, "synch_weights_time_ms": 0.613}, "counters": {"num_env_steps_sampled": 475800, "num_env_steps_trained": 475500, "num_agent_steps_sampled": 475800, "num_agent_steps_trained": 475500, "num_training_step_calls_since_last_synch_worker_weights": 9, "last_target_update_ts": 475800, "num_weight_broadcasts": 9439, "num_target_updates": 9439, "num_samples_added_to_queue": 475500}, "done": false, "episodes_total": 268, "training_iteration": 86, "trial_id": "304dd_00000", "date": "2023-12-11_02-01-58", "timestamp": 1702288918, "time_this_iter_s": 10.145700216293335, "time_total_s": 870.4934747219086, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 870.4934747219086, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 33.635714285714286, "ram_util_percent": 89.90714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 60625720.0, "policy_loss": 12619.43359375, "entropy": 0.930854856967926, "var_gnorm": 38.819244384765625, "vf_loss": 121226200.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0009263753890991, "var_IS": 0.00012308081204537302, "model": {}, "grad_gnorm": [80.21773529052734]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 963.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 481700, "num_env_steps_trained": 481500, "num_agent_steps_sampled": 481700, "num_agent_steps_trained": 481500, "num_training_step_calls_since_last_synch_worker_weights": 215, "last_target_update_ts": 481700, "num_weight_broadcasts": 9556, "num_target_updates": 9556, "num_samples_added_to_queue": 481500, "learner_queue": {"size_count": 963, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.479, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 843.533, "learner_dequeue_time_ms": 14334.128}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -713427.18, "episode_len_mean": 1710.97, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0], "episode_lengths": [1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39881225595833064, "mean_inference_ms": 1.0672105244705654, "mean_action_processing_ms": 0.1479789725047572, "mean_env_wait_ms": 0.05632014862169475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005128383636474609, "StateBufferConnector_ms": 0.00458526611328125, "ViewRequirementAgentConnector_ms": 0.12386584281921387}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -713427.18, "episode_len_mean": 1710.97, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-718326.0, -1082478.0, -264316.0, -1273652.0, -74490.0, -40644.0, -2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0], "episode_lengths": [1972, 3089, 564, 3824, 191, 119, 7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39881225595833064, "mean_inference_ms": 1.0672105244705654, "mean_action_processing_ms": 0.1479789725047572, "mean_env_wait_ms": 0.05632014862169475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005128383636474609, "StateBufferConnector_ms": 0.00458526611328125, "ViewRequirementAgentConnector_ms": 0.12386584281921387}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 481700, "num_agent_steps_trained": 481500, "num_env_steps_sampled": 481700, "num_env_steps_trained": 481500, "num_env_steps_sampled_this_iter": 5900, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 589.9878184926316, "num_env_steps_trained_throughput_per_sec": 599.987612026405, "timesteps_total": 481700, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 481700, "timers": {"training_iteration_time_ms": 0.201, "sample_time_ms": 0.101, "synch_weights_time_ms": 0.1}, "counters": {"num_env_steps_sampled": 481700, "num_env_steps_trained": 481500, "num_agent_steps_sampled": 481700, "num_agent_steps_trained": 481500, "num_training_step_calls_since_last_synch_worker_weights": 215, "last_target_update_ts": 481700, "num_weight_broadcasts": 9556, "num_target_updates": 9556, "num_samples_added_to_queue": 481500}, "done": false, "episodes_total": 272, "training_iteration": 87, "trial_id": "304dd_00000", "date": "2023-12-11_02-02-08", "timestamp": 1702288928, "time_this_iter_s": 10.123123407363892, "time_total_s": 880.6165981292725, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 880.6165981292725, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 32.614285714285714, "ram_util_percent": 89.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 20372254.0, "policy_loss": 7696.19677734375, "entropy": 1.06927490234375, "var_gnorm": 38.8521614074707, "vf_loss": 40729116.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9988082647323608, "var_IS": 0.0006324524874798954, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 975.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 487500, "num_env_steps_trained": 487500, "num_agent_steps_sampled": 487500, "num_agent_steps_trained": 487500, "num_training_step_calls_since_last_synch_worker_weights": 21, "last_target_update_ts": 487500, "num_weight_broadcasts": 9671, "num_target_updates": 9671, "num_samples_added_to_queue": 487500, "learner_queue": {"size_count": 975, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.207, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 862.827, "learner_dequeue_time_ms": 14334.128}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -708817.76, "episode_len_mean": 1681.68, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0], "episode_lengths": [7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.398832315347749, "mean_inference_ms": 1.0670305958917299, "mean_action_processing_ms": 0.14800508408184554, "mean_env_wait_ms": 0.056302801134071254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006139278411865234, "StateBufferConnector_ms": 0.003558635711669922, "ViewRequirementAgentConnector_ms": 0.12764787673950195}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -708817.76, "episode_len_mean": 1681.68, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2584205.0, -128201.0, -813821.0, -272801.0, -207723.0, -126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0], "episode_lengths": [7465, 309, 2513, 858, 659, 330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.398832315347749, "mean_inference_ms": 1.0670305958917299, "mean_action_processing_ms": 0.14800508408184554, "mean_env_wait_ms": 0.056302801134071254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006139278411865234, "StateBufferConnector_ms": 0.003558635711669922, "ViewRequirementAgentConnector_ms": 0.12764787673950195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 487500, "num_agent_steps_trained": 487500, "num_env_steps_sampled": 487500, "num_env_steps_trained": 487500, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 579.9886195508507, "num_env_steps_trained_throughput_per_sec": 599.9882271215696, "timesteps_total": 487500, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 487500, "timers": {"training_iteration_time_ms": 0.213, "sample_time_ms": 0.099, "synch_weights_time_ms": 0.099}, "counters": {"num_env_steps_sampled": 487500, "num_env_steps_trained": 487500, "num_agent_steps_sampled": 487500, "num_agent_steps_trained": 487500, "num_training_step_calls_since_last_synch_worker_weights": 21, "last_target_update_ts": 487500, "num_weight_broadcasts": 9671, "num_target_updates": 9671, "num_samples_added_to_queue": 487500}, "done": false, "episodes_total": 278, "training_iteration": 88, "trial_id": "304dd_00000", "date": "2023-12-11_02-02-18", "timestamp": 1702288938, "time_this_iter_s": 10.144769430160522, "time_total_s": 890.761367559433, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 890.761367559433, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 34.864285714285714, "ram_util_percent": 90.02857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 16922028.0, "policy_loss": 6784.18408203125, "entropy": 1.0755730867385864, "var_gnorm": 38.87664794921875, "vf_loss": 33830488.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0002062320709229, "var_IS": 0.00013518899504560977, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 986.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 493400, "num_env_steps_trained": 493000, "num_agent_steps_sampled": 493400, "num_agent_steps_trained": 493000, "num_training_step_calls_since_last_synch_worker_weights": 11, "last_target_update_ts": 493400, "num_weight_broadcasts": 9788, "num_target_updates": 9788, "num_samples_added_to_queue": 493000, "learner_queue": {"size_count": 986, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.971, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 850.301, "learner_dequeue_time_ms": 14319.32}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -689908.27, "episode_len_mean": 1619.44, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0], "episode_lengths": [330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988561594699963, "mean_inference_ms": 1.066892752608028, "mean_action_processing_ms": 0.14802632614035083, "mean_env_wait_ms": 0.05628772584426622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00513458251953125, "StateBufferConnector_ms": 0.003558635711669922, "ViewRequirementAgentConnector_ms": 0.12755131721496582}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -689908.27, "episode_len_mean": 1619.44, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-126425.0, -1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0], "episode_lengths": [330, 5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988561594699963, "mean_inference_ms": 1.066892752608028, "mean_action_processing_ms": 0.14802632614035083, "mean_env_wait_ms": 0.05628772584426622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00513458251953125, "StateBufferConnector_ms": 0.003558635711669922, "ViewRequirementAgentConnector_ms": 0.12755131721496582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 493400, "num_agent_steps_trained": 493000, "num_env_steps_sampled": 493400, "num_env_steps_trained": 493000, "num_env_steps_sampled_this_iter": 5900, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 589.9515442116306, "num_env_steps_trained_throughput_per_sec": 549.9548293498251, "timesteps_total": 493400, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 493400, "timers": {"training_iteration_time_ms": 0.0, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 493400, "num_env_steps_trained": 493000, "num_agent_steps_sampled": 493400, "num_agent_steps_trained": 493000, "num_training_step_calls_since_last_synch_worker_weights": 11, "last_target_update_ts": 493400, "num_weight_broadcasts": 9788, "num_target_updates": 9788, "num_samples_added_to_queue": 493000}, "done": false, "episodes_total": 283, "training_iteration": 89, "trial_id": "304dd_00000", "date": "2023-12-11_02-02-28", "timestamp": 1702288948, "time_this_iter_s": 10.14778470993042, "time_total_s": 900.9091522693634, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 900.9091522693634, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 33.379999999999995, "ram_util_percent": 90.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 14574817.0, "policy_loss": 6386.72314453125, "entropy": 1.0043621063232422, "var_gnorm": 38.90123748779297, "vf_loss": 29136860.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0002442598342896, "var_IS": 0.00019028452516067773, "model": {}, "grad_gnorm": [80.00000762939453]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 998.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 499100, "num_env_steps_trained": 499000, "num_agent_steps_sampled": 499100, "num_agent_steps_trained": 499000, "num_training_step_calls_since_last_synch_worker_weights": 134, "last_target_update_ts": 499100, "num_weight_broadcasts": 9901, "num_target_updates": 9901, "num_samples_added_to_queue": 499000, "learner_queue": {"size_count": 998, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.398, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 881.469, "learner_dequeue_time_ms": 14317.66}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -700502.12, "episode_len_mean": 1651.72, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0], "episode_lengths": [5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39885857706128947, "mean_inference_ms": 1.066863834506201, "mean_action_processing_ms": 0.1480286714707531, "mean_env_wait_ms": 0.056284188825135806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00513458251953125, "StateBufferConnector_ms": 0.003558635711669922, "ViewRequirementAgentConnector_ms": 0.12715387344360352}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -700502.12, "episode_len_mean": 1651.72, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1915282.0, -253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0], "episode_lengths": [5253, 670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39885857706128947, "mean_inference_ms": 1.066863834506201, "mean_action_processing_ms": 0.1480286714707531, "mean_env_wait_ms": 0.056284188825135806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00513458251953125, "StateBufferConnector_ms": 0.003558635711669922, "ViewRequirementAgentConnector_ms": 0.12715387344360352}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 499100, "num_agent_steps_trained": 499000, "num_env_steps_sampled": 499100, "num_env_steps_trained": 499000, "num_env_steps_sampled_this_iter": 5700, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 569.9489067104046, "num_env_steps_trained_throughput_per_sec": 599.9462175898996, "timesteps_total": 499100, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 499100, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 499100, "num_env_steps_trained": 499000, "num_agent_steps_sampled": 499100, "num_agent_steps_trained": 499000, "num_training_step_calls_since_last_synch_worker_weights": 134, "last_target_update_ts": 499100, "num_weight_broadcasts": 9901, "num_target_updates": 9901, "num_samples_added_to_queue": 499000}, "done": false, "episodes_total": 284, "training_iteration": 90, "trial_id": "304dd_00000", "date": "2023-12-11_02-02-38", "timestamp": 1702288958, "time_this_iter_s": 10.12491226196289, "time_total_s": 911.0340645313263, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 911.0340645313263, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 35.15714285714286, "ram_util_percent": 90.1857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 18065960.0, "policy_loss": 7426.49755859375, "entropy": 0.8775450587272644, "var_gnorm": 38.92416000366211, "vf_loss": 36117068.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9999309778213501, "var_IS": 4.565717972582206e-05, "model": {}, "grad_gnorm": [80.00000762939453]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 1009.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 504750, "num_env_steps_trained": 504500, "num_agent_steps_sampled": 504750, "num_agent_steps_trained": 504500, "num_training_step_calls_since_last_synch_worker_weights": 68, "last_target_update_ts": 504750, "num_weight_broadcasts": 10013, "num_target_updates": 10013, "num_samples_added_to_queue": 504500, "learner_queue": {"size_count": 1009, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.561, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 888.014, "learner_dequeue_time_ms": 14328.181}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -694324.69, "episode_len_mean": 1633.38, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0], "episode_lengths": [670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988636860966419, "mean_inference_ms": 1.066841415796972, "mean_action_processing_ms": 0.1480315344459022, "mean_env_wait_ms": 0.056281770228676704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004777431488037109, "StateBufferConnector_ms": 0.003558635711669922, "ViewRequirementAgentConnector_ms": 0.12715387344360352}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -694324.69, "episode_len_mean": 1633.38, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-253642.0, -253222.0, -91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0], "episode_lengths": [670, 398, 231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988636860966419, "mean_inference_ms": 1.066841415796972, "mean_action_processing_ms": 0.1480315344459022, "mean_env_wait_ms": 0.056281770228676704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004777431488037109, "StateBufferConnector_ms": 0.003558635711669922, "ViewRequirementAgentConnector_ms": 0.12715387344360352}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504750, "num_agent_steps_trained": 504500, "num_env_steps_sampled": 504750, "num_env_steps_trained": 504500, "num_env_steps_sampled_this_iter": 5650, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 564.9462302839447, "num_env_steps_trained_throughput_per_sec": 549.9476577985303, "timesteps_total": 504750, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 504750, "timers": {"training_iteration_time_ms": 0.16, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 504750, "num_env_steps_trained": 504500, "num_agent_steps_sampled": 504750, "num_agent_steps_trained": 504500, "num_training_step_calls_since_last_synch_worker_weights": 68, "last_target_update_ts": 504750, "num_weight_broadcasts": 10013, "num_target_updates": 10013, "num_samples_added_to_queue": 504500}, "done": false, "episodes_total": 285, "training_iteration": 91, "trial_id": "304dd_00000", "date": "2023-12-11_02-02-49", "timestamp": 1702288969, "time_this_iter_s": 10.13520073890686, "time_total_s": 921.1692652702332, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 921.1692652702332, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 33.77142857142858, "ram_util_percent": 90.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 60566540.0, "policy_loss": 12505.6708984375, "entropy": 0.8655605316162109, "var_gnorm": 38.94962692260742, "vf_loss": 121108072.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.000324010848999, "var_IS": 5.690108082490042e-05, "model": {}, "grad_gnorm": [80.14534759521484]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 1021.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 510650, "num_env_steps_trained": 510500, "num_agent_steps_sampled": 510650, "num_agent_steps_trained": 510500, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 510650, "num_weight_broadcasts": 10130, "num_target_updates": 10130, "num_samples_added_to_queue": 510500, "learner_queue": {"size_count": 1021, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 12.091, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 850.271, "learner_dequeue_time_ms": 14328.181}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -722093.68, "episode_len_mean": 1713.02, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0], "episode_lengths": [231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988681059446688, "mean_inference_ms": 1.06678300383016, "mean_action_processing_ms": 0.14803556536467558, "mean_env_wait_ms": 0.05627585589156045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004777431488037109, "StateBufferConnector_ms": 0.003558635711669922, "ViewRequirementAgentConnector_ms": 0.13008856773376465}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -722093.68, "episode_len_mean": 1713.02, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-91666.0, -141013.0, -889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0], "episode_lengths": [231, 457, 2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988681059446688, "mean_inference_ms": 1.06678300383016, "mean_action_processing_ms": 0.14803556536467558, "mean_env_wait_ms": 0.05627585589156045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004777431488037109, "StateBufferConnector_ms": 0.003558635711669922, "ViewRequirementAgentConnector_ms": 0.13008856773376465}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 1, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 510650, "num_agent_steps_trained": 510500, "num_env_steps_sampled": 510650, "num_env_steps_trained": 510500, "num_env_steps_sampled_this_iter": 5900, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 589.6393816609772, "num_env_steps_trained_throughput_per_sec": 599.6332694857396, "timesteps_total": 510650, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 510650, "timers": {"training_iteration_time_ms": 1.0, "sample_time_ms": 0.065, "synch_weights_time_ms": 0.598}, "counters": {"num_env_steps_sampled": 510650, "num_env_steps_trained": 510500, "num_agent_steps_sampled": 510650, "num_agent_steps_trained": 510500, "num_training_step_calls_since_last_synch_worker_weights": 0, "last_target_update_ts": 510650, "num_weight_broadcasts": 10130, "num_target_updates": 10130, "num_samples_added_to_queue": 510500}, "done": false, "episodes_total": 287, "training_iteration": 92, "trial_id": "304dd_00000", "date": "2023-12-11_02-02-59", "timestamp": 1702288979, "time_this_iter_s": 10.083116054534912, "time_total_s": 931.2523813247681, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 931.2523813247681, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 33.19285714285714, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 21394926.0, "policy_loss": 8104.68701171875, "entropy": 0.8842347860336304, "var_gnorm": 38.984371185302734, "vf_loss": 42773644.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9997267127037048, "var_IS": 3.950250174966641e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 1032.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 516400, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516400, "num_agent_steps_trained": 516000, "num_training_step_calls_since_last_synch_worker_weights": 46, "last_target_update_ts": 516400, "num_weight_broadcasts": 10245, "num_target_updates": 10245, "num_samples_added_to_queue": 516000, "learner_queue": {"size_count": 1032, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.1, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 862.697, "learner_dequeue_time_ms": 14060.806}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -737140.29, "episode_len_mean": 1744.6, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0, -1130269.0, -607071.0], "episode_lengths": [2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127, 2132, 1714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988671699321243, "mean_inference_ms": 1.0667223951555054, "mean_action_processing_ms": 0.14803852720951716, "mean_env_wait_ms": 0.056271812136901564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004777431488037109, "StateBufferConnector_ms": 0.003558635711669922, "ViewRequirementAgentConnector_ms": 0.12855291366577148}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -737140.29, "episode_len_mean": 1744.6, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-889193.0, -226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0, -1130269.0, -607071.0], "episode_lengths": [2672, 629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127, 2132, 1714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988671699321243, "mean_inference_ms": 1.0667223951555054, "mean_action_processing_ms": 0.14803852720951716, "mean_env_wait_ms": 0.056271812136901564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004777431488037109, "StateBufferConnector_ms": 0.003558635711669922, "ViewRequirementAgentConnector_ms": 0.12855291366577148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516400, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516400, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 5750, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 574.9428936935633, "num_env_steps_trained_throughput_per_sec": 549.9453765764518, "timesteps_total": 516400, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 516400, "timers": {"training_iteration_time_ms": 0.1, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 516400, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516400, "num_agent_steps_trained": 516000, "num_training_step_calls_since_last_synch_worker_weights": 46, "last_target_update_ts": 516400, "num_weight_broadcasts": 10245, "num_target_updates": 10245, "num_samples_added_to_queue": 516000}, "done": false, "episodes_total": 289, "training_iteration": 93, "trial_id": "304dd_00000", "date": "2023-12-11_02-03-09", "timestamp": 1702288989, "time_this_iter_s": 10.147518873214722, "time_total_s": 941.3999001979828, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 941.3999001979828, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 34.392857142857146, "ram_util_percent": 90.49285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 19091398.0, "policy_loss": 6805.15234375, "entropy": 0.9291727542877197, "var_gnorm": 39.013851165771484, "vf_loss": 38169184.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9997554421424866, "var_IS": 0.00012130017421441153, "model": {}, "grad_gnorm": [80.0028305053711]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 1044.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 522250, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522250, "num_agent_steps_trained": 522000, "num_training_step_calls_since_last_synch_worker_weights": 218, "last_target_update_ts": 522250, "num_weight_broadcasts": 10361, "num_target_updates": 10361, "num_samples_added_to_queue": 522000, "learner_queue": {"size_count": 1044, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.471, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 852.666, "learner_dequeue_time_ms": 13996.718}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -743854.42, "episode_len_mean": 1760.12, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0, -1130269.0, -607071.0, -1560606.0], "episode_lengths": [629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127, 2132, 1714, 4224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.398864138869138, "mean_inference_ms": 1.0666902084738465, "mean_action_processing_ms": 0.14803845064864296, "mean_env_wait_ms": 0.05626993278625872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004777431488037109, "StateBufferConnector_ms": 0.003558635711669922, "ViewRequirementAgentConnector_ms": 0.1286163330078125}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -743854.42, "episode_len_mean": 1760.12, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-226973.0, -200852.0, -117047.0, -81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0, -1130269.0, -607071.0, -1560606.0], "episode_lengths": [629, 561, 490, 187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127, 2132, 1714, 4224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.398864138869138, "mean_inference_ms": 1.0666902084738465, "mean_action_processing_ms": 0.14803845064864296, "mean_env_wait_ms": 0.05626993278625872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004777431488037109, "StateBufferConnector_ms": 0.003558635711669922, "ViewRequirementAgentConnector_ms": 0.1286163330078125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 522250, "num_agent_steps_trained": 522000, "num_env_steps_sampled": 522250, "num_env_steps_trained": 522000, "num_env_steps_sampled_this_iter": 5850, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 584.999428153597, "num_env_steps_trained_throughput_per_sec": 599.9994134908687, "timesteps_total": 522250, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 522250, "timers": {"training_iteration_time_ms": 0.183, "sample_time_ms": 0.083, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 522250, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522250, "num_agent_steps_trained": 522000, "num_training_step_calls_since_last_synch_worker_weights": 218, "last_target_update_ts": 522250, "num_weight_broadcasts": 10361, "num_target_updates": 10361, "num_samples_added_to_queue": 522000}, "done": false, "episodes_total": 290, "training_iteration": 94, "trial_id": "304dd_00000", "date": "2023-12-11_02-03-19", "timestamp": 1702288999, "time_this_iter_s": 10.114578008651733, "time_total_s": 951.5144782066345, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 951.5144782066345, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 31.446666666666665, "ram_util_percent": 90.22000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 20956976.0, "policy_loss": 8082.7041015625, "entropy": 0.8726343512535095, "var_gnorm": 39.046295166015625, "vf_loss": 41897788.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9999469518661499, "var_IS": 0.00010174074850510806, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 1056.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 528100, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528100, "num_agent_steps_trained": 528000, "num_training_step_calls_since_last_synch_worker_weights": 326, "last_target_update_ts": 528100, "num_weight_broadcasts": 10477, "num_target_updates": 10477, "num_samples_added_to_queue": 528000, "learner_queue": {"size_count": 1056, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.251, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 849.551, "learner_dequeue_time_ms": 13996.718}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -768967.8, "episode_len_mean": 1822.28, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0, -1130269.0, -607071.0, -1560606.0, -2111450.0, -705600.0, -239160.0], "episode_lengths": [187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127, 2132, 1714, 4224, 5324, 1887, 685]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39884818012108525, "mean_inference_ms": 1.0665755757751807, "mean_action_processing_ms": 0.14803612544428868, "mean_env_wait_ms": 0.05626106944893343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043792724609375, "StateBufferConnector_ms": 0.003279447555541992, "ViewRequirementAgentConnector_ms": 0.12964105606079102}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -768967.8, "episode_len_mean": 1822.28, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-81339.0, -188586.0, -345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0, -1130269.0, -607071.0, -1560606.0, -2111450.0, -705600.0, -239160.0], "episode_lengths": [187, 352, 1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127, 2132, 1714, 4224, 5324, 1887, 685]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39884818012108525, "mean_inference_ms": 1.0665755757751807, "mean_action_processing_ms": 0.14803612544428868, "mean_env_wait_ms": 0.05626106944893343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043792724609375, "StateBufferConnector_ms": 0.003279447555541992, "ViewRequirementAgentConnector_ms": 0.12964105606079102}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528100, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528100, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 5850, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 584.9950068423165, "num_env_steps_trained_throughput_per_sec": 599.9948788126322, "timesteps_total": 528100, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 528100, "timers": {"training_iteration_time_ms": 0.179, "sample_time_ms": 0.013, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 528100, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528100, "num_agent_steps_trained": 528000, "num_training_step_calls_since_last_synch_worker_weights": 326, "last_target_update_ts": 528100, "num_weight_broadcasts": 10477, "num_target_updates": 10477, "num_samples_added_to_queue": 528000}, "done": false, "episodes_total": 293, "training_iteration": 95, "trial_id": "304dd_00000", "date": "2023-12-11_02-03-29", "timestamp": 1702289009, "time_this_iter_s": 10.094812631607056, "time_total_s": 961.6092908382416, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 961.6092908382416, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 32.17857142857142, "ram_util_percent": 90.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 35093568.0, "policy_loss": 9247.12890625, "entropy": 0.8796428442001343, "var_gnorm": 39.072471618652344, "vf_loss": 70168640.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9999940395355225, "var_IS": 2.603780922072474e-05, "model": {}, "grad_gnorm": [80.032958984375]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 1067.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 533800, "num_env_steps_trained": 533500, "num_agent_steps_sampled": 533800, "num_agent_steps_trained": 533500, "num_training_step_calls_since_last_synch_worker_weights": 124, "last_target_update_ts": 533800, "num_weight_broadcasts": 10590, "num_target_updates": 10590, "num_samples_added_to_queue": 533500, "learner_queue": {"size_count": 1067, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.825, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 881.522, "learner_dequeue_time_ms": 13989.047}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -798233.79, "episode_len_mean": 1899.65, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0, -1130269.0, -607071.0, -1560606.0, -2111450.0, -705600.0, -239160.0, -1697172.0, -1499352.0], "episode_lengths": [1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127, 2132, 1714, 4224, 5324, 1887, 685, 4685, 3591]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39883597302063095, "mean_inference_ms": 1.0664948276925315, "mean_action_processing_ms": 0.1480330773778762, "mean_env_wait_ms": 0.05625461503545899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043792724609375, "StateBufferConnector_ms": 0.003279447555541992, "ViewRequirementAgentConnector_ms": 0.12579607963562012}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -798233.79, "episode_len_mean": 1899.65, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-345031.0, -355099.0, -205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0, -1130269.0, -607071.0, -1560606.0, -2111450.0, -705600.0, -239160.0, -1697172.0, -1499352.0], "episode_lengths": [1206, 955, 598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127, 2132, 1714, 4224, 5324, 1887, 685, 4685, 3591]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39883597302063095, "mean_inference_ms": 1.0664948276925315, "mean_action_processing_ms": 0.1480330773778762, "mean_env_wait_ms": 0.05625461503545899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043792724609375, "StateBufferConnector_ms": 0.003279447555541992, "ViewRequirementAgentConnector_ms": 0.12579607963562012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 533800, "num_agent_steps_trained": 533500, "num_env_steps_sampled": 533800, "num_env_steps_trained": 533500, "num_env_steps_sampled_this_iter": 5700, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 569.952059009929, "num_env_steps_trained_throughput_per_sec": 549.9537411499315, "timesteps_total": 533800, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 533800, "timers": {"training_iteration_time_ms": 0.162, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 533800, "num_env_steps_trained": 533500, "num_agent_steps_sampled": 533800, "num_agent_steps_trained": 533500, "num_training_step_calls_since_last_synch_worker_weights": 124, "last_target_update_ts": 533800, "num_weight_broadcasts": 10590, "num_target_updates": 10590, "num_samples_added_to_queue": 533500}, "done": false, "episodes_total": 295, "training_iteration": 96, "trial_id": "304dd_00000", "date": "2023-12-11_02-03-39", "timestamp": 1702289019, "time_this_iter_s": 10.13289999961853, "time_total_s": 971.7421908378601, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 971.7421908378601, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 35.035714285714285, "ram_util_percent": 90.24285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 17601452.0, "policy_loss": 6731.96728515625, "entropy": 0.9068259000778198, "var_gnorm": 39.10715103149414, "vf_loss": 35189440.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.999002993106842, "var_IS": 0.0003198889608029276, "model": {}, "grad_gnorm": [80.00153350830078]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 1079.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 539600, "num_env_steps_trained": 539500, "num_agent_steps_sampled": 539600, "num_agent_steps_trained": 539500, "num_training_step_calls_since_last_synch_worker_weights": 294, "last_target_update_ts": 539600, "num_weight_broadcasts": 10705, "num_target_updates": 10705, "num_samples_added_to_queue": 539500, "learner_queue": {"size_count": 1079, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.581, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 858.278, "learner_dequeue_time_ms": 14020.518}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -803766.3, "episode_len_mean": 1911.69, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0, -1130269.0, -607071.0, -1560606.0, -2111450.0, -705600.0, -239160.0, -1697172.0, -1499352.0, -459637.0, -793744.0], "episode_lengths": [598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127, 2132, 1714, 4224, 5324, 1887, 685, 4685, 3591, 1319, 2046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3987983814536066, "mean_inference_ms": 1.066376734567012, "mean_action_processing_ms": 0.1480218815562102, "mean_env_wait_ms": 0.056246349344127235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043792724609375, "StateBufferConnector_ms": 0.003279447555541992, "ViewRequirementAgentConnector_ms": 0.12270832061767578}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -803766.3, "episode_len_mean": 1911.69, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0, -1130269.0, -607071.0, -1560606.0, -2111450.0, -705600.0, -239160.0, -1697172.0, -1499352.0, -459637.0, -793744.0], "episode_lengths": [598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127, 2132, 1714, 4224, 5324, 1887, 685, 4685, 3591, 1319, 2046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3987983814536066, "mean_inference_ms": 1.066376734567012, "mean_action_processing_ms": 0.1480218815562102, "mean_env_wait_ms": 0.056246349344127235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043792724609375, "StateBufferConnector_ms": 0.003279447555541992, "ViewRequirementAgentConnector_ms": 0.12270832061767578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 539600, "num_agent_steps_trained": 539500, "num_env_steps_sampled": 539600, "num_env_steps_trained": 539500, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 579.9876239556446, "num_env_steps_trained_throughput_per_sec": 599.9871971954944, "timesteps_total": 539600, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 539600, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 539600, "num_env_steps_trained": 539500, "num_agent_steps_sampled": 539600, "num_agent_steps_trained": 539500, "num_training_step_calls_since_last_synch_worker_weights": 294, "last_target_update_ts": 539600, "num_weight_broadcasts": 10705, "num_target_updates": 10705, "num_samples_added_to_queue": 539500}, "done": false, "episodes_total": 297, "training_iteration": 97, "trial_id": "304dd_00000", "date": "2023-12-11_02-03-50", "timestamp": 1702289030, "time_this_iter_s": 10.096156597137451, "time_total_s": 981.8383474349976, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 981.8383474349976, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 33.50000000000001, "ram_util_percent": 90.19285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 27241448.0, "policy_loss": 9265.64453125, "entropy": 0.7334955334663391, "var_gnorm": 39.13938903808594, "vf_loss": 54464364.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.9998697638511658, "var_IS": 3.129806282231584e-05, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 1091.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 545550, "num_env_steps_trained": 545500, "num_agent_steps_sampled": 545550, "num_agent_steps_trained": 545500, "num_training_step_calls_since_last_synch_worker_weights": 113, "last_target_update_ts": 545550, "num_weight_broadcasts": 10823, "num_target_updates": 10823, "num_samples_added_to_queue": 545500, "learner_queue": {"size_count": 1091, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.953, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 836.034, "learner_dequeue_time_ms": 13991.916}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -803766.3, "episode_len_mean": 1911.69, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0, -1130269.0, -607071.0, -1560606.0, -2111450.0, -705600.0, -239160.0, -1697172.0, -1499352.0, -459637.0, -793744.0], "episode_lengths": [598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127, 2132, 1714, 4224, 5324, 1887, 685, 4685, 3591, 1319, 2046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3987983814536066, "mean_inference_ms": 1.066376734567012, "mean_action_processing_ms": 0.1480218815562102, "mean_env_wait_ms": 0.056246349344127235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043792724609375, "StateBufferConnector_ms": 0.003279447555541992, "ViewRequirementAgentConnector_ms": 0.12270832061767578}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -803766.3, "episode_len_mean": 1911.69, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0, -1130269.0, -607071.0, -1560606.0, -2111450.0, -705600.0, -239160.0, -1697172.0, -1499352.0, -459637.0, -793744.0], "episode_lengths": [598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127, 2132, 1714, 4224, 5324, 1887, 685, 4685, 3591, 1319, 2046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3987983814536066, "mean_inference_ms": 1.066376734567012, "mean_action_processing_ms": 0.1480218815562102, "mean_env_wait_ms": 0.056246349344127235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043792724609375, "StateBufferConnector_ms": 0.003279447555541992, "ViewRequirementAgentConnector_ms": 0.12270832061767578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 545550, "num_agent_steps_trained": 545500, "num_env_steps_sampled": 545550, "num_env_steps_trained": 545500, "num_env_steps_sampled_this_iter": 5950, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 594.9470487276816, "num_env_steps_trained_throughput_per_sec": 599.9466037590067, "timesteps_total": 545550, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 545550, "timers": {"training_iteration_time_ms": 0.205, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 545550, "num_env_steps_trained": 545500, "num_agent_steps_sampled": 545550, "num_agent_steps_trained": 545500, "num_training_step_calls_since_last_synch_worker_weights": 113, "last_target_update_ts": 545550, "num_weight_broadcasts": 10823, "num_target_updates": 10823, "num_samples_added_to_queue": 545500}, "done": false, "episodes_total": 297, "training_iteration": 98, "trial_id": "304dd_00000", "date": "2023-12-11_02-04-00", "timestamp": 1702289040, "time_this_iter_s": 10.143969535827637, "time_total_s": 991.9823169708252, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 991.9823169708252, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 32.59285714285714, "ram_util_percent": 90.19285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 30722442.0, "policy_loss": 9781.853515625, "entropy": 0.6816170811653137, "var_gnorm": 39.162132263183594, "vf_loss": 61425320.0, "vf_explained_var": -1.1920928955078125e-07, "entropy_coeff": 0.009999999776482582, "mean_IS": 0.999986469745636, "var_IS": 7.577689871141047e-07, "model": {}, "grad_gnorm": [78.58956909179688]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 1102.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 551350, "num_env_steps_trained": 551000, "num_agent_steps_sampled": 551350, "num_agent_steps_trained": 551000, "num_training_step_calls_since_last_synch_worker_weights": 417, "last_target_update_ts": 551350, "num_weight_broadcasts": 10938, "num_target_updates": 10938, "num_samples_added_to_queue": 551000, "learner_queue": {"size_count": 1102, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 10.992, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 861.197, "learner_dequeue_time_ms": 13991.916}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -803766.3, "episode_len_mean": 1911.69, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0, -1130269.0, -607071.0, -1560606.0, -2111450.0, -705600.0, -239160.0, -1697172.0, -1499352.0, -459637.0, -793744.0], "episode_lengths": [598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127, 2132, 1714, 4224, 5324, 1887, 685, 4685, 3591, 1319, 2046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3987983814536066, "mean_inference_ms": 1.066376734567012, "mean_action_processing_ms": 0.1480218815562102, "mean_env_wait_ms": 0.056246349344127235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043792724609375, "StateBufferConnector_ms": 0.003279447555541992, "ViewRequirementAgentConnector_ms": 0.12270832061767578}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -803766.3, "episode_len_mean": 1911.69, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-205625.0, -999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0, -1130269.0, -607071.0, -1560606.0, -2111450.0, -705600.0, -239160.0, -1697172.0, -1499352.0, -459637.0, -793744.0], "episode_lengths": [598, 1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127, 2132, 1714, 4224, 5324, 1887, 685, 4685, 3591, 1319, 2046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3987983814536066, "mean_inference_ms": 1.066376734567012, "mean_action_processing_ms": 0.1480218815562102, "mean_env_wait_ms": 0.056246349344127235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043792724609375, "StateBufferConnector_ms": 0.003279447555541992, "ViewRequirementAgentConnector_ms": 0.12270832061767578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 551350, "num_agent_steps_trained": 551000, "num_env_steps_sampled": 551350, "num_env_steps_trained": 551000, "num_env_steps_sampled_this_iter": 5800, "num_env_steps_trained_this_iter": 5500, "num_env_steps_sampled_throughput_per_sec": 579.9539416651801, "num_env_steps_trained_throughput_per_sec": 549.9563239928432, "timesteps_total": 551350, "num_steps_trained_this_iter": 5500, "agent_timesteps_total": 551350, "timers": {"training_iteration_time_ms": 0.2, "sample_time_ms": 0.0, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 551350, "num_env_steps_trained": 551000, "num_agent_steps_sampled": 551350, "num_agent_steps_trained": 551000, "num_training_step_calls_since_last_synch_worker_weights": 417, "last_target_update_ts": 551350, "num_weight_broadcasts": 10938, "num_target_updates": 10938, "num_samples_added_to_queue": 551000}, "done": false, "episodes_total": 297, "training_iteration": 99, "trial_id": "304dd_00000", "date": "2023-12-11_02-04-10", "timestamp": 1702289050, "time_this_iter_s": 10.088765621185303, "time_total_s": 1002.0710825920105, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1002.0710825920105, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 33.73571428571429, "ram_util_percent": 90.1857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "total_loss": 17573876.0, "policy_loss": 7057.99267578125, "entropy": 0.8856330513954163, "var_gnorm": 39.1848258972168, "vf_loss": 35133636.0, "vf_explained_var": 0.0, "entropy_coeff": 0.009999999776482582, "mean_IS": 1.0017060041427612, "var_IS": 0.0006371961790136993, "model": {}, "grad_gnorm": [80.0]}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 1114.0, "diff_num_grad_updates_vs_sampler_policy": 0.20000000000004547}}, "num_env_steps_sampled": 557200, "num_env_steps_trained": 557000, "num_agent_steps_sampled": 557200, "num_agent_steps_trained": 557000, "num_training_step_calls_since_last_synch_worker_weights": 2, "last_target_update_ts": 557200, "num_weight_broadcasts": 11054, "num_target_updates": 11054, "num_samples_added_to_queue": 557000, "learner_queue": {"size_count": 1114, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 11.202, "learner_load_time_ms": 0.104, "learner_load_wait_time_ms": 855.269, "learner_dequeue_time_ms": 14009.71}}, "sampler_results": {"episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -884486.01, "episode_len_mean": 2099.85, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0, -1130269.0, -607071.0, -1560606.0, -2111450.0, -705600.0, -239160.0, -1697172.0, -1499352.0, -459637.0, -793744.0, -8277596.0], "episode_lengths": [1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127, 2132, 1714, 4224, 5324, 1887, 685, 4685, 3591, 1319, 2046, 19414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39877261320730134, "mean_inference_ms": 1.066302363902936, "mean_action_processing_ms": 0.14801230996482362, "mean_env_wait_ms": 0.05624100759488943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043792724609375, "StateBufferConnector_ms": 0.003279447555541992, "ViewRequirementAgentConnector_ms": 0.12055802345275879}}, "episode_reward_max": -34093.0, "episode_reward_min": -9228091.0, "episode_reward_mean": -884486.01, "episode_len_mean": 2099.85, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-999460.0, -894655.0, -954289.0, -234926.0, -832143.0, -212427.0, -597374.0, -289777.0, -137592.0, -339219.0, -90887.0, -293867.0, -738322.0, -89844.0, -249262.0, -573401.0, -342660.0, -1598403.0, -577129.0, -449468.0, -1399144.0, -541130.0, -129618.0, -440316.0, -1160331.0, -692069.0, -387549.0, -592020.0, -550606.0, -1092828.0, -2069247.0, -1683870.0, -353937.0, -108090.0, -217622.0, -1092131.0, -203044.0, -229712.0, -314651.0, -498550.0, -160341.0, -73623.0, -34093.0, -2728736.0, -1369851.0, -9228091.0, -1232363.0, -1420285.0, -1560157.0, -104903.0, -883331.0, -578822.0, -2087006.0, -743139.0, -555836.0, -621140.0, -1032279.0, -761995.0, -170812.0, -626643.0, -193381.0, -45339.0, -1512831.0, -1624959.0, -806806.0, -614119.0, -415585.0, -189868.0, -692090.0, -151265.0, -309862.0, -91416.0, -296945.0, -1321584.0, -841488.0, -1419265.0, -254282.0, -75345.0, -60110.0, -342474.0, -349121.0, -1294648.0, -202226.0, -136763.0, -133044.0, -1185810.0, -1297539.0, -2408480.0, -875283.0, -1130269.0, -607071.0, -1560606.0, -2111450.0, -705600.0, -239160.0, -1697172.0, -1499352.0, -459637.0, -793744.0, -8277596.0], "episode_lengths": [1768, 2200, 2331, 673, 1947, 633, 1416, 764, 423, 854, 190, 995, 1113, 373, 905, 1692, 831, 3860, 1810, 936, 4561, 1373, 219, 1048, 2432, 1857, 981, 1730, 1983, 2148, 4463, 4588, 620, 196, 322, 2634, 435, 501, 1137, 1327, 523, 121, 97, 7415, 3971, 12431, 2832, 2772, 2122, 359, 1585, 1289, 5316, 2284, 1402, 1782, 2022, 1223, 553, 1928, 768, 179, 4219, 3019, 2336, 2037, 1229, 654, 2165, 316, 950, 270, 906, 3201, 1663, 3296, 680, 130, 139, 922, 942, 3274, 596, 381, 387, 3558, 3419, 6905, 2127, 2132, 1714, 4224, 5324, 1887, 685, 4685, 3591, 1319, 2046, 19414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39877261320730134, "mean_inference_ms": 1.066302363902936, "mean_action_processing_ms": 0.14801230996482362, "mean_env_wait_ms": 0.05624100759488943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043792724609375, "StateBufferConnector_ms": 0.003279447555541992, "ViewRequirementAgentConnector_ms": 0.12055802345275879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 2, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 557200, "num_agent_steps_trained": 557000, "num_env_steps_sampled": 557200, "num_env_steps_trained": 557000, "num_env_steps_sampled_this_iter": 5850, "num_env_steps_trained_this_iter": 6000, "num_env_steps_sampled_throughput_per_sec": 584.9629299290716, "num_env_steps_trained_throughput_per_sec": 599.9619794144324, "timesteps_total": 557200, "num_steps_trained_this_iter": 6000, "agent_timesteps_total": 557200, "timers": {"training_iteration_time_ms": 1.202, "sample_time_ms": 0.044, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 557200, "num_env_steps_trained": 557000, "num_agent_steps_sampled": 557200, "num_agent_steps_trained": 557000, "num_training_step_calls_since_last_synch_worker_weights": 2, "last_target_update_ts": 557200, "num_weight_broadcasts": 11054, "num_target_updates": 11054, "num_samples_added_to_queue": 557000}, "done": true, "episodes_total": 298, "training_iteration": 100, "trial_id": "304dd_00000", "date": "2023-12-11_02-04-20", "timestamp": 1702289060, "time_this_iter_s": 10.15070652961731, "time_total_s": 1012.2217891216278, "pid": 11248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BalloonFlight-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001173B67E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 100, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "vtrace_drop_last_ts": -1, "use_critic": true, "use_gae": true, "clip_param": 0.4, "use_kl_loss": false, "kl_coeff": 1.0, "kl_target": 0.01, "target_update_frequency": 1, "max_sample_requests_in_flight_per_worker": 2, "tau": 1.0, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1012.2217891216278, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 35.23333333333333, "ram_util_percent": 90.10666666666664}}
